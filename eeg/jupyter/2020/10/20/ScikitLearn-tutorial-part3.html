<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Introduction to the scikit-learn – supervised learning and model selection (part 3) | Neural Oscillations</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Introduction to the scikit-learn – supervised learning and model selection (part 3)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="To visualize the workings of machine learning algorithms, it is often helpful to study two-dimensional or one-dimensional data, that is data with only one or two features. While in practice, datasets usually have many more features, it is hard to plot high-dimensional data in on two-dimensional screens." />
<meta property="og:description" content="To visualize the workings of machine learning algorithms, it is often helpful to study two-dimensional or one-dimensional data, that is data with only one or two features. While in practice, datasets usually have many more features, it is hard to plot high-dimensional data in on two-dimensional screens." />
<link rel="canonical" href="https://berdakh.github.io/blog/eeg/jupyter/2020/10/20/ScikitLearn-tutorial-part3.html" />
<meta property="og:url" content="https://berdakh.github.io/blog/eeg/jupyter/2020/10/20/ScikitLearn-tutorial-part3.html" />
<meta property="og:site_name" content="Neural Oscillations" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-10-20T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"To visualize the workings of machine learning algorithms, it is often helpful to study two-dimensional or one-dimensional data, that is data with only one or two features. While in practice, datasets usually have many more features, it is hard to plot high-dimensional data in on two-dimensional screens.","headline":"Introduction to the scikit-learn – supervised learning and model selection (part 3)","@type":"BlogPosting","dateModified":"2020-10-20T00:00:00-05:00","datePublished":"2020-10-20T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://berdakh.github.io/blog/eeg/jupyter/2020/10/20/ScikitLearn-tutorial-part3.html"},"url":"https://berdakh.github.io/blog/eeg/jupyter/2020/10/20/ScikitLearn-tutorial-part3.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://berdakh.github.io/blog/feed.xml" title="Neural Oscillations" /><link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Introduction to the scikit-learn – supervised learning and model selection (part 3) | Neural Oscillations</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Introduction to the scikit-learn – supervised learning and model selection (part 3)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="To visualize the workings of machine learning algorithms, it is often helpful to study two-dimensional or one-dimensional data, that is data with only one or two features. While in practice, datasets usually have many more features, it is hard to plot high-dimensional data in on two-dimensional screens." />
<meta property="og:description" content="To visualize the workings of machine learning algorithms, it is often helpful to study two-dimensional or one-dimensional data, that is data with only one or two features. While in practice, datasets usually have many more features, it is hard to plot high-dimensional data in on two-dimensional screens." />
<link rel="canonical" href="https://berdakh.github.io/blog/eeg/jupyter/2020/10/20/ScikitLearn-tutorial-part3.html" />
<meta property="og:url" content="https://berdakh.github.io/blog/eeg/jupyter/2020/10/20/ScikitLearn-tutorial-part3.html" />
<meta property="og:site_name" content="Neural Oscillations" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-10-20T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"To visualize the workings of machine learning algorithms, it is often helpful to study two-dimensional or one-dimensional data, that is data with only one or two features. While in practice, datasets usually have many more features, it is hard to plot high-dimensional data in on two-dimensional screens.","headline":"Introduction to the scikit-learn – supervised learning and model selection (part 3)","@type":"BlogPosting","dateModified":"2020-10-20T00:00:00-05:00","datePublished":"2020-10-20T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://berdakh.github.io/blog/eeg/jupyter/2020/10/20/ScikitLearn-tutorial-part3.html"},"url":"https://berdakh.github.io/blog/eeg/jupyter/2020/10/20/ScikitLearn-tutorial-part3.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://berdakh.github.io/blog/feed.xml" title="Neural Oscillations" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">Neural Oscillations</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Tags</a><a class="page-link" href="/blog/teaching/">Teaching</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Introduction to the scikit-learn -- supervised learning and model selection (part 3)</h1><p class="page-description">To visualize the workings of machine learning algorithms, it is often helpful to study two-dimensional or one-dimensional data, that is data with only one or two features. While in practice, datasets usually have many more features, it is hard to plot high-dimensional data in on two-dimensional screens.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-10-20T00:00:00-05:00" itemprop="datePublished">
        Oct 20, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      24 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#EEG">EEG</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#jupyter">jupyter</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/berdakh/blog/tree/master/_notebooks/2020-10-20-ScikitLearn-tutorial-part3.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/berdakh/blog/master?filepath=_notebooks%2F2020-10-20-ScikitLearn-tutorial-part3.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/berdakh/blog/blob/master/_notebooks/2020-10-20-ScikitLearn-tutorial-part3.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h3"><a href="#The-scikit-learn-estimator-API">The scikit-learn estimator API </a></li>
<li class="toc-entry toc-h2"><a href="#K-Nearest-Neighbors-(KNN)">K Nearest Neighbors (KNN) </a></li>
<li class="toc-entry toc-h2"><a href="#Minkowski-Distance-($\ell_p$-norms)}">Minkowski Distance ($\ell_p$ norms)} </a></li>
<li class="toc-entry toc-h2"><a href="#Brute-Force-KNN">Brute Force KNN </a></li>
<li class="toc-entry toc-h1"><a href="#Supervised-Learning----Regression-Analysis">Supervised Learning -- Regression Analysis </a></li>
<li class="toc-entry toc-h1"><a href="#Linear-Regression">Linear Regression </a></li>
<li class="toc-entry toc-h1"><a href="#KNeighborsRegression">KNeighborsRegression </a></li>
<li class="toc-entry toc-h1"><a href="#Cross-Validation-and-scoring-methods">Cross-Validation and scoring methods </a></li>
<li class="toc-entry toc-h1"><a href="#A-recap-on-Scikit-learn's-estimator-interface">A recap on Scikit-learn&#39;s estimator interface </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-10-20-ScikitLearn-tutorial-part3.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To visualize the workings of machine learning algorithms, it is often helpful to study two-dimensional or one-dimensional data, that is data with only one or two features. While in practice, datasets usually have many more features, it is hard to plot high-dimensional data in on two-dimensional screens.</p>
<p>We will illustrate some very simple examples before we move on to more "real world" data sets.</p>
<p>First, we will look at a two class classification problem in two dimensions. We use the synthetic data generated by the <code>make_blobs</code> function.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">'wCpCDbkDJXQ'</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">

        <iframe width="700" height="400" src="https://www.youtube.com/embed/wCpCDbkDJXQ" frameborder="0" allowfullscreen=""></iframe>
        
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_blobs</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">centers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'X ~ n_samples x n_features:'</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'y ~ n_samples:'</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">First 5 samples:</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span> <span class="n">X</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">First 5 labels:'</span><span class="p">,</span> <span class="n">y</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>X ~ n_samples x n_features: (100, 2)
y ~ n_samples: (100,)

First 5 samples:
 [[ 4.21850347  2.23419161]
 [ 0.90779887  0.45984362]
 [-0.27652528  5.08127768]
 [ 0.08848433  2.32299086]
 [ 3.24329731  1.21460627]]

First 5 labels: [1 1 0 0 1]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As the data is two-dimensional, we can plot each sample as a point in a two-dimensional coordinate system, with the first feature being the x-axis and the second feature being the y-axis.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'0'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'1'</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'s'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'first feature'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'second feature'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'upper right'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Classification is a supervised task, and since we are interested in its performance on unseen data, we split our data into two parts:</p>
<ol>
<li>a training set that the learning algorithm uses to fit the model</li>
<li>a test set to evaluate the generalization performance of the model</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>train_test_split</code> function from the <code>model_selection</code> module does that for us -- we will use it to split a dataset into 75% training data and 25% test data.</p>
<p><figure>
  
    <img class="docimage" src="/blog/images/copied_from_nb/figures/train_test_split_matrix.svg" alt="" style="max-width: 25%px">
    
    
</figure>
</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
                                                    <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                                                    <span class="n">random_state</span><span class="o">=</span><span class="mi">1234</span><span class="p">,</span>
                                                    <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-scikit-learn-estimator-API">
<a class="anchor" href="#The-scikit-learn-estimator-API" aria-hidden="true"><span class="octicon octicon-link"></span></a>The scikit-learn estimator API<a class="anchor-link" href="#The-scikit-learn-estimator-API"> </a>
</h3>
<p><figure>
  
    <img class="docimage" src="/blog/images/copied_from_nb/figures/supervised_workflow.svg" alt="" style="max-width: 30%px">
    
    
</figure>
</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Every algorithm is exposed in scikit-learn via an ''Estimator'' object. (All models in scikit-learn have a very consistent interface). For instance, we first import the logistic regression class.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we instantiate the estimator object.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">classifier</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(75, 2)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(75,)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To built the model from our data, that is to learn how to classify new points, we call the <code>fit</code> function with the training data, and the corresponding training labels (the desired output for the training data point):</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>classifier.fit<span class="o">?</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea ">
<pre><span class="ansi-red-intense-fg ansi-bold">Signature:</span> classifier<span class="ansi-yellow-intense-fg ansi-bold">.</span>fit<span class="ansi-yellow-intense-fg ansi-bold">(</span>X<span class="ansi-yellow-intense-fg ansi-bold">,</span> y<span class="ansi-yellow-intense-fg ansi-bold">,</span> sample_weight<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-green-intense-fg ansi-bold">None</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-red-intense-fg ansi-bold">Docstring:</span>
Fit the model according to the given training data.

Parameters
----------
X : {array-like, sparse matrix} of shape (n_samples, n_features)
    Training vector, where n_samples is the number of samples and
    n_features is the number of features.

y : array-like of shape (n_samples,)
    Target vector relative to X.

sample_weight : array-like of shape (n_samples,) default=None
    Array of weights that are assigned to individual samples.
    If not provided, then each sample is given unit weight.

    .. versionadded:: 0.17
       *sample_weight* support to LogisticRegression.

Returns
-------
self
    Fitted estimator.

Notes
-----
The SAGA solver supports both float64 and float32 bit arrays.
<span class="ansi-red-intense-fg ansi-bold">File:</span>      c:\users\babib\anaconda3\envs\mne\lib\site-packages\sklearn\linear_model\_logistic.py
<span class="ansi-red-intense-fg ansi-bold">Type:</span>      method
</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>LogisticRegression()</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>(Some estimator methods such as <code>fit</code> return <code>self</code> by default. Thus, after executing the code snippet above, you will see the default parameters of this particular instance of <code>LogisticRegression</code>. Another way of retrieving the estimator's ininitialization parameters is to execute <code>classifier.get_params()</code>, which returns a parameter dictionary.)</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">classifier</span><span class="o">.</span><span class="n">coef_</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[ 0.87015709, -2.23877721]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">classifier</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{'C': 1.0,
 'class_weight': None,
 'dual': False,
 'fit_intercept': True,
 'intercept_scaling': 1,
 'l1_ratio': None,
 'max_iter': 100,
 'multi_class': 'auto',
 'n_jobs': None,
 'penalty': 'l2',
 'random_state': None,
 'solver': 'lbfgs',
 'tol': 0.0001,
 'verbose': 0,
 'warm_start': False}</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can then apply the model to unseen data and use the model to predict the estimated outcome using the <code>predict</code> method:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prediction</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can compare these against the true labels:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[1 0 1 0 1 1 1 1 1 1 1 0 0 0 0 1 0 0 1 0 0 0 1 1 0]
[1 1 1 0 1 1 0 1 1 0 1 0 0 0 0 1 0 0 1 0 0 1 1 1 0]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can evaluate our classifier quantitatively by measuring what fraction of predictions is correct. This is called <strong>accuracy</strong>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prediction</span> <span class="o">==</span> <span class="n">y_test</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([ True, False,  True,  True,  True,  True, False,  True,  True,
       False,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True, False,  True,  True,  True])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">prediction</span> <span class="o">==</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.84</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There is also a convenience function , <code>score</code>, that all scikit-learn classifiers have to compute this directly from the test data:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">classifier</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.84</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It is often helpful to compare the generalization performance (on the test set) to the performance on the training set:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">classifier</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.9733333333333334</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>LogisticRegression is a so-called linear model,
that means it will create a decision that is linear in the input space. In 2d, this simply means it finds a line to separate the blue from the red:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">figures</span> <span class="kn">import</span> <span class="n">plot_2d_separator</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'0'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'1'</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'s'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"first feature"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"second feature"</span><span class="p">)</span>
<span class="n">plot_2d_separator</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'upper right'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Estimated parameters</strong>: All the estimated model parameters are attributes of the estimator object ending by an underscore. Here, these are the coefficients and the offset of the line:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classifier</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classifier</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[[ 0.87015709 -2.23877721]]
[4.64737766]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="K-Nearest-Neighbors-(KNN)">
<a class="anchor" href="#K-Nearest-Neighbors-(KNN)" aria-hidden="true"><span class="octicon octicon-link"></span></a>K Nearest Neighbors (KNN)<a class="anchor-link" href="#K-Nearest-Neighbors-(KNN)"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Another popular and easy to understand classifier is K nearest neighbors (kNN).  It has one of the simplest learning strategies: given a new, unknown observation, look up in your reference database which ones have the closest features and assign the predominant class.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The KNN classifier is a non-parametric classifier that simply stores the training data $\mathcal{D}$
and classifies each new instance $x$ using a majority vote over its' set of $K$ nearest neighbors $\mathcal{N}_K(x)$ computed using any distance function $d: R^D \times\mathbb{R}^D \rightarrow \mathbb{R} $.</p>
<p>KNN Classification Function:</p>
<p>
$$g_{KNN}(x) = argmax_{y\in\mathcal{Y}} \sum_{i\in \mathcal{N}_K(x)} \mathbb{I}[y_i=y]$$
</p>
<p>Use of KNN requires choosing the distance function $d$ and the number of neighbors $K$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://cdn-images-1.medium.com/max/900/1*k8WEP2Kn3YDOopnLzljAJA.png" alt="">
<img src="https://cdn-images-1.medium.com/max/900/1*CZwsWrWNj2KqF1jJ-Z3SPA.png" alt=""></p>
<p><img src="https://cdn-images-1.medium.com/max/1200/1*4vdvnkZoWgOp0vcLF4wFcA.png" alt=""></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<p>In general, KNN can work with any distance function $d$ satisfying non-negativity $d(\bf{x},\bf{x}')\geq 0$ and identity of indiscernibles $d(\bf{x},\bf{x})=0$.</p>
</li>
<li>
<p>Alternatively, KNN can work with any similarity function $s$ satisfying non-negativity $s(\bf{x},\bf{y})\geq 0$ that attains it's maximum on indiscernibles $s(\bf{x},\bf{x})=\max_{\bf{x}'} s(\bf{x},\bf{x}')$.</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>However, the more structure the distance or similarity function has  (symmetry, triangle inequality), 
the more structure you can exploit when designing algorithms.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Minkowski-Distance-($\ell_p$-norms)}">
<a class="anchor" href="#Minkowski-Distance-(%24%5Cell_p%24-norms)%7D" aria-hidden="true"><span class="octicon octicon-link"></span></a>Minkowski Distance ($\ell_p$ norms)}<a class="anchor-link" href="#Minkowski-Distance-(%24%5Cell_p%24-norms)%7D"> </a>
</h2>
<p>Given two data vectors $\bf{x},\bf{x}' \in \mathbb{R}^D$, the Minkowski Distance with parameter $p$ (the $\ell_p$ norm) is a proper metric defined as follows:</p>
\begin{align*}
    d_p(\bf{x},\bf{x}') &amp;=  ||\bf{x}-\bf{x}'||_p \\
    &amp;=\left(\sum_{i=1}^D |x_d-x'_d|^p\right)^{1/p}
\end{align*}<p>Special cases include Euclidean distance ($p=2$), Manhattan distance ($p=1$) and Chebyshev distance ($p=\infty$).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Brute-Force-KNN">
<a class="anchor" href="#Brute-Force-KNN" aria-hidden="true"><span class="octicon octicon-link"></span></a>Brute Force KNN<a class="anchor-link" href="#Brute-Force-KNN"> </a>
</h2>
<ul>
<li>
<p>Given any distance function $d$, brute force KNN works by computing the distance $d_i = d(\bf{x}_i,\bf{x}_*)$ from a target point $\bf{x}_*$ to all of the training points $\bf{x}_i$.</p>
</li>
<li>
<p>You then simply sort the distances $\{d_i,i=1:N\}$ and choose the data cases with the $K$ smallest distances to form the neighbor set $\mathcal{N}_K(\bf{x}_*)$. Using a similarity function is identical, but you select the $K$ most similar data cases.</p>
</li>
<li>
<p>Once the $K$ neighbors are selected, applying the classification rule is easy.</p>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In Sklearn the KNN interface is exactly the same as for <code>LogisticRegression above</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This time we set a parameter of the KNeighborsClassifier to tell it we only want to look at one nearest neighbor:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We fit the model with out training data</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>KNeighborsClassifier(n_neighbors=1)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">'blue'</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'0'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'1'</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">'s'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"first feature"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"second feature"</span><span class="p">)</span>
<span class="n">plot_2d_separator</span><span class="p">(</span><span class="n">knn</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'upper right'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?>
&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
  "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;
<!-- Created with matplotlib (https://matplotlib.org/) -->
<svg height="245.518125pt" version="1.1" viewbox="0 0 362.878125 245.518125" width="362.878125pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
 <metadata>
  <rdf xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
   <work>
    <type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></type>
    <date>2020-10-14T19:49:43.120164</date>
    <format>image/svg+xml</format>
    <creator>
     <agent>
      <title>Matplotlib v3.3.1, https://matplotlib.org/</title>
     </agent>
    </creator>
   </work>
  </rdf>
 </metadata>
 <defs>
  <style type="text/css">*{stroke-linecap:butt;stroke-linejoin:round;}</style>
 </defs>
 <g id="figure_1">
  <g id="patch_1">
   <path d="M 0 245.518125 
L 362.878125 245.518125 
L 362.878125 0 
L 0 0 
z
" style="fill:none;"></path>
  </g>
  <g id="axes_1">
   <g id="patch_2">
    <path d="M 20.878125 224.64 
L 355.678125 224.64 
L 355.678125 7.2 
L 20.878125 7.2 
z
" style="fill:#ffffff;"></path>
   </g>
   <g id="PathCollection_1">
    <defs>
     <path d="M 0 3.162278 
C 0.838646 3.162278 1.643056 2.82908 2.236068 2.236068 
C 2.82908 1.643056 3.162278 0.838646 3.162278 0 
C 3.162278 -0.838646 2.82908 -1.643056 2.236068 -2.236068 
C 1.643056 -2.82908 0.838646 -3.162278 0 -3.162278 
C -0.838646 -3.162278 -1.643056 -2.82908 -2.236068 -2.236068 
C -2.82908 -1.643056 -3.162278 -0.838646 -3.162278 0 
C -3.162278 0.838646 -2.82908 1.643056 -2.236068 2.236068 
C -1.643056 2.82908 -0.838646 3.162278 0 3.162278 
z
" id="m8aa1c83cdb" style="stroke:#0000ff;"></path>
    </defs>
    <g clip-path="url(#p149f15442c)">
     <use style="fill:#0000ff;stroke:#0000ff;" x="114.058878" xlink:href="#m8aa1c83cdb" y="54.518461"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="129.925804" xlink:href="#m8aa1c83cdb" y="119.238264"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="188.760043" xlink:href="#m8aa1c83cdb" y="108.80738"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="170.506867" xlink:href="#m8aa1c83cdb" y="77.153353"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="151.680697" xlink:href="#m8aa1c83cdb" y="79.854476"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="153.394048" xlink:href="#m8aa1c83cdb" y="69.092779"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="177.571439" xlink:href="#m8aa1c83cdb" y="49.845683"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="129.077593" xlink:href="#m8aa1c83cdb" y="71.54248"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="139.28597" xlink:href="#m8aa1c83cdb" y="81.197787"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="175.253296" xlink:href="#m8aa1c83cdb" y="63.888197"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="154.974596" xlink:href="#m8aa1c83cdb" y="71.443464"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="117.868819" xlink:href="#m8aa1c83cdb" y="51.624531"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="164.030838" xlink:href="#m8aa1c83cdb" y="63.127127"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="168.974184" xlink:href="#m8aa1c83cdb" y="30.858064"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="187.812433" xlink:href="#m8aa1c83cdb" y="64.932058"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="171.409245" xlink:href="#m8aa1c83cdb" y="65.664184"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="219.759163" xlink:href="#m8aa1c83cdb" y="76.983029"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="218.047367" xlink:href="#m8aa1c83cdb" y="101.734982"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="122.937271" xlink:href="#m8aa1c83cdb" y="106.080286"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="235.147487" xlink:href="#m8aa1c83cdb" y="38.284621"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="94.346379" xlink:href="#m8aa1c83cdb" y="26.988773"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="186.007495" xlink:href="#m8aa1c83cdb" y="88.82954"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="97.653213" xlink:href="#m8aa1c83cdb" y="61.902699"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="150.991693" xlink:href="#m8aa1c83cdb" y="44.078147"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="233.211903" xlink:href="#m8aa1c83cdb" y="28.276611"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="184.008956" xlink:href="#m8aa1c83cdb" y="56.182446"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="267.183724" xlink:href="#m8aa1c83cdb" y="106.886214"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="174.034604" xlink:href="#m8aa1c83cdb" y="63.32913"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="250.378096" xlink:href="#m8aa1c83cdb" y="104.384821"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="209.817985" xlink:href="#m8aa1c83cdb" y="76.312725"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="121.972255" xlink:href="#m8aa1c83cdb" y="48.019904"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="174.779307" xlink:href="#m8aa1c83cdb" y="38.638578"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="130.664297" xlink:href="#m8aa1c83cdb" y="86.343309"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="249.700282" xlink:href="#m8aa1c83cdb" y="95.691936"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="206.094692" xlink:href="#m8aa1c83cdb" y="90.175303"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="182.126767" xlink:href="#m8aa1c83cdb" y="92.801619"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="200.211233" xlink:href="#m8aa1c83cdb" y="69.73489"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="133.170373" xlink:href="#m8aa1c83cdb" y="113.266409"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="140.94384" xlink:href="#m8aa1c83cdb" y="81.272589"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="146.363227" xlink:href="#m8aa1c83cdb" y="83.040189"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="167.292671" xlink:href="#m8aa1c83cdb" y="62.711035"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="176.230444" xlink:href="#m8aa1c83cdb" y="82.188609"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="113.289911" xlink:href="#m8aa1c83cdb" y="50.015615"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="201.599973" xlink:href="#m8aa1c83cdb" y="69.90636"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="146.313108" xlink:href="#m8aa1c83cdb" y="100.463395"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="129.59192" xlink:href="#m8aa1c83cdb" y="63.683124"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="221.998345" xlink:href="#m8aa1c83cdb" y="44.548953"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="233.465196" xlink:href="#m8aa1c83cdb" y="77.575101"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="57.539573" xlink:href="#m8aa1c83cdb" y="57.42496"></use>
     <use style="fill:#0000ff;stroke:#0000ff;" x="98.361794" xlink:href="#m8aa1c83cdb" y="77.753003"></use>
    </g>
   </g>
   <g id="PathCollection_2">
    <defs>
     <path d="M -3.162278 3.162278 
L 3.162278 3.162278 
L 3.162278 -3.162278 
L -3.162278 -3.162278 
z
" id="m41c1f764ca" style="stroke:#ff0000;"></path>
    </defs>
    <g clip-path="url(#p149f15442c)">
     <use style="fill:#ff0000;stroke:#ff0000;" x="309.457265" xlink:href="#m41c1f764ca" y="121.321829"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="165.541314" xlink:href="#m41c1f764ca" y="162.954719"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="267.065165" xlink:href="#m41c1f764ca" y="145.245143"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="299.011716" xlink:href="#m41c1f764ca" y="117.943355"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="180.497519" xlink:href="#m41c1f764ca" y="168.861247"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="199.373353" xlink:href="#m41c1f764ca" y="158.298548"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="203.771569" xlink:href="#m41c1f764ca" y="133.85316"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="319.016677" xlink:href="#m41c1f764ca" y="130.520763"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="264.39638" xlink:href="#m41c1f764ca" y="178.021073"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="158.2193" xlink:href="#m41c1f764ca" y="163.512325"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="181.953481" xlink:href="#m41c1f764ca" y="140.028993"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="183.272926" xlink:href="#m41c1f764ca" y="116.476874"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="238.168422" xlink:href="#m41c1f764ca" y="156.706934"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="183.047238" xlink:href="#m41c1f764ca" y="172.073173"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="228.386025" xlink:href="#m41c1f764ca" y="121.5598"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="231.78482" xlink:href="#m41c1f764ca" y="178.477896"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="167.414227" xlink:href="#m41c1f764ca" y="151.457821"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="232.636012" xlink:href="#m41c1f764ca" y="178.329153"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="196.50557" xlink:href="#m41c1f764ca" y="109.291115"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="186.108481" xlink:href="#m41c1f764ca" y="151.934946"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="212.45519" xlink:href="#m41c1f764ca" y="112.480334"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="150.596848" xlink:href="#m41c1f764ca" y="142.372026"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="164.426104" xlink:href="#m41c1f764ca" y="107.077134"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="222.666923" xlink:href="#m41c1f764ca" y="137.78158"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="213.714026" xlink:href="#m41c1f764ca" y="180.089686"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="200.03357" xlink:href="#m41c1f764ca" y="184.943349"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="211.141925" xlink:href="#m41c1f764ca" y="168.249511"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="159.221303" xlink:href="#m41c1f764ca" y="146.415791"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="195.619699" xlink:href="#m41c1f764ca" y="152.271684"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="255.451273" xlink:href="#m41c1f764ca" y="145.203259"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="242.600385" xlink:href="#m41c1f764ca" y="190.27212"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="187.781489" xlink:href="#m41c1f764ca" y="136.810137"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="244.646222" xlink:href="#m41c1f764ca" y="143.121221"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="193.772231" xlink:href="#m41c1f764ca" y="107.407718"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="263.223723" xlink:href="#m41c1f764ca" y="137.306855"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="197.441675" xlink:href="#m41c1f764ca" y="170.219917"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="296.60422" xlink:href="#m41c1f764ca" y="131.422589"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="170.463227" xlink:href="#m41c1f764ca" y="136.689035"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="242.115605" xlink:href="#m41c1f764ca" y="131.043367"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="177.984263" xlink:href="#m41c1f764ca" y="107.86449"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="256.59858" xlink:href="#m41c1f764ca" y="156.318932"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="185.22886" xlink:href="#m41c1f764ca" y="156.192801"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="240.485982" xlink:href="#m41c1f764ca" y="157.569284"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="248.971293" xlink:href="#m41c1f764ca" y="133.3593"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="252.667974" xlink:href="#m41c1f764ca" y="167.957324"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="175.741367" xlink:href="#m41c1f764ca" y="126.4724"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="171.942398" xlink:href="#m41c1f764ca" y="188.927962"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="187.443627" xlink:href="#m41c1f764ca" y="204.851227"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="256.692859" xlink:href="#m41c1f764ca" y="150.627529"></use>
     <use style="fill:#ff0000;stroke:#ff0000;" x="162.152103" xlink:href="#m41c1f764ca" y="132.869874"></use>
    </g>
   </g>
   <g id="matplotlib.axis_1">
    <g id="text_1">
     <!-- first feature -->
     <g transform="translate(158.870313 236.238437)scale(0.1 -0.1)">
      <defs>
       <path d="M 37.109375 75.984375 
L 37.109375 68.5 
L 28.515625 68.5 
Q 23.6875 68.5 21.796875 66.546875 
Q 19.921875 64.59375 19.921875 59.515625 
L 19.921875 54.6875 
L 34.71875 54.6875 
L 34.71875 47.703125 
L 19.921875 47.703125 
L 19.921875 0 
L 10.890625 0 
L 10.890625 47.703125 
L 2.296875 47.703125 
L 2.296875 54.6875 
L 10.890625 54.6875 
L 10.890625 58.5 
Q 10.890625 67.625 15.140625 71.796875 
Q 19.390625 75.984375 28.609375 75.984375 
z
" id="DejaVuSans-102"></path>
       <path d="M 9.421875 54.6875 
L 18.40625 54.6875 
L 18.40625 0 
L 9.421875 0 
z
M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 64.59375 
L 9.421875 64.59375 
z
" id="DejaVuSans-105"></path>
       <path d="M 41.109375 46.296875 
Q 39.59375 47.171875 37.8125 47.578125 
Q 36.03125 48 33.890625 48 
Q 26.265625 48 22.1875 43.046875 
Q 18.109375 38.09375 18.109375 28.8125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 20.953125 51.171875 25.484375 53.578125 
Q 30.03125 56 36.53125 56 
Q 37.453125 56 38.578125 55.875 
Q 39.703125 55.765625 41.0625 55.515625 
z
" id="DejaVuSans-114"></path>
       <path d="M 44.28125 53.078125 
L 44.28125 44.578125 
Q 40.484375 46.53125 36.375 47.5 
Q 32.28125 48.484375 27.875 48.484375 
Q 21.1875 48.484375 17.84375 46.4375 
Q 14.5 44.390625 14.5 40.28125 
Q 14.5 37.15625 16.890625 35.375 
Q 19.28125 33.59375 26.515625 31.984375 
L 29.59375 31.296875 
Q 39.15625 29.25 43.1875 25.515625 
Q 47.21875 21.78125 47.21875 15.09375 
Q 47.21875 7.46875 41.1875 3.015625 
Q 35.15625 -1.421875 24.609375 -1.421875 
Q 20.21875 -1.421875 15.453125 -0.5625 
Q 10.6875 0.296875 5.421875 2 
L 5.421875 11.28125 
Q 10.40625 8.6875 15.234375 7.390625 
Q 20.0625 6.109375 24.8125 6.109375 
Q 31.15625 6.109375 34.5625 8.28125 
Q 37.984375 10.453125 37.984375 14.40625 
Q 37.984375 18.0625 35.515625 20.015625 
Q 33.0625 21.96875 24.703125 23.78125 
L 21.578125 24.515625 
Q 13.234375 26.265625 9.515625 29.90625 
Q 5.8125 33.546875 5.8125 39.890625 
Q 5.8125 47.609375 11.28125 51.796875 
Q 16.75 56 26.8125 56 
Q 31.78125 56 36.171875 55.265625 
Q 40.578125 54.546875 44.28125 53.078125 
z
" id="DejaVuSans-115"></path>
       <path d="M 18.3125 70.21875 
L 18.3125 54.6875 
L 36.8125 54.6875 
L 36.8125 47.703125 
L 18.3125 47.703125 
L 18.3125 18.015625 
Q 18.3125 11.328125 20.140625 9.421875 
Q 21.96875 7.515625 27.59375 7.515625 
L 36.8125 7.515625 
L 36.8125 0 
L 27.59375 0 
Q 17.1875 0 13.234375 3.875 
Q 9.28125 7.765625 9.28125 18.015625 
L 9.28125 47.703125 
L 2.6875 47.703125 
L 2.6875 54.6875 
L 9.28125 54.6875 
L 9.28125 70.21875 
z
" id="DejaVuSans-116"></path>
       <path id="DejaVuSans-32"></path>
       <path d="M 56.203125 29.59375 
L 56.203125 25.203125 
L 14.890625 25.203125 
Q 15.484375 15.921875 20.484375 11.0625 
Q 25.484375 6.203125 34.421875 6.203125 
Q 39.59375 6.203125 44.453125 7.46875 
Q 49.3125 8.734375 54.109375 11.28125 
L 54.109375 2.78125 
Q 49.265625 0.734375 44.1875 -0.34375 
Q 39.109375 -1.421875 33.890625 -1.421875 
Q 20.796875 -1.421875 13.15625 6.1875 
Q 5.515625 13.8125 5.515625 26.8125 
Q 5.515625 40.234375 12.765625 48.109375 
Q 20.015625 56 32.328125 56 
Q 43.359375 56 49.78125 48.890625 
Q 56.203125 41.796875 56.203125 29.59375 
z
M 47.21875 32.234375 
Q 47.125 39.59375 43.09375 43.984375 
Q 39.0625 48.390625 32.421875 48.390625 
Q 24.90625 48.390625 20.390625 44.140625 
Q 15.875 39.890625 15.1875 32.171875 
z
" id="DejaVuSans-101"></path>
       <path d="M 34.28125 27.484375 
Q 23.390625 27.484375 19.1875 25 
Q 14.984375 22.515625 14.984375 16.5 
Q 14.984375 11.71875 18.140625 8.90625 
Q 21.296875 6.109375 26.703125 6.109375 
Q 34.1875 6.109375 38.703125 11.40625 
Q 43.21875 16.703125 43.21875 25.484375 
L 43.21875 27.484375 
z
M 52.203125 31.203125 
L 52.203125 0 
L 43.21875 0 
L 43.21875 8.296875 
Q 40.140625 3.328125 35.546875 0.953125 
Q 30.953125 -1.421875 24.3125 -1.421875 
Q 15.921875 -1.421875 10.953125 3.296875 
Q 6 8.015625 6 15.921875 
Q 6 25.140625 12.171875 29.828125 
Q 18.359375 34.515625 30.609375 34.515625 
L 43.21875 34.515625 
L 43.21875 35.40625 
Q 43.21875 41.609375 39.140625 45 
Q 35.0625 48.390625 27.6875 48.390625 
Q 23 48.390625 18.546875 47.265625 
Q 14.109375 46.140625 10.015625 43.890625 
L 10.015625 52.203125 
Q 14.9375 54.109375 19.578125 55.046875 
Q 24.21875 56 28.609375 56 
Q 40.484375 56 46.34375 49.84375 
Q 52.203125 43.703125 52.203125 31.203125 
z
" id="DejaVuSans-97"></path>
       <path d="M 8.5 21.578125 
L 8.5 54.6875 
L 17.484375 54.6875 
L 17.484375 21.921875 
Q 17.484375 14.15625 20.5 10.265625 
Q 23.53125 6.390625 29.59375 6.390625 
Q 36.859375 6.390625 41.078125 11.03125 
Q 45.3125 15.671875 45.3125 23.6875 
L 45.3125 54.6875 
L 54.296875 54.6875 
L 54.296875 0 
L 45.3125 0 
L 45.3125 8.40625 
Q 42.046875 3.421875 37.71875 1 
Q 33.40625 -1.421875 27.6875 -1.421875 
Q 18.265625 -1.421875 13.375 4.4375 
Q 8.5 10.296875 8.5 21.578125 
z
M 31.109375 56 
z
" id="DejaVuSans-117"></path>
      </defs>
      <use xlink:href="#DejaVuSans-102"></use>
      <use x="35.205078" xlink:href="#DejaVuSans-105"></use>
      <use x="62.988281" xlink:href="#DejaVuSans-114"></use>
      <use x="104.101562" xlink:href="#DejaVuSans-115"></use>
      <use x="156.201172" xlink:href="#DejaVuSans-116"></use>
      <use x="195.410156" xlink:href="#DejaVuSans-32"></use>
      <use x="227.197266" xlink:href="#DejaVuSans-102"></use>
      <use x="262.402344" xlink:href="#DejaVuSans-101"></use>
      <use x="323.925781" xlink:href="#DejaVuSans-97"></use>
      <use x="385.205078" xlink:href="#DejaVuSans-116"></use>
      <use x="424.414062" xlink:href="#DejaVuSans-117"></use>
      <use x="487.792969" xlink:href="#DejaVuSans-114"></use>
      <use x="526.65625" xlink:href="#DejaVuSans-101"></use>
     </g>
    </g>
   </g>
   <g id="matplotlib.axis_2">
    <g id="text_2">
     <!-- second feature -->
     <g transform="translate(14.798438 153.391094)rotate(-90)scale(0.1 -0.1)">
      <defs>
       <path d="M 48.78125 52.59375 
L 48.78125 44.1875 
Q 44.96875 46.296875 41.140625 47.34375 
Q 37.3125 48.390625 33.40625 48.390625 
Q 24.65625 48.390625 19.8125 42.84375 
Q 14.984375 37.3125 14.984375 27.296875 
Q 14.984375 17.28125 19.8125 11.734375 
Q 24.65625 6.203125 33.40625 6.203125 
Q 37.3125 6.203125 41.140625 7.25 
Q 44.96875 8.296875 48.78125 10.40625 
L 48.78125 2.09375 
Q 45.015625 0.34375 40.984375 -0.53125 
Q 36.96875 -1.421875 32.421875 -1.421875 
Q 20.0625 -1.421875 12.78125 6.34375 
Q 5.515625 14.109375 5.515625 27.296875 
Q 5.515625 40.671875 12.859375 48.328125 
Q 20.21875 56 33.015625 56 
Q 37.15625 56 41.109375 55.140625 
Q 45.0625 54.296875 48.78125 52.59375 
z
" id="DejaVuSans-99"></path>
       <path d="M 30.609375 48.390625 
Q 23.390625 48.390625 19.1875 42.75 
Q 14.984375 37.109375 14.984375 27.296875 
Q 14.984375 17.484375 19.15625 11.84375 
Q 23.34375 6.203125 30.609375 6.203125 
Q 37.796875 6.203125 41.984375 11.859375 
Q 46.1875 17.53125 46.1875 27.296875 
Q 46.1875 37.015625 41.984375 42.703125 
Q 37.796875 48.390625 30.609375 48.390625 
z
M 30.609375 56 
Q 42.328125 56 49.015625 48.375 
Q 55.71875 40.765625 55.71875 27.296875 
Q 55.71875 13.875 49.015625 6.21875 
Q 42.328125 -1.421875 30.609375 -1.421875 
Q 18.84375 -1.421875 12.171875 6.21875 
Q 5.515625 13.875 5.515625 27.296875 
Q 5.515625 40.765625 12.171875 48.375 
Q 18.84375 56 30.609375 56 
z
" id="DejaVuSans-111"></path>
       <path d="M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
" id="DejaVuSans-110"></path>
       <path d="M 45.40625 46.390625 
L 45.40625 75.984375 
L 54.390625 75.984375 
L 54.390625 0 
L 45.40625 0 
L 45.40625 8.203125 
Q 42.578125 3.328125 38.25 0.953125 
Q 33.9375 -1.421875 27.875 -1.421875 
Q 17.96875 -1.421875 11.734375 6.484375 
Q 5.515625 14.40625 5.515625 27.296875 
Q 5.515625 40.1875 11.734375 48.09375 
Q 17.96875 56 27.875 56 
Q 33.9375 56 38.25 53.625 
Q 42.578125 51.265625 45.40625 46.390625 
z
M 14.796875 27.296875 
Q 14.796875 17.390625 18.875 11.75 
Q 22.953125 6.109375 30.078125 6.109375 
Q 37.203125 6.109375 41.296875 11.75 
Q 45.40625 17.390625 45.40625 27.296875 
Q 45.40625 37.203125 41.296875 42.84375 
Q 37.203125 48.484375 30.078125 48.484375 
Q 22.953125 48.484375 18.875 42.84375 
Q 14.796875 37.203125 14.796875 27.296875 
z
" id="DejaVuSans-100"></path>
      </defs>
      <use xlink:href="#DejaVuSans-115"></use>
      <use x="52.099609" xlink:href="#DejaVuSans-101"></use>
      <use x="113.623047" xlink:href="#DejaVuSans-99"></use>
      <use x="168.603516" xlink:href="#DejaVuSans-111"></use>
      <use x="229.785156" xlink:href="#DejaVuSans-110"></use>
      <use x="293.164062" xlink:href="#DejaVuSans-100"></use>
      <use x="356.640625" xlink:href="#DejaVuSans-32"></use>
      <use x="388.427734" xlink:href="#DejaVuSans-102"></use>
      <use x="423.632812" xlink:href="#DejaVuSans-101"></use>
      <use x="485.15625" xlink:href="#DejaVuSans-97"></use>
      <use x="546.435547" xlink:href="#DejaVuSans-116"></use>
      <use x="585.644531" xlink:href="#DejaVuSans-117"></use>
      <use x="649.023438" xlink:href="#DejaVuSans-114"></use>
      <use x="687.886719" xlink:href="#DejaVuSans-101"></use>
     </g>
    </g>
   </g>
   <g id="LineCollection_1">
    <path clip-path="url(#p149f15442c)" d="M 355.678125 54.421818 
L 264.369034 113.723636 
L 257.605398 113.723636 
L 254.22358 111.527273 
L 247.459943 111.527273 
L 244.078125 109.330909 
L 223.787216 109.330909 
L 220.405398 107.134545 
L 210.259943 107.134545 
L 205.187216 103.84 
L 205.187216 101.643636 
L 200.114489 98.349091 
L 193.350852 98.349091 
L 189.969034 100.545455 
L 169.678125 100.545455 
L 166.296307 98.349091 
L 164.605398 99.447273 
L 164.605398 101.643636 
L 161.22358 103.84 
L 161.22358 106.036364 
L 157.841761 108.232727 
L 157.841761 119.214545 
L 129.096307 137.883636 
L 125.714489 137.883636 
L 122.33267 140.08 
L 118.950852 140.08 
L 115.569034 142.276364 
L 112.187216 142.276364 
L 108.805398 144.472727 
L 105.42358 144.472727 
L 102.041761 146.669091 
L 98.659943 146.669091 
L 95.278125 148.865455 
L 91.896307 148.865455 
L 88.514489 151.061818 
L 85.13267 151.061818 
L 81.750852 153.258182 
L 74.987216 153.258182 
L 71.605398 155.454545 
L 64.841761 155.454545 
L 61.459943 157.650909 
L 51.314489 157.650909 
L 47.93267 159.847273 
L 41.169034 159.847273 
L 37.787216 162.043636 
L 27.641761 162.043636 
L 24.259943 164.24 
L 20.878125 164.24 
L 20.878125 164.24 
" style="fill:none;stroke:#000000;stroke-width:1.5;"></path>
    <path clip-path="url(#p149f15442c)" d="M 196.73267 115.92 
L 195.041761 114.821818 
L 193.350852 113.723636 
L 189.969034 113.723636 
L 186.587216 113.723636 
L 184.896307 112.625455 
L 183.205398 111.527273 
L 181.514489 110.429091 
L 183.205398 109.330909 
L 184.896307 108.232727 
L 184.896307 106.036364 
L 184.896307 103.84 
L 186.587216 102.741818 
L 188.278125 103.84 
L 188.278125 106.036364 
L 189.969034 107.134545 
L 191.659943 108.232727 
L 193.350852 109.330909 
L 195.041761 110.429091 
L 195.041761 112.625455 
L 196.73267 113.723636 
L 198.42358 114.821818 
L 196.73267 115.92 
" style="fill:none;stroke:#000000;stroke-width:1.5;"></path>
   </g>
   <g id="patch_3">
    <path d="M 20.878125 224.64 
L 20.878125 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
   <g id="patch_4">
    <path d="M 355.678125 224.64 
L 355.678125 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
   <g id="patch_5">
    <path d="M 20.878125 224.64 
L 355.678125 224.64 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
   <g id="patch_6">
    <path d="M 20.878125 7.2 
L 355.678125 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
   <g id="legend_1">
    <g id="patch_7">
     <path d="M 310.315625 44.55625 
L 348.678125 44.55625 
Q 350.678125 44.55625 350.678125 42.55625 
L 350.678125 14.2 
Q 350.678125 12.2 348.678125 12.2 
L 310.315625 12.2 
Q 308.315625 12.2 308.315625 14.2 
L 308.315625 42.55625 
Q 308.315625 44.55625 310.315625 44.55625 
z
" style="fill:#ffffff;opacity:0.8;stroke:#cccccc;stroke-linejoin:miter;"></path>
    </g>
    <g id="PathCollection_3">
     <g>
      <use style="fill:#0000ff;stroke:#0000ff;" x="322.315625" xlink:href="#m8aa1c83cdb" y="21.173437"></use>
     </g>
    </g>
    <g id="text_3">
     <!-- 0 -->
     <g transform="translate(340.315625 23.798437)scale(0.1 -0.1)">
      <defs>
       <path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path>
      </defs>
      <use xlink:href="#DejaVuSans-48"></use>
     </g>
    </g>
    <g id="PathCollection_4">
     <g>
      <use style="fill:#ff0000;stroke:#ff0000;" x="322.315625" xlink:href="#m41c1f764ca" y="35.851562"></use>
     </g>
    </g>
    <g id="text_4">
     <!-- 1 -->
     <g transform="translate(340.315625 38.476562)scale(0.1 -0.1)">
      <defs>
       <path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"></path>
      </defs>
      <use xlink:href="#DejaVuSans-49"></use>
     </g>
    </g>
   </g>
  </g>
 </g>
 <defs>
  <clippath id="p149f15442c">
   <rect height="217.44" width="334.8" x="20.878125" y="7.2"></rect>
  </clippath>
 </defs>
</svg>

</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">knn</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1.0</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="alert alert-success">
    <b>EXERCISE</b>:
     <ul>
      <li>
      Apply the KNeighborsClassifier to the ``iris`` dataset. Play with different values of the ``n_neighbors`` and observe how training and test score change.
      </li>
    </ul>
</div>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># %load solutions/05A_knn_with_diff_k.py</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
                                                    <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                                                    <span class="n">random_state</span><span class="o">=</span><span class="mi">1234</span><span class="p">,</span>
                                                    <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>

<span class="n">X_trainsub</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_trainsub</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span>
                                                            <span class="n">test_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                                                            <span class="n">random_state</span><span class="o">=</span><span class="mi">1234</span><span class="p">,</span>
                                                            <span class="n">stratify</span><span class="o">=</span><span class="n">y_train</span><span class="p">)</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
    <span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
    <span class="n">train_score</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainsub</span><span class="p">,</span> <span class="n">y_trainsub</span><span class="p">)</span><span class="o">.</span>\
        <span class="n">score</span><span class="p">(</span><span class="n">X_trainsub</span><span class="p">,</span> <span class="n">y_trainsub</span><span class="p">)</span>
    <span class="n">valid_score</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'k: </span><span class="si">%d</span><span class="s1">, Train/Valid Acc: </span><span class="si">%.3f</span><span class="s1">/</span><span class="si">%.3f</span><span class="s1">'</span> <span class="o">%</span>
          <span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">train_score</span><span class="p">,</span> <span class="n">valid_score</span><span class="p">))</span>

<span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'k=9 Test Acc: </span><span class="si">%.3f</span><span class="s1">'</span> <span class="o">%</span> <span class="n">knn</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>k: 1, Train/Valid Acc: 1.000/0.946
k: 2, Train/Valid Acc: 1.000/0.964
k: 3, Train/Valid Acc: 1.000/0.946
k: 4, Train/Valid Acc: 1.000/0.964
k: 5, Train/Valid Acc: 1.000/0.929
k: 6, Train/Valid Acc: 1.000/0.929
k: 7, Train/Valid Acc: 1.000/0.929
k: 8, Train/Valid Acc: 1.000/0.929
k: 9, Train/Valid Acc: 1.000/0.929
k: 10, Train/Valid Acc: 1.000/0.946
k: 11, Train/Valid Acc: 1.000/0.946
k: 12, Train/Valid Acc: 1.000/0.964
k: 13, Train/Valid Acc: 1.000/0.929
k: 14, Train/Valid Acc: 1.000/0.946
k: 15, Train/Valid Acc: 1.000/0.929
k: 16, Train/Valid Acc: 1.000/0.929
k: 17, Train/Valid Acc: 1.000/0.929
k: 18, Train/Valid Acc: 0.964/0.946
k: 19, Train/Valid Acc: 0.964/0.929
k=9 Test Acc: 0.974
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Supervised-Learning----Regression-Analysis">
<a class="anchor" href="#Supervised-Learning----Regression-Analysis" aria-hidden="true"><span class="octicon octicon-link"></span></a>Supervised Learning -- Regression Analysis<a class="anchor-link" href="#Supervised-Learning----Regression-Analysis"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In regression we are trying to predict a continuous output variable -- in contrast to the nominal variables we were predicting in the previous classification examples.</p>
<p>Let's start with a simple toy example with one feature dimension (explanatory variable) and one target variable. We will create a dataset out of a sine curve with some noise:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[-3.         -2.93939394 -2.87878788 -2.81818182 -2.75757576 -2.6969697
 -2.63636364 -2.57575758 -2.51515152 -2.45454545 -2.39393939 -2.33333333
 -2.27272727 -2.21212121 -2.15151515 -2.09090909 -2.03030303 -1.96969697
 -1.90909091 -1.84848485 -1.78787879 -1.72727273 -1.66666667 -1.60606061
 -1.54545455 -1.48484848 -1.42424242 -1.36363636 -1.3030303  -1.24242424
 -1.18181818 -1.12121212 -1.06060606 -1.         -0.93939394 -0.87878788
 -0.81818182 -0.75757576 -0.6969697  -0.63636364 -0.57575758 -0.51515152
 -0.45454545 -0.39393939 -0.33333333 -0.27272727 -0.21212121 -0.15151515
 -0.09090909 -0.03030303  0.03030303  0.09090909  0.15151515  0.21212121
  0.27272727  0.33333333  0.39393939  0.45454545  0.51515152  0.57575758
  0.63636364  0.6969697   0.75757576  0.81818182  0.87878788  0.93939394
  1.          1.06060606  1.12121212  1.18181818  1.24242424  1.3030303
  1.36363636  1.42424242  1.48484848  1.54545455  1.60606061  1.66666667
  1.72727273  1.78787879  1.84848485  1.90909091  1.96969697  2.03030303
  2.09090909  2.15151515  2.21212121  2.27272727  2.33333333  2.39393939
  2.45454545  2.51515152  2.57575758  2.63636364  2.6969697   2.75757576
  2.81818182  2.87878788  2.93939394  3.        ]
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">'o'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?>
&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
  "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;
<!-- Created with matplotlib (https://matplotlib.org/) -->
<svg height="248.518125pt" version="1.1" viewbox="0 0 370.942187 248.518125" width="370.942187pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
 <metadata>
  <rdf xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
   <work>
    <type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></type>
    <date>2020-10-14T19:50:03.210166</date>
    <format>image/svg+xml</format>
    <creator>
     <agent>
      <title>Matplotlib v3.3.1, https://matplotlib.org/</title>
     </agent>
    </creator>
   </work>
  </rdf>
 </metadata>
 <defs>
  <style type="text/css">*{stroke-linecap:butt;stroke-linejoin:round;}</style>
 </defs>
 <g id="figure_1">
  <g id="patch_1">
   <path d="M 0 248.518125 
L 370.942187 248.518125 
L 370.942187 0 
L 0 0 
z
" style="fill:none;"></path>
  </g>
  <g id="axes_1">
   <g id="patch_2">
    <path d="M 28.942188 224.64 
L 363.742188 224.64 
L 363.742188 7.2 
L 28.942188 7.2 
z
" style="fill:#ffffff;"></path>
   </g>
   <g id="matplotlib.axis_1">
    <g id="xtick_1">
     <g id="line2d_1">
      <defs>
       <path d="M 0 0 
L 0 3.5 
" id="m5b70b7b7a1" style="stroke:#000000;stroke-width:0.8;"></path>
      </defs>
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="44.160369" xlink:href="#m5b70b7b7a1" y="224.64"></use>
      </g>
     </g>
     <g id="text_1">
      <!-- −3 -->
      <g transform="translate(36.789276 239.238438)scale(0.1 -0.1)">
       <defs>
        <path d="M 10.59375 35.5 
L 73.1875 35.5 
L 73.1875 27.203125 
L 10.59375 27.203125 
z
" id="DejaVuSans-8722"></path>
        <path d="M 40.578125 39.3125 
Q 47.65625 37.796875 51.625 33 
Q 55.609375 28.21875 55.609375 21.1875 
Q 55.609375 10.40625 48.1875 4.484375 
Q 40.765625 -1.421875 27.09375 -1.421875 
Q 22.515625 -1.421875 17.65625 -0.515625 
Q 12.796875 0.390625 7.625 2.203125 
L 7.625 11.71875 
Q 11.71875 9.328125 16.59375 8.109375 
Q 21.484375 6.890625 26.8125 6.890625 
Q 36.078125 6.890625 40.9375 10.546875 
Q 45.796875 14.203125 45.796875 21.1875 
Q 45.796875 27.640625 41.28125 31.265625 
Q 36.765625 34.90625 28.71875 34.90625 
L 20.21875 34.90625 
L 20.21875 43.015625 
L 29.109375 43.015625 
Q 36.375 43.015625 40.234375 45.921875 
Q 44.09375 48.828125 44.09375 54.296875 
Q 44.09375 59.90625 40.109375 62.90625 
Q 36.140625 65.921875 28.71875 65.921875 
Q 24.65625 65.921875 20.015625 65.03125 
Q 15.375 64.15625 9.8125 62.3125 
L 9.8125 71.09375 
Q 15.4375 72.65625 20.34375 73.4375 
Q 25.25 74.21875 29.59375 74.21875 
Q 40.828125 74.21875 47.359375 69.109375 
Q 53.90625 64.015625 53.90625 55.328125 
Q 53.90625 49.265625 50.4375 45.09375 
Q 46.96875 40.921875 40.578125 39.3125 
z
" id="DejaVuSans-51"></path>
       </defs>
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-51"></use>
      </g>
     </g>
    </g>
    <g id="xtick_2">
     <g id="line2d_2">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="94.887642" xlink:href="#m5b70b7b7a1" y="224.64"></use>
      </g>
     </g>
     <g id="text_2">
      <!-- −2 -->
      <g transform="translate(87.516548 239.238438)scale(0.1 -0.1)">
       <defs>
        <path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"></path>
       </defs>
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-50"></use>
      </g>
     </g>
    </g>
    <g id="xtick_3">
     <g id="line2d_3">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="145.614915" xlink:href="#m5b70b7b7a1" y="224.64"></use>
      </g>
     </g>
     <g id="text_3">
      <!-- −1 -->
      <g transform="translate(138.243821 239.238438)scale(0.1 -0.1)">
       <defs>
        <path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"></path>
       </defs>
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-49"></use>
      </g>
     </g>
    </g>
    <g id="xtick_4">
     <g id="line2d_4">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="196.342188" xlink:href="#m5b70b7b7a1" y="224.64"></use>
      </g>
     </g>
     <g id="text_4">
      <!-- 0 -->
      <g transform="translate(193.160938 239.238438)scale(0.1 -0.1)">
       <defs>
        <path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path>
       </defs>
       <use xlink:href="#DejaVuSans-48"></use>
      </g>
     </g>
    </g>
    <g id="xtick_5">
     <g id="line2d_5">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="247.06946" xlink:href="#m5b70b7b7a1" y="224.64"></use>
      </g>
     </g>
     <g id="text_5">
      <!-- 1 -->
      <g transform="translate(243.88821 239.238438)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-49"></use>
      </g>
     </g>
    </g>
    <g id="xtick_6">
     <g id="line2d_6">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="297.796733" xlink:href="#m5b70b7b7a1" y="224.64"></use>
      </g>
     </g>
     <g id="text_6">
      <!-- 2 -->
      <g transform="translate(294.615483 239.238438)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-50"></use>
      </g>
     </g>
    </g>
    <g id="xtick_7">
     <g id="line2d_7">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="348.524006" xlink:href="#m5b70b7b7a1" y="224.64"></use>
      </g>
     </g>
     <g id="text_7">
      <!-- 3 -->
      <g transform="translate(345.342756 239.238438)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-51"></use>
      </g>
     </g>
    </g>
   </g>
   <g id="matplotlib.axis_2">
    <g id="ytick_1">
     <g id="line2d_8">
      <defs>
       <path d="M 0 0 
L -3.5 0 
" id="mf510e8ea04" style="stroke:#000000;stroke-width:0.8;"></path>
      </defs>
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#mf510e8ea04" y="221.551164"></use>
      </g>
     </g>
     <g id="text_8">
      <!-- −3 -->
      <g transform="translate(7.2 225.350383)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-51"></use>
      </g>
     </g>
    </g>
    <g id="ytick_2">
     <g id="line2d_9">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#mf510e8ea04" y="190.606972"></use>
      </g>
     </g>
     <g id="text_9">
      <!-- −2 -->
      <g transform="translate(7.2 194.40619)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-50"></use>
      </g>
     </g>
    </g>
    <g id="ytick_3">
     <g id="line2d_10">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#mf510e8ea04" y="159.662779"></use>
      </g>
     </g>
     <g id="text_10">
      <!-- −1 -->
      <g transform="translate(7.2 163.461998)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-49"></use>
      </g>
     </g>
    </g>
    <g id="ytick_4">
     <g id="line2d_11">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#mf510e8ea04" y="128.718587"></use>
      </g>
     </g>
     <g id="text_11">
      <!-- 0 -->
      <g transform="translate(15.579688 132.517805)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-48"></use>
      </g>
     </g>
    </g>
    <g id="ytick_5">
     <g id="line2d_12">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#mf510e8ea04" y="97.774394"></use>
      </g>
     </g>
     <g id="text_12">
      <!-- 1 -->
      <g transform="translate(15.579688 101.573613)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-49"></use>
      </g>
     </g>
    </g>
    <g id="ytick_6">
     <g id="line2d_13">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#mf510e8ea04" y="66.830202"></use>
      </g>
     </g>
     <g id="text_13">
      <!-- 2 -->
      <g transform="translate(15.579688 70.62942)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-50"></use>
      </g>
     </g>
    </g>
    <g id="ytick_7">
     <g id="line2d_14">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#mf510e8ea04" y="35.886009"></use>
      </g>
     </g>
     <g id="text_14">
      <!-- 3 -->
      <g transform="translate(15.579688 39.685228)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-51"></use>
      </g>
     </g>
    </g>
   </g>
   <g id="line2d_15">
    <defs>
     <path d="M 0 3 
C 0.795609 3 1.55874 2.683901 2.12132 2.12132 
C 2.683901 1.55874 3 0.795609 3 0 
C 3 -0.795609 2.683901 -1.55874 2.12132 -2.12132 
C 1.55874 -2.683901 0.795609 -3 0 -3 
C -0.795609 -3 -1.55874 -2.683901 -2.12132 -2.12132 
C -2.683901 -1.55874 -3 -0.795609 -3 0 
C -3 0.795609 -2.683901 1.55874 -2.12132 2.12132 
C -1.55874 2.683901 -0.795609 3 0 3 
z
" id="m714b1e55e0" style="stroke:#1f77b4;"></path>
    </defs>
    <g clip-path="url(#pc654774c3d)">
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="44.160369" xlink:href="#m714b1e55e0" y="193.357507"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="47.234749" xlink:href="#m714b1e55e0" y="167.869919"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="50.30913" xlink:href="#m714b1e55e0" y="168.28893"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="53.38351" xlink:href="#m714b1e55e0" y="167.636633"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="56.45789" xlink:href="#m714b1e55e0" y="178.296137"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="59.53227" xlink:href="#m714b1e55e0" y="177.06785"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="62.60665" xlink:href="#m714b1e55e0" y="180.639383"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="65.68103" xlink:href="#m714b1e55e0" y="157.804805"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="68.755411" xlink:href="#m714b1e55e0" y="169.570878"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="71.829791" xlink:href="#m714b1e55e0" y="170.899804"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="74.904171" xlink:href="#m714b1e55e0" y="197.505924"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="77.978551" xlink:href="#m714b1e55e0" y="173.734363"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="81.052931" xlink:href="#m714b1e55e0" y="183.427465"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="84.127311" xlink:href="#m714b1e55e0" y="207.462323"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="87.201692" xlink:href="#m714b1e55e0" y="212.26668"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="90.276072" xlink:href="#m714b1e55e0" y="214.756364"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="93.350452" xlink:href="#m714b1e55e0" y="211.976"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="96.424832" xlink:href="#m714b1e55e0" y="204.365777"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="99.499212" xlink:href="#m714b1e55e0" y="204.642032"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="102.573592" xlink:href="#m714b1e55e0" y="204.633648"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="105.647973" xlink:href="#m714b1e55e0" y="188.727941"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="108.722353" xlink:href="#m714b1e55e0" y="195.979202"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="111.796733" xlink:href="#m714b1e55e0" y="182.829868"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="114.871113" xlink:href="#m714b1e55e0" y="171.430502"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="117.945493" xlink:href="#m714b1e55e0" y="159.297357"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="121.019873" xlink:href="#m714b1e55e0" y="139.939369"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="124.094254" xlink:href="#m714b1e55e0" y="149.493162"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="127.168634" xlink:href="#m714b1e55e0" y="132.196379"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="130.243014" xlink:href="#m714b1e55e0" y="123.547961"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="133.317394" xlink:href="#m714b1e55e0" y="135.801566"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="136.391774" xlink:href="#m714b1e55e0" y="115.548246"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="139.466154" xlink:href="#m714b1e55e0" y="127.990279"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="142.540535" xlink:href="#m714b1e55e0" y="131.935861"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="145.614915" xlink:href="#m714b1e55e0" y="106.88164"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="148.689295" xlink:href="#m714b1e55e0" y="110.028316"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="151.763675" xlink:href="#m714b1e55e0" y="119.604265"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="154.838055" xlink:href="#m714b1e55e0" y="140.5643"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="157.912435" xlink:href="#m714b1e55e0" y="152.575435"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="160.986816" xlink:href="#m714b1e55e0" y="139.83129"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="164.061196" xlink:href="#m714b1e55e0" y="152.163827"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="167.135576" xlink:href="#m714b1e55e0" y="165.771228"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="170.209956" xlink:href="#m714b1e55e0" y="156.642533"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="173.284336" xlink:href="#m714b1e55e0" y="171.722129"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="176.358716" xlink:href="#m714b1e55e0" y="143.714349"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="179.433097" xlink:href="#m714b1e55e0" y="161.101413"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="182.507477" xlink:href="#m714b1e55e0" y="144.105647"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="185.581857" xlink:href="#m714b1e55e0" y="148.853654"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="188.656237" xlink:href="#m714b1e55e0" y="134.940883"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="191.730617" xlink:href="#m714b1e55e0" y="125.620267"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="194.804997" xlink:href="#m714b1e55e0" y="127.677751"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="197.879378" xlink:href="#m714b1e55e0" y="94.036237"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="200.953758" xlink:href="#m714b1e55e0" y="90.913538"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="204.028138" xlink:href="#m714b1e55e0" y="77.331169"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="207.102518" xlink:href="#m714b1e55e0" y="71.248162"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="210.176898" xlink:href="#m714b1e55e0" y="74.328776"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="213.251278" xlink:href="#m714b1e55e0" y="59.801368"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="216.325659" xlink:href="#m714b1e55e0" y="82.846309"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="219.400039" xlink:href="#m714b1e55e0" y="78.586387"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="222.474419" xlink:href="#m714b1e55e0" y="84.072269"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="225.548799" xlink:href="#m714b1e55e0" y="77.822486"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="228.623179" xlink:href="#m714b1e55e0" y="79.625878"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="231.697559" xlink:href="#m714b1e55e0" y="88.036168"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="234.77194" xlink:href="#m714b1e55e0" y="76.19474"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="237.84632" xlink:href="#m714b1e55e0" y="96.407402"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="240.9207" xlink:href="#m714b1e55e0" y="104.124414"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="243.99508" xlink:href="#m714b1e55e0" y="100.734862"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="247.06946" xlink:href="#m714b1e55e0" y="116.83225"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="250.14384" xlink:href="#m714b1e55e0" y="98.665006"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="253.218221" xlink:href="#m714b1e55e0" y="121.863253"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="256.292601" xlink:href="#m714b1e55e0" y="92.550523"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="259.366981" xlink:href="#m714b1e55e0" y="96.301745"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="262.441361" xlink:href="#m714b1e55e0" y="109.408325"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="265.515741" xlink:href="#m714b1e55e0" y="109.157348"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="268.590121" xlink:href="#m714b1e55e0" y="76.531472"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="271.664502" xlink:href="#m714b1e55e0" y="71.328039"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="274.738882" xlink:href="#m714b1e55e0" y="61.46856"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="277.813262" xlink:href="#m714b1e55e0" y="50.803562"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="280.887642" xlink:href="#m714b1e55e0" y="63.275873"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="283.962022" xlink:href="#m714b1e55e0" y="46.049013"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="287.036402" xlink:href="#m714b1e55e0" y="46.190464"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="290.110783" xlink:href="#m714b1e55e0" y="17.083636"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="293.185163" xlink:href="#m714b1e55e0" y="20.141494"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="296.259543" xlink:href="#m714b1e55e0" y="26.59386"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="299.333923" xlink:href="#m714b1e55e0" y="34.07988"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="302.408303" xlink:href="#m714b1e55e0" y="27.382408"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="305.482683" xlink:href="#m714b1e55e0" y="29.481531"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="308.557064" xlink:href="#m714b1e55e0" y="20.827114"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="311.631444" xlink:href="#m714b1e55e0" y="28.521741"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="314.705824" xlink:href="#m714b1e55e0" y="26.235651"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="317.780204" xlink:href="#m714b1e55e0" y="44.681969"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="320.854584" xlink:href="#m714b1e55e0" y="60.925888"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="323.928964" xlink:href="#m714b1e55e0" y="47.194493"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="327.003345" xlink:href="#m714b1e55e0" y="49.287368"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="330.077725" xlink:href="#m714b1e55e0" y="57.63217"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="333.152105" xlink:href="#m714b1e55e0" y="51.685242"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="336.226485" xlink:href="#m714b1e55e0" y="59.033059"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="339.300865" xlink:href="#m714b1e55e0" y="55.099991"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="342.375245" xlink:href="#m714b1e55e0" y="53.26737"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="345.449626" xlink:href="#m714b1e55e0" y="59.361593"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="348.524006" xlink:href="#m714b1e55e0" y="49.151212"></use>
    </g>
   </g>
   <g id="patch_3">
    <path d="M 28.942188 224.64 
L 28.942188 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
   <g id="patch_4">
    <path d="M 363.742188 224.64 
L 363.742188 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
   <g id="patch_5">
    <path d="M 28.942188 224.64 
L 363.742188 224.64 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
   <g id="patch_6">
    <path d="M 28.942188 7.2 
L 363.742188 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
  </g>
 </g>
 <defs>
  <clippath id="pc654774c3d">
   <rect height="217.44" width="334.8" x="28.942188" y="7.2"></rect>
  </clippath>
 </defs>
</svg>

</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Linear-Regression">
<a class="anchor" href="#Linear-Regression" aria-hidden="true"><span class="octicon octicon-link"></span></a>Linear Regression<a class="anchor-link" href="#Linear-Regression"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The first model that we will introduce is the so-called simple linear regression. Here, we want to fit a line to the data, which</p>
<p>One of the simplest models again is a linear one, that simply tries to predict the data as lying on a line. One way to find such a line is <code>LinearRegression</code> (also known as <a href="https://en.wikipedia.org/wiki/Ordinary_least_squares"><em>Ordinary Least Squares (OLS)</em></a> regression).
The interface for LinearRegression is exactly the same as for the classifiers before, only that <code>y</code> now contains float values, instead of classes.</p>
<p>As we remember, the scikit-learn API requires us to provide the target variable (<code>y</code>) as a 1-dimensional array; scikit-learn's API expects the samples (<code>X</code>) in form a 2-dimensional array -- even though it may only consist of 1 feature. Thus, let us convert the 1-dimensional <code>x</code> NumPy array into an <code>X</code> array with 2 axes:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">'Before: '</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'After: '</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Before:  (100,)
After:  (100, 1)
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Again, we start by splitting our dataset into a training (75%) and a test set (25%):</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we use the learning algorithm implemented in <code>LinearRegression</code> to <strong>fit a regression model to the training data</strong>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>

<span class="n">regressor</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">regressor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>LinearRegression()</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After fitting to the training data, we paramerterized a linear regression model with the following values.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">'Weight coefficients: '</span><span class="p">,</span> <span class="n">regressor</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'y-axis intercept: '</span><span class="p">,</span> <span class="n">regressor</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Weight coefficients:  [0.90211711]
y-axis intercept:  0.44840974988268
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since our regression model is a linear one, the relationship between the target variable (y) and the feature variable (x) is defined as</p>
$$y = weight \times x + \text{intercept}$$<p>.</p>
<p>Plugging in the min and max values into thos equation, we can plot the regression fit to our training data:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">min_pt</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">*</span> <span class="n">regressor</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">regressor</span><span class="o">.</span><span class="n">intercept_</span>
<span class="n">max_pt</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="n">regressor</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">regressor</span><span class="o">.</span><span class="n">intercept_</span>

<span class="nb">print</span><span class="p">(</span><span class="n">min_pt</span><span class="p">,</span> <span class="n">max_pt</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>-2.2579415855468374 3.154761085312198 -3.0 3.0
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">X</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span> <span class="p">[</span><span class="n">min_pt</span><span class="p">,</span> <span class="n">max_pt</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="s1">'o'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?>
&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
  "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;
<!-- Created with matplotlib (https://matplotlib.org/) -->
<svg height="248.518125pt" version="1.1" viewbox="0 0 370.942187 248.518125" width="370.942187pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
 <metadata>
  <rdf xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
   <work>
    <type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></type>
    <date>2020-10-14T19:50:18.828487</date>
    <format>image/svg+xml</format>
    <creator>
     <agent>
      <title>Matplotlib v3.3.1, https://matplotlib.org/</title>
     </agent>
    </creator>
   </work>
  </rdf>
 </metadata>
 <defs>
  <style type="text/css">*{stroke-linecap:butt;stroke-linejoin:round;}</style>
 </defs>
 <g id="figure_1">
  <g id="patch_1">
   <path d="M 0 248.518125 
L 370.942187 248.518125 
L 370.942187 0 
L 0 0 
z
" style="fill:none;"></path>
  </g>
  <g id="axes_1">
   <g id="patch_2">
    <path d="M 28.942188 224.64 
L 363.742188 224.64 
L 363.742188 7.2 
L 28.942188 7.2 
z
" style="fill:#ffffff;"></path>
   </g>
   <g id="matplotlib.axis_1">
    <g id="xtick_1">
     <g id="line2d_1">
      <defs>
       <path d="M 0 0 
L 0 3.5 
" id="mad63a7dcc1" style="stroke:#000000;stroke-width:0.8;"></path>
      </defs>
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="44.160369" xlink:href="#mad63a7dcc1" y="224.64"></use>
      </g>
     </g>
     <g id="text_1">
      <!-- −3 -->
      <g transform="translate(36.789276 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 10.59375 35.5 
L 73.1875 35.5 
L 73.1875 27.203125 
L 10.59375 27.203125 
z
" id="DejaVuSans-8722"></path>
        <path d="M 40.578125 39.3125 
Q 47.65625 37.796875 51.625 33 
Q 55.609375 28.21875 55.609375 21.1875 
Q 55.609375 10.40625 48.1875 4.484375 
Q 40.765625 -1.421875 27.09375 -1.421875 
Q 22.515625 -1.421875 17.65625 -0.515625 
Q 12.796875 0.390625 7.625 2.203125 
L 7.625 11.71875 
Q 11.71875 9.328125 16.59375 8.109375 
Q 21.484375 6.890625 26.8125 6.890625 
Q 36.078125 6.890625 40.9375 10.546875 
Q 45.796875 14.203125 45.796875 21.1875 
Q 45.796875 27.640625 41.28125 31.265625 
Q 36.765625 34.90625 28.71875 34.90625 
L 20.21875 34.90625 
L 20.21875 43.015625 
L 29.109375 43.015625 
Q 36.375 43.015625 40.234375 45.921875 
Q 44.09375 48.828125 44.09375 54.296875 
Q 44.09375 59.90625 40.109375 62.90625 
Q 36.140625 65.921875 28.71875 65.921875 
Q 24.65625 65.921875 20.015625 65.03125 
Q 15.375 64.15625 9.8125 62.3125 
L 9.8125 71.09375 
Q 15.4375 72.65625 20.34375 73.4375 
Q 25.25 74.21875 29.59375 74.21875 
Q 40.828125 74.21875 47.359375 69.109375 
Q 53.90625 64.015625 53.90625 55.328125 
Q 53.90625 49.265625 50.4375 45.09375 
Q 46.96875 40.921875 40.578125 39.3125 
z
" id="DejaVuSans-51"></path>
       </defs>
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-51"></use>
      </g>
     </g>
    </g>
    <g id="xtick_2">
     <g id="line2d_2">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="94.887642" xlink:href="#mad63a7dcc1" y="224.64"></use>
      </g>
     </g>
     <g id="text_2">
      <!-- −2 -->
      <g transform="translate(87.516548 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"></path>
       </defs>
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-50"></use>
      </g>
     </g>
    </g>
    <g id="xtick_3">
     <g id="line2d_3">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="145.614915" xlink:href="#mad63a7dcc1" y="224.64"></use>
      </g>
     </g>
     <g id="text_3">
      <!-- −1 -->
      <g transform="translate(138.243821 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"></path>
       </defs>
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-49"></use>
      </g>
     </g>
    </g>
    <g id="xtick_4">
     <g id="line2d_4">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="196.342188" xlink:href="#mad63a7dcc1" y="224.64"></use>
      </g>
     </g>
     <g id="text_4">
      <!-- 0 -->
      <g transform="translate(193.160938 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path>
       </defs>
       <use xlink:href="#DejaVuSans-48"></use>
      </g>
     </g>
    </g>
    <g id="xtick_5">
     <g id="line2d_5">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="247.06946" xlink:href="#mad63a7dcc1" y="224.64"></use>
      </g>
     </g>
     <g id="text_5">
      <!-- 1 -->
      <g transform="translate(243.88821 239.238437)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-49"></use>
      </g>
     </g>
    </g>
    <g id="xtick_6">
     <g id="line2d_6">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="297.796733" xlink:href="#mad63a7dcc1" y="224.64"></use>
      </g>
     </g>
     <g id="text_6">
      <!-- 2 -->
      <g transform="translate(294.615483 239.238437)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-50"></use>
      </g>
     </g>
    </g>
    <g id="xtick_7">
     <g id="line2d_7">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="348.524006" xlink:href="#mad63a7dcc1" y="224.64"></use>
      </g>
     </g>
     <g id="text_7">
      <!-- 3 -->
      <g transform="translate(345.342756 239.238437)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-51"></use>
      </g>
     </g>
    </g>
   </g>
   <g id="matplotlib.axis_2">
    <g id="ytick_1">
     <g id="line2d_8">
      <defs>
       <path d="M 0 0 
L -3.5 0 
" id="me79d1a2a5c" style="stroke:#000000;stroke-width:0.8;"></path>
      </defs>
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#me79d1a2a5c" y="221.657926"></use>
      </g>
     </g>
     <g id="text_8">
      <!-- −3 -->
      <g transform="translate(7.2 225.457145)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-51"></use>
      </g>
     </g>
    </g>
    <g id="ytick_2">
     <g id="line2d_9">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#me79d1a2a5c" y="190.227528"></use>
      </g>
     </g>
     <g id="text_9">
      <!-- −2 -->
      <g transform="translate(7.2 194.026746)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-50"></use>
      </g>
     </g>
    </g>
    <g id="ytick_3">
     <g id="line2d_10">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#me79d1a2a5c" y="158.797129"></use>
      </g>
     </g>
     <g id="text_10">
      <!-- −1 -->
      <g transform="translate(7.2 162.596348)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-49"></use>
      </g>
     </g>
    </g>
    <g id="ytick_4">
     <g id="line2d_11">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#me79d1a2a5c" y="127.36673"></use>
      </g>
     </g>
     <g id="text_11">
      <!-- 0 -->
      <g transform="translate(15.579688 131.165949)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-48"></use>
      </g>
     </g>
    </g>
    <g id="ytick_5">
     <g id="line2d_12">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#me79d1a2a5c" y="95.936332"></use>
      </g>
     </g>
     <g id="text_12">
      <!-- 1 -->
      <g transform="translate(15.579688 99.73555)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-49"></use>
      </g>
     </g>
    </g>
    <g id="ytick_6">
     <g id="line2d_13">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#me79d1a2a5c" y="64.505933"></use>
      </g>
     </g>
     <g id="text_13">
      <!-- 2 -->
      <g transform="translate(15.579688 68.305152)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-50"></use>
      </g>
     </g>
    </g>
    <g id="ytick_7">
     <g id="line2d_14">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#me79d1a2a5c" y="33.075534"></use>
      </g>
     </g>
     <g id="text_14">
      <!-- 3 -->
      <g transform="translate(15.579688 36.874753)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-51"></use>
      </g>
     </g>
    </g>
   </g>
   <g id="line2d_15">
    <path clip-path="url(#pc5f495f7ff)" d="M 44.160369 198.334735 
L 348.524006 28.211332 
" style="fill:none;stroke:#1f77b4;stroke-linecap:square;stroke-width:1.5;"></path>
   </g>
   <g id="line2d_16">
    <defs>
     <path d="M 0 3 
C 0.795609 3 1.55874 2.683901 2.12132 2.12132 
C 2.683901 1.55874 3 0.795609 3 0 
C 3 -0.795609 2.683901 -1.55874 2.12132 -2.12132 
C 1.55874 -2.683901 0.795609 -3 0 -3 
C -0.795609 -3 -1.55874 -2.683901 -2.12132 -2.12132 
C -2.683901 -1.55874 -3 -0.795609 -3 0 
C -3 0.795609 -2.683901 1.55874 -2.12132 2.12132 
C -1.55874 2.683901 -0.795609 3 0 3 
z
" id="m6abb192222" style="stroke:#ff7f0e;"></path>
    </defs>
    <g clip-path="url(#pc5f495f7ff)">
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="90.276072" xlink:href="#m6abb192222" y="214.756364"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="167.135576" xlink:href="#m6abb192222" y="165.001556"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="339.300865" xlink:href="#m6abb192222" y="52.591413"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="71.829791" xlink:href="#m6abb192222" y="170.210714"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="265.515741" xlink:href="#m6abb192222" y="107.498138"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="77.978551" xlink:href="#m6abb192222" y="173.089811"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="188.656237" xlink:href="#m6abb192222" y="133.686794"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="305.482683" xlink:href="#m6abb192222" y="26.570427"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="130.243014" xlink:href="#m6abb192222" y="122.114863"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="330.077725" xlink:href="#m6abb192222" y="55.163378"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="59.53227" xlink:href="#m6abb192222" y="176.475674"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="247.06946" xlink:href="#m6abb192222" y="115.293631"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="243.99508" xlink:href="#m6abb192222" y="98.943316"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="151.763675" xlink:href="#m6abb192222" y="118.109201"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="93.350452" xlink:href="#m6abb192222" y="211.932314"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="194.804997" xlink:href="#m6abb192222" y="126.309541"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="148.689295" xlink:href="#m6abb192222" y="108.382791"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="65.68103" xlink:href="#m6abb192222" y="156.909961"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="336.226485" xlink:href="#m6abb192222" y="56.586279"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="127.168634" xlink:href="#m6abb192222" y="130.899167"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="102.573592" xlink:href="#m6abb192222" y="204.474596"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="293.185163" xlink:href="#m6abb192222" y="17.083636"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="121.019873" xlink:href="#m6abb192222" y="138.763817"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="234.77194" xlink:href="#m6abb192222" y="74.017611"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="84.127311" xlink:href="#m6abb192222" y="207.347716"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="117.945493" xlink:href="#m6abb192222" y="158.425966"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="53.38351" xlink:href="#m6abb192222" y="166.896271"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="96.424832" xlink:href="#m6abb192222" y="204.202516"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="160.986816" xlink:href="#m6abb192222" y="138.654041"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="68.755411" xlink:href="#m6abb192222" y="168.860907"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="283.962022" xlink:href="#m6abb192222" y="43.398223"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="62.60665" xlink:href="#m6abb192222" y="180.103325"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="240.9207" xlink:href="#m6abb192222" y="102.386125"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="154.838055" xlink:href="#m6abb192222" y="139.398568"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="317.780204" xlink:href="#m6abb192222" y="42.009699"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="216.325659" xlink:href="#m6abb192222" y="80.773692"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="348.524006" xlink:href="#m6abb192222" y="46.549165"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="210.176898" xlink:href="#m6abb192222" y="72.122328"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="176.358716" xlink:href="#m6abb192222" y="142.598112"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="197.879378" xlink:href="#m6abb192222" y="92.13944"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="250.14384" xlink:href="#m6abb192222" y="96.840937"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="185.581857" xlink:href="#m6abb192222" y="147.818167"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="253.218221" xlink:href="#m6abb192222" y="120.403684"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="231.697559" xlink:href="#m6abb192222" y="86.045095"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="342.375245" xlink:href="#m6abb192222" y="50.729998"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="287.036402" xlink:href="#m6abb192222" y="43.541896"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="170.209956" xlink:href="#m6abb192222" y="155.729428"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="222.474419" xlink:href="#m6abb192222" y="82.018914"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="191.730617" xlink:href="#m6abb192222" y="124.219729"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="345.449626" xlink:href="#m6abb192222" y="56.919975"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="219.400039" xlink:href="#m6abb192222" y="76.446836"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="274.738882" xlink:href="#m6abb192222" y="59.060048"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="142.540535" xlink:href="#m6abb192222" y="130.634556"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="333.152105" xlink:href="#m6abb192222" y="49.123011"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="225.548799" xlink:href="#m6abb192222" y="75.670932"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="237.84632" xlink:href="#m6abb192222" y="94.547861"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="302.408303" xlink:href="#m6abb192222" y="24.438322"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="157.912435" xlink:href="#m6abb192222" y="151.598426"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="133.317394" xlink:href="#m6abb192222" y="134.561001"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="47.234749" xlink:href="#m6abb192222" y="167.133223"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="204.028138" xlink:href="#m6abb192222" y="75.171895"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="108.722353" xlink:href="#m6abb192222" y="195.684169"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="50.30913" xlink:href="#m6abb192222" y="167.558817"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="114.871113" xlink:href="#m6abb192222" y="170.74975"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="311.631444" xlink:href="#m6abb192222" y="25.595557"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="323.928964" xlink:href="#m6abb192222" y="44.561701"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="271.664502" xlink:href="#m6abb192222" y="69.074442"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="308.557064" xlink:href="#m6abb192222" y="17.780029"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="296.259543" xlink:href="#m6abb192222" y="23.637384"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="105.647973" xlink:href="#m6abb192222" y="188.318973"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="228.623179" xlink:href="#m6abb192222" y="77.502659"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="262.441361" xlink:href="#m6abb192222" y="107.753059"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="87.201692" xlink:href="#m6abb192222" y="212.227561"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="327.003345" xlink:href="#m6abb192222" y="46.68746"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="200.953758" xlink:href="#m6abb192222" y="88.967676"></use>
    </g>
   </g>
   <g id="patch_3">
    <path d="M 28.942188 224.64 
L 28.942188 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
   <g id="patch_4">
    <path d="M 363.742188 224.64 
L 363.742188 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
   <g id="patch_5">
    <path d="M 28.942188 224.64 
L 363.742188 224.64 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
   <g id="patch_6">
    <path d="M 28.942188 7.2 
L 363.742188 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
  </g>
 </g>
 <defs>
  <clippath id="pc5f495f7ff">
   <rect height="217.44" width="334.8" x="28.942188" y="7.2"></rect>
  </clippath>
 </defs>
</svg>

</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Similar to the estimators for classification in the previous notebook, we use the <code>predict</code> method to predict the target variable. And we expect these predicted values to fall onto the line that we plotted previously:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">regressor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="s1">'o'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"data"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_pred_train</span><span class="p">,</span> <span class="s1">'o'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"prediction"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">X</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span> <span class="p">[</span><span class="n">min_pt</span><span class="p">,</span> <span class="n">max_pt</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">'fit'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x18eb141f520&gt;</pre>
</div>

</div>

<div class="output_area">


<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?>
&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
  "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;
<!-- Created with matplotlib (https://matplotlib.org/) -->
<svg height="248.518125pt" version="1.1" viewbox="0 0 370.942187 248.518125" width="370.942187pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
 <metadata>
  <rdf xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
   <work>
    <type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></type>
    <date>2020-10-14T19:50:24.565745</date>
    <format>image/svg+xml</format>
    <creator>
     <agent>
      <title>Matplotlib v3.3.1, https://matplotlib.org/</title>
     </agent>
    </creator>
   </work>
  </rdf>
 </metadata>
 <defs>
  <style type="text/css">*{stroke-linecap:butt;stroke-linejoin:round;}</style>
 </defs>
 <g id="figure_1">
  <g id="patch_1">
   <path d="M 0 248.518125 
L 370.942187 248.518125 
L 370.942187 0 
L 0 0 
z
" style="fill:none;"></path>
  </g>
  <g id="axes_1">
   <g id="patch_2">
    <path d="M 28.942188 224.64 
L 363.742188 224.64 
L 363.742188 7.2 
L 28.942188 7.2 
z
" style="fill:#ffffff;"></path>
   </g>
   <g id="matplotlib.axis_1">
    <g id="xtick_1">
     <g id="line2d_1">
      <defs>
       <path d="M 0 0 
L 0 3.5 
" id="md936b47549" style="stroke:#000000;stroke-width:0.8;"></path>
      </defs>
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="44.160369" xlink:href="#md936b47549" y="224.64"></use>
      </g>
     </g>
     <g id="text_1">
      <!-- −3 -->
      <g transform="translate(36.789276 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 10.59375 35.5 
L 73.1875 35.5 
L 73.1875 27.203125 
L 10.59375 27.203125 
z
" id="DejaVuSans-8722"></path>
        <path d="M 40.578125 39.3125 
Q 47.65625 37.796875 51.625 33 
Q 55.609375 28.21875 55.609375 21.1875 
Q 55.609375 10.40625 48.1875 4.484375 
Q 40.765625 -1.421875 27.09375 -1.421875 
Q 22.515625 -1.421875 17.65625 -0.515625 
Q 12.796875 0.390625 7.625 2.203125 
L 7.625 11.71875 
Q 11.71875 9.328125 16.59375 8.109375 
Q 21.484375 6.890625 26.8125 6.890625 
Q 36.078125 6.890625 40.9375 10.546875 
Q 45.796875 14.203125 45.796875 21.1875 
Q 45.796875 27.640625 41.28125 31.265625 
Q 36.765625 34.90625 28.71875 34.90625 
L 20.21875 34.90625 
L 20.21875 43.015625 
L 29.109375 43.015625 
Q 36.375 43.015625 40.234375 45.921875 
Q 44.09375 48.828125 44.09375 54.296875 
Q 44.09375 59.90625 40.109375 62.90625 
Q 36.140625 65.921875 28.71875 65.921875 
Q 24.65625 65.921875 20.015625 65.03125 
Q 15.375 64.15625 9.8125 62.3125 
L 9.8125 71.09375 
Q 15.4375 72.65625 20.34375 73.4375 
Q 25.25 74.21875 29.59375 74.21875 
Q 40.828125 74.21875 47.359375 69.109375 
Q 53.90625 64.015625 53.90625 55.328125 
Q 53.90625 49.265625 50.4375 45.09375 
Q 46.96875 40.921875 40.578125 39.3125 
z
" id="DejaVuSans-51"></path>
       </defs>
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-51"></use>
      </g>
     </g>
    </g>
    <g id="xtick_2">
     <g id="line2d_2">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="94.887642" xlink:href="#md936b47549" y="224.64"></use>
      </g>
     </g>
     <g id="text_2">
      <!-- −2 -->
      <g transform="translate(87.516548 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"></path>
       </defs>
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-50"></use>
      </g>
     </g>
    </g>
    <g id="xtick_3">
     <g id="line2d_3">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="145.614915" xlink:href="#md936b47549" y="224.64"></use>
      </g>
     </g>
     <g id="text_3">
      <!-- −1 -->
      <g transform="translate(138.243821 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"></path>
       </defs>
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-49"></use>
      </g>
     </g>
    </g>
    <g id="xtick_4">
     <g id="line2d_4">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="196.342188" xlink:href="#md936b47549" y="224.64"></use>
      </g>
     </g>
     <g id="text_4">
      <!-- 0 -->
      <g transform="translate(193.160938 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path>
       </defs>
       <use xlink:href="#DejaVuSans-48"></use>
      </g>
     </g>
    </g>
    <g id="xtick_5">
     <g id="line2d_5">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="247.06946" xlink:href="#md936b47549" y="224.64"></use>
      </g>
     </g>
     <g id="text_5">
      <!-- 1 -->
      <g transform="translate(243.88821 239.238437)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-49"></use>
      </g>
     </g>
    </g>
    <g id="xtick_6">
     <g id="line2d_6">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="297.796733" xlink:href="#md936b47549" y="224.64"></use>
      </g>
     </g>
     <g id="text_6">
      <!-- 2 -->
      <g transform="translate(294.615483 239.238437)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-50"></use>
      </g>
     </g>
    </g>
    <g id="xtick_7">
     <g id="line2d_7">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="348.524006" xlink:href="#md936b47549" y="224.64"></use>
      </g>
     </g>
     <g id="text_7">
      <!-- 3 -->
      <g transform="translate(345.342756 239.238437)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-51"></use>
      </g>
     </g>
    </g>
   </g>
   <g id="matplotlib.axis_2">
    <g id="ytick_1">
     <g id="line2d_8">
      <defs>
       <path d="M 0 0 
L -3.5 0 
" id="m30eb0a0804" style="stroke:#000000;stroke-width:0.8;"></path>
      </defs>
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#m30eb0a0804" y="221.657926"></use>
      </g>
     </g>
     <g id="text_8">
      <!-- −3 -->
      <g transform="translate(7.2 225.457145)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-51"></use>
      </g>
     </g>
    </g>
    <g id="ytick_2">
     <g id="line2d_9">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#m30eb0a0804" y="190.227528"></use>
      </g>
     </g>
     <g id="text_9">
      <!-- −2 -->
      <g transform="translate(7.2 194.026746)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-50"></use>
      </g>
     </g>
    </g>
    <g id="ytick_3">
     <g id="line2d_10">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#m30eb0a0804" y="158.797129"></use>
      </g>
     </g>
     <g id="text_10">
      <!-- −1 -->
      <g transform="translate(7.2 162.596348)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-49"></use>
      </g>
     </g>
    </g>
    <g id="ytick_4">
     <g id="line2d_11">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#m30eb0a0804" y="127.36673"></use>
      </g>
     </g>
     <g id="text_11">
      <!-- 0 -->
      <g transform="translate(15.579688 131.165949)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-48"></use>
      </g>
     </g>
    </g>
    <g id="ytick_5">
     <g id="line2d_12">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#m30eb0a0804" y="95.936332"></use>
      </g>
     </g>
     <g id="text_12">
      <!-- 1 -->
      <g transform="translate(15.579688 99.73555)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-49"></use>
      </g>
     </g>
    </g>
    <g id="ytick_6">
     <g id="line2d_13">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#m30eb0a0804" y="64.505933"></use>
      </g>
     </g>
     <g id="text_13">
      <!-- 2 -->
      <g transform="translate(15.579688 68.305152)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-50"></use>
      </g>
     </g>
    </g>
    <g id="ytick_7">
     <g id="line2d_14">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#m30eb0a0804" y="33.075534"></use>
      </g>
     </g>
     <g id="text_14">
      <!-- 3 -->
      <g transform="translate(15.579688 36.874753)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-51"></use>
      </g>
     </g>
    </g>
   </g>
   <g id="line2d_15">
    <defs>
     <path d="M 0 3 
C 0.795609 3 1.55874 2.683901 2.12132 2.12132 
C 2.683901 1.55874 3 0.795609 3 0 
C 3 -0.795609 2.683901 -1.55874 2.12132 -2.12132 
C 1.55874 -2.683901 0.795609 -3 0 -3 
C -0.795609 -3 -1.55874 -2.683901 -2.12132 -2.12132 
C -2.683901 -1.55874 -3 -0.795609 -3 0 
C -3 0.795609 -2.683901 1.55874 -2.12132 2.12132 
C -1.55874 2.683901 -0.795609 3 0 3 
z
" id="m3fdb13f165" style="stroke:#1f77b4;"></path>
    </defs>
    <g clip-path="url(#pd2d34f9177)">
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="90.276072" xlink:href="#m3fdb13f165" y="214.756364"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="167.135576" xlink:href="#m3fdb13f165" y="165.001556"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="339.300865" xlink:href="#m3fdb13f165" y="52.591413"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="71.829791" xlink:href="#m3fdb13f165" y="170.210714"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="265.515741" xlink:href="#m3fdb13f165" y="107.498138"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="77.978551" xlink:href="#m3fdb13f165" y="173.089811"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="188.656237" xlink:href="#m3fdb13f165" y="133.686794"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="305.482683" xlink:href="#m3fdb13f165" y="26.570427"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="130.243014" xlink:href="#m3fdb13f165" y="122.114863"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="330.077725" xlink:href="#m3fdb13f165" y="55.163378"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="59.53227" xlink:href="#m3fdb13f165" y="176.475674"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="247.06946" xlink:href="#m3fdb13f165" y="115.293631"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="243.99508" xlink:href="#m3fdb13f165" y="98.943316"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="151.763675" xlink:href="#m3fdb13f165" y="118.109201"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="93.350452" xlink:href="#m3fdb13f165" y="211.932314"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="194.804997" xlink:href="#m3fdb13f165" y="126.309541"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="148.689295" xlink:href="#m3fdb13f165" y="108.382791"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="65.68103" xlink:href="#m3fdb13f165" y="156.909961"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="336.226485" xlink:href="#m3fdb13f165" y="56.586279"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="127.168634" xlink:href="#m3fdb13f165" y="130.899167"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="102.573592" xlink:href="#m3fdb13f165" y="204.474596"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="293.185163" xlink:href="#m3fdb13f165" y="17.083636"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="121.019873" xlink:href="#m3fdb13f165" y="138.763817"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="234.77194" xlink:href="#m3fdb13f165" y="74.017611"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="84.127311" xlink:href="#m3fdb13f165" y="207.347716"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="117.945493" xlink:href="#m3fdb13f165" y="158.425966"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="53.38351" xlink:href="#m3fdb13f165" y="166.896271"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="96.424832" xlink:href="#m3fdb13f165" y="204.202516"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="160.986816" xlink:href="#m3fdb13f165" y="138.654041"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="68.755411" xlink:href="#m3fdb13f165" y="168.860907"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="283.962022" xlink:href="#m3fdb13f165" y="43.398223"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="62.60665" xlink:href="#m3fdb13f165" y="180.103325"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="240.9207" xlink:href="#m3fdb13f165" y="102.386125"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="154.838055" xlink:href="#m3fdb13f165" y="139.398568"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="317.780204" xlink:href="#m3fdb13f165" y="42.009699"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="216.325659" xlink:href="#m3fdb13f165" y="80.773692"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="348.524006" xlink:href="#m3fdb13f165" y="46.549165"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="210.176898" xlink:href="#m3fdb13f165" y="72.122328"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="176.358716" xlink:href="#m3fdb13f165" y="142.598112"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="197.879378" xlink:href="#m3fdb13f165" y="92.13944"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="250.14384" xlink:href="#m3fdb13f165" y="96.840937"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="185.581857" xlink:href="#m3fdb13f165" y="147.818167"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="253.218221" xlink:href="#m3fdb13f165" y="120.403684"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="231.697559" xlink:href="#m3fdb13f165" y="86.045095"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="342.375245" xlink:href="#m3fdb13f165" y="50.729998"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="287.036402" xlink:href="#m3fdb13f165" y="43.541896"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="170.209956" xlink:href="#m3fdb13f165" y="155.729428"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="222.474419" xlink:href="#m3fdb13f165" y="82.018914"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="191.730617" xlink:href="#m3fdb13f165" y="124.219729"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="345.449626" xlink:href="#m3fdb13f165" y="56.919975"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="219.400039" xlink:href="#m3fdb13f165" y="76.446836"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="274.738882" xlink:href="#m3fdb13f165" y="59.060048"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="142.540535" xlink:href="#m3fdb13f165" y="130.634556"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="333.152105" xlink:href="#m3fdb13f165" y="49.123011"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="225.548799" xlink:href="#m3fdb13f165" y="75.670932"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="237.84632" xlink:href="#m3fdb13f165" y="94.547861"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="302.408303" xlink:href="#m3fdb13f165" y="24.438322"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="157.912435" xlink:href="#m3fdb13f165" y="151.598426"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="133.317394" xlink:href="#m3fdb13f165" y="134.561001"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="47.234749" xlink:href="#m3fdb13f165" y="167.133223"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="204.028138" xlink:href="#m3fdb13f165" y="75.171895"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="108.722353" xlink:href="#m3fdb13f165" y="195.684169"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="50.30913" xlink:href="#m3fdb13f165" y="167.558817"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="114.871113" xlink:href="#m3fdb13f165" y="170.74975"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="311.631444" xlink:href="#m3fdb13f165" y="25.595557"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="323.928964" xlink:href="#m3fdb13f165" y="44.561701"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="271.664502" xlink:href="#m3fdb13f165" y="69.074442"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="308.557064" xlink:href="#m3fdb13f165" y="17.780029"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="296.259543" xlink:href="#m3fdb13f165" y="23.637384"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="105.647973" xlink:href="#m3fdb13f165" y="188.318973"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="228.623179" xlink:href="#m3fdb13f165" y="77.502659"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="262.441361" xlink:href="#m3fdb13f165" y="107.753059"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="87.201692" xlink:href="#m3fdb13f165" y="212.227561"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="327.003345" xlink:href="#m3fdb13f165" y="46.68746"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="200.953758" xlink:href="#m3fdb13f165" y="88.967676"></use>
    </g>
   </g>
   <g id="line2d_16">
    <defs>
     <path d="M 0 3 
C 0.795609 3 1.55874 2.683901 2.12132 2.12132 
C 2.683901 1.55874 3 0.795609 3 0 
C 3 -0.795609 2.683901 -1.55874 2.12132 -2.12132 
C 1.55874 -2.683901 0.795609 -3 0 -3 
C -0.795609 -3 -1.55874 -2.683901 -2.12132 -2.12132 
C -2.683901 -1.55874 -3 -0.795609 -3 0 
C -3 0.795609 -2.683901 1.55874 -2.12132 2.12132 
C -1.55874 2.683901 -0.795609 3 0 3 
z
" id="m4aade830f7" style="stroke:#ff7f0e;"></path>
    </defs>
    <g clip-path="url(#pd2d34f9177)">
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="90.276072" xlink:href="#m4aade830f7" y="172.558461"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="167.135576" xlink:href="#m4aade830f7" y="129.598006"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="339.300865" xlink:href="#m4aade830f7" y="33.366586"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="71.829791" xlink:href="#m4aade830f7" y="182.868971"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="265.515741" xlink:href="#m4aade830f7" y="74.608623"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="77.978551" xlink:href="#m4aade830f7" y="179.432134"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="188.656237" xlink:href="#m4aade830f7" y="117.569079"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="305.482683" xlink:href="#m4aade830f7" y="52.269187"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="130.243014" xlink:href="#m4aade830f7" y="150.219025"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="330.077725" xlink:href="#m4aade830f7" y="38.521841"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="59.53227" xlink:href="#m4aade830f7" y="189.742643"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="247.06946" xlink:href="#m4aade830f7" y="84.919133"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="243.99508" xlink:href="#m4aade830f7" y="86.637551"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="151.763675" xlink:href="#m4aade830f7" y="138.190097"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="93.350452" xlink:href="#m4aade830f7" y="170.840043"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="194.804997" xlink:href="#m4aade830f7" y="114.132242"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="148.689295" xlink:href="#m4aade830f7" y="139.908515"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="65.68103" xlink:href="#m4aade830f7" y="186.305807"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="336.226485" xlink:href="#m4aade830f7" y="35.085005"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="127.168634" xlink:href="#m4aade830f7" y="151.937443"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="102.573592" xlink:href="#m4aade830f7" y="165.684789"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="293.185163" xlink:href="#m4aade830f7" y="59.14286"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="121.019873" xlink:href="#m4aade830f7" y="155.374279"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="234.77194" xlink:href="#m4aade830f7" y="91.792806"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="84.127311" xlink:href="#m4aade830f7" y="175.995298"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="117.945493" xlink:href="#m4aade830f7" y="157.092698"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="53.38351" xlink:href="#m4aade830f7" y="193.17948"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="96.424832" xlink:href="#m4aade830f7" y="169.121625"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="160.986816" xlink:href="#m4aade830f7" y="133.034843"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="68.755411" xlink:href="#m4aade830f7" y="184.587389"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="283.962022" xlink:href="#m4aade830f7" y="64.298114"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="62.60665" xlink:href="#m4aade830f7" y="188.024225"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="240.9207" xlink:href="#m4aade830f7" y="88.355969"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="154.838055" xlink:href="#m4aade830f7" y="136.471679"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="317.780204" xlink:href="#m4aade830f7" y="45.395514"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="216.325659" xlink:href="#m4aade830f7" y="102.103315"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="348.524006" xlink:href="#m4aade830f7" y="28.211332"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="210.176898" xlink:href="#m4aade830f7" y="105.540151"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="176.358716" xlink:href="#m4aade830f7" y="124.442752"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="197.879378" xlink:href="#m4aade830f7" y="112.413824"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="250.14384" xlink:href="#m4aade830f7" y="83.200715"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="185.581857" xlink:href="#m4aade830f7" y="119.287497"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="253.218221" xlink:href="#m4aade830f7" y="81.482296"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="231.697559" xlink:href="#m4aade830f7" y="93.511224"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="342.375245" xlink:href="#m4aade830f7" y="31.648168"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="287.036402" xlink:href="#m4aade830f7" y="62.579696"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="170.209956" xlink:href="#m4aade830f7" y="127.879588"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="222.474419" xlink:href="#m4aade830f7" y="98.666478"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="191.730617" xlink:href="#m4aade830f7" y="115.850661"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="345.449626" xlink:href="#m4aade830f7" y="29.92975"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="219.400039" xlink:href="#m4aade830f7" y="100.384897"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="274.738882" xlink:href="#m4aade830f7" y="69.453369"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="142.540535" xlink:href="#m4aade830f7" y="143.345352"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="333.152105" xlink:href="#m4aade830f7" y="36.803423"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="225.548799" xlink:href="#m4aade830f7" y="96.94806"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="237.84632" xlink:href="#m4aade830f7" y="90.074387"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="302.408303" xlink:href="#m4aade830f7" y="53.987605"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="157.912435" xlink:href="#m4aade830f7" y="134.753261"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="133.317394" xlink:href="#m4aade830f7" y="148.500606"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="47.234749" xlink:href="#m4aade830f7" y="196.616316"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="204.028138" xlink:href="#m4aade830f7" y="108.976988"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="108.722353" xlink:href="#m4aade830f7" y="162.247952"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="50.30913" xlink:href="#m4aade830f7" y="194.897898"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="114.871113" xlink:href="#m4aade830f7" y="158.811116"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="311.631444" xlink:href="#m4aade830f7" y="48.83235"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="323.928964" xlink:href="#m4aade830f7" y="41.958678"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="271.664502" xlink:href="#m4aade830f7" y="71.171787"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="308.557064" xlink:href="#m4aade830f7" y="50.550769"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="296.259543" xlink:href="#m4aade830f7" y="57.424441"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="105.647973" xlink:href="#m4aade830f7" y="163.96637"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="228.623179" xlink:href="#m4aade830f7" y="95.229642"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="262.441361" xlink:href="#m4aade830f7" y="76.327042"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="87.201692" xlink:href="#m4aade830f7" y="174.27688"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="327.003345" xlink:href="#m4aade830f7" y="40.240259"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="200.953758" xlink:href="#m4aade830f7" y="110.695406"></use>
    </g>
   </g>
   <g id="line2d_17">
    <path clip-path="url(#pd2d34f9177)" d="M 44.160369 198.334735 
L 348.524006 28.211332 
" style="fill:none;stroke:#2ca02c;stroke-linecap:square;stroke-width:1.5;"></path>
   </g>
   <g id="patch_3">
    <path d="M 28.942188 224.64 
L 28.942188 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
   <g id="patch_4">
    <path d="M 363.742188 224.64 
L 363.742188 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
   <g id="patch_5">
    <path d="M 28.942188 224.64 
L 363.742188 224.64 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
   <g id="patch_6">
    <path d="M 28.942188 7.2 
L 363.742188 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
   <g id="legend_1">
    <g id="patch_7">
     <path d="M 35.942188 59.234375 
L 118.109375 59.234375 
Q 120.109375 59.234375 120.109375 57.234375 
L 120.109375 14.2 
Q 120.109375 12.2 118.109375 12.2 
L 35.942188 12.2 
Q 33.942188 12.2 33.942188 14.2 
L 33.942188 57.234375 
Q 33.942188 59.234375 35.942188 59.234375 
z
" style="fill:#ffffff;opacity:0.8;stroke:#cccccc;stroke-linejoin:miter;"></path>
    </g>
    <g id="line2d_18"></g>
    <g id="line2d_19">
     <g>
      <use style="fill:#1f77b4;stroke:#1f77b4;" x="47.942188" xlink:href="#m3fdb13f165" y="20.298437"></use>
     </g>
    </g>
    <g id="text_15">
     <!-- data -->
     <g transform="translate(65.942188 23.798437)scale(0.1 -0.1)">
      <defs>
       <path d="M 45.40625 46.390625 
L 45.40625 75.984375 
L 54.390625 75.984375 
L 54.390625 0 
L 45.40625 0 
L 45.40625 8.203125 
Q 42.578125 3.328125 38.25 0.953125 
Q 33.9375 -1.421875 27.875 -1.421875 
Q 17.96875 -1.421875 11.734375 6.484375 
Q 5.515625 14.40625 5.515625 27.296875 
Q 5.515625 40.1875 11.734375 48.09375 
Q 17.96875 56 27.875 56 
Q 33.9375 56 38.25 53.625 
Q 42.578125 51.265625 45.40625 46.390625 
z
M 14.796875 27.296875 
Q 14.796875 17.390625 18.875 11.75 
Q 22.953125 6.109375 30.078125 6.109375 
Q 37.203125 6.109375 41.296875 11.75 
Q 45.40625 17.390625 45.40625 27.296875 
Q 45.40625 37.203125 41.296875 42.84375 
Q 37.203125 48.484375 30.078125 48.484375 
Q 22.953125 48.484375 18.875 42.84375 
Q 14.796875 37.203125 14.796875 27.296875 
z
" id="DejaVuSans-100"></path>
       <path d="M 34.28125 27.484375 
Q 23.390625 27.484375 19.1875 25 
Q 14.984375 22.515625 14.984375 16.5 
Q 14.984375 11.71875 18.140625 8.90625 
Q 21.296875 6.109375 26.703125 6.109375 
Q 34.1875 6.109375 38.703125 11.40625 
Q 43.21875 16.703125 43.21875 25.484375 
L 43.21875 27.484375 
z
M 52.203125 31.203125 
L 52.203125 0 
L 43.21875 0 
L 43.21875 8.296875 
Q 40.140625 3.328125 35.546875 0.953125 
Q 30.953125 -1.421875 24.3125 -1.421875 
Q 15.921875 -1.421875 10.953125 3.296875 
Q 6 8.015625 6 15.921875 
Q 6 25.140625 12.171875 29.828125 
Q 18.359375 34.515625 30.609375 34.515625 
L 43.21875 34.515625 
L 43.21875 35.40625 
Q 43.21875 41.609375 39.140625 45 
Q 35.0625 48.390625 27.6875 48.390625 
Q 23 48.390625 18.546875 47.265625 
Q 14.109375 46.140625 10.015625 43.890625 
L 10.015625 52.203125 
Q 14.9375 54.109375 19.578125 55.046875 
Q 24.21875 56 28.609375 56 
Q 40.484375 56 46.34375 49.84375 
Q 52.203125 43.703125 52.203125 31.203125 
z
" id="DejaVuSans-97"></path>
       <path d="M 18.3125 70.21875 
L 18.3125 54.6875 
L 36.8125 54.6875 
L 36.8125 47.703125 
L 18.3125 47.703125 
L 18.3125 18.015625 
Q 18.3125 11.328125 20.140625 9.421875 
Q 21.96875 7.515625 27.59375 7.515625 
L 36.8125 7.515625 
L 36.8125 0 
L 27.59375 0 
Q 17.1875 0 13.234375 3.875 
Q 9.28125 7.765625 9.28125 18.015625 
L 9.28125 47.703125 
L 2.6875 47.703125 
L 2.6875 54.6875 
L 9.28125 54.6875 
L 9.28125 70.21875 
z
" id="DejaVuSans-116"></path>
      </defs>
      <use xlink:href="#DejaVuSans-100"></use>
      <use x="63.476562" xlink:href="#DejaVuSans-97"></use>
      <use x="124.755859" xlink:href="#DejaVuSans-116"></use>
      <use x="163.964844" xlink:href="#DejaVuSans-97"></use>
     </g>
    </g>
    <g id="line2d_20"></g>
    <g id="line2d_21">
     <g>
      <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="47.942188" xlink:href="#m4aade830f7" y="34.976562"></use>
     </g>
    </g>
    <g id="text_16">
     <!-- prediction -->
     <g transform="translate(65.942188 38.476562)scale(0.1 -0.1)">
      <defs>
       <path d="M 18.109375 8.203125 
L 18.109375 -20.796875 
L 9.078125 -20.796875 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.390625 
Q 20.953125 51.265625 25.265625 53.625 
Q 29.59375 56 35.59375 56 
Q 45.5625 56 51.78125 48.09375 
Q 58.015625 40.1875 58.015625 27.296875 
Q 58.015625 14.40625 51.78125 6.484375 
Q 45.5625 -1.421875 35.59375 -1.421875 
Q 29.59375 -1.421875 25.265625 0.953125 
Q 20.953125 3.328125 18.109375 8.203125 
z
M 48.6875 27.296875 
Q 48.6875 37.203125 44.609375 42.84375 
Q 40.53125 48.484375 33.40625 48.484375 
Q 26.265625 48.484375 22.1875 42.84375 
Q 18.109375 37.203125 18.109375 27.296875 
Q 18.109375 17.390625 22.1875 11.75 
Q 26.265625 6.109375 33.40625 6.109375 
Q 40.53125 6.109375 44.609375 11.75 
Q 48.6875 17.390625 48.6875 27.296875 
z
" id="DejaVuSans-112"></path>
       <path d="M 41.109375 46.296875 
Q 39.59375 47.171875 37.8125 47.578125 
Q 36.03125 48 33.890625 48 
Q 26.265625 48 22.1875 43.046875 
Q 18.109375 38.09375 18.109375 28.8125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 20.953125 51.171875 25.484375 53.578125 
Q 30.03125 56 36.53125 56 
Q 37.453125 56 38.578125 55.875 
Q 39.703125 55.765625 41.0625 55.515625 
z
" id="DejaVuSans-114"></path>
       <path d="M 56.203125 29.59375 
L 56.203125 25.203125 
L 14.890625 25.203125 
Q 15.484375 15.921875 20.484375 11.0625 
Q 25.484375 6.203125 34.421875 6.203125 
Q 39.59375 6.203125 44.453125 7.46875 
Q 49.3125 8.734375 54.109375 11.28125 
L 54.109375 2.78125 
Q 49.265625 0.734375 44.1875 -0.34375 
Q 39.109375 -1.421875 33.890625 -1.421875 
Q 20.796875 -1.421875 13.15625 6.1875 
Q 5.515625 13.8125 5.515625 26.8125 
Q 5.515625 40.234375 12.765625 48.109375 
Q 20.015625 56 32.328125 56 
Q 43.359375 56 49.78125 48.890625 
Q 56.203125 41.796875 56.203125 29.59375 
z
M 47.21875 32.234375 
Q 47.125 39.59375 43.09375 43.984375 
Q 39.0625 48.390625 32.421875 48.390625 
Q 24.90625 48.390625 20.390625 44.140625 
Q 15.875 39.890625 15.1875 32.171875 
z
" id="DejaVuSans-101"></path>
       <path d="M 9.421875 54.6875 
L 18.40625 54.6875 
L 18.40625 0 
L 9.421875 0 
z
M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 64.59375 
L 9.421875 64.59375 
z
" id="DejaVuSans-105"></path>
       <path d="M 48.78125 52.59375 
L 48.78125 44.1875 
Q 44.96875 46.296875 41.140625 47.34375 
Q 37.3125 48.390625 33.40625 48.390625 
Q 24.65625 48.390625 19.8125 42.84375 
Q 14.984375 37.3125 14.984375 27.296875 
Q 14.984375 17.28125 19.8125 11.734375 
Q 24.65625 6.203125 33.40625 6.203125 
Q 37.3125 6.203125 41.140625 7.25 
Q 44.96875 8.296875 48.78125 10.40625 
L 48.78125 2.09375 
Q 45.015625 0.34375 40.984375 -0.53125 
Q 36.96875 -1.421875 32.421875 -1.421875 
Q 20.0625 -1.421875 12.78125 6.34375 
Q 5.515625 14.109375 5.515625 27.296875 
Q 5.515625 40.671875 12.859375 48.328125 
Q 20.21875 56 33.015625 56 
Q 37.15625 56 41.109375 55.140625 
Q 45.0625 54.296875 48.78125 52.59375 
z
" id="DejaVuSans-99"></path>
       <path d="M 30.609375 48.390625 
Q 23.390625 48.390625 19.1875 42.75 
Q 14.984375 37.109375 14.984375 27.296875 
Q 14.984375 17.484375 19.15625 11.84375 
Q 23.34375 6.203125 30.609375 6.203125 
Q 37.796875 6.203125 41.984375 11.859375 
Q 46.1875 17.53125 46.1875 27.296875 
Q 46.1875 37.015625 41.984375 42.703125 
Q 37.796875 48.390625 30.609375 48.390625 
z
M 30.609375 56 
Q 42.328125 56 49.015625 48.375 
Q 55.71875 40.765625 55.71875 27.296875 
Q 55.71875 13.875 49.015625 6.21875 
Q 42.328125 -1.421875 30.609375 -1.421875 
Q 18.84375 -1.421875 12.171875 6.21875 
Q 5.515625 13.875 5.515625 27.296875 
Q 5.515625 40.765625 12.171875 48.375 
Q 18.84375 56 30.609375 56 
z
" id="DejaVuSans-111"></path>
       <path d="M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
" id="DejaVuSans-110"></path>
      </defs>
      <use xlink:href="#DejaVuSans-112"></use>
      <use x="63.476562" xlink:href="#DejaVuSans-114"></use>
      <use x="102.339844" xlink:href="#DejaVuSans-101"></use>
      <use x="163.863281" xlink:href="#DejaVuSans-100"></use>
      <use x="227.339844" xlink:href="#DejaVuSans-105"></use>
      <use x="255.123047" xlink:href="#DejaVuSans-99"></use>
      <use x="310.103516" xlink:href="#DejaVuSans-116"></use>
      <use x="349.3125" xlink:href="#DejaVuSans-105"></use>
      <use x="377.095703" xlink:href="#DejaVuSans-111"></use>
      <use x="438.277344" xlink:href="#DejaVuSans-110"></use>
     </g>
    </g>
    <g id="line2d_22">
     <path d="M 37.942188 49.654687 
L 57.942188 49.654687 
" style="fill:none;stroke:#2ca02c;stroke-linecap:square;stroke-width:1.5;"></path>
    </g>
    <g id="line2d_23"></g>
    <g id="text_17">
     <!-- fit -->
     <g transform="translate(65.942188 53.154687)scale(0.1 -0.1)">
      <defs>
       <path d="M 37.109375 75.984375 
L 37.109375 68.5 
L 28.515625 68.5 
Q 23.6875 68.5 21.796875 66.546875 
Q 19.921875 64.59375 19.921875 59.515625 
L 19.921875 54.6875 
L 34.71875 54.6875 
L 34.71875 47.703125 
L 19.921875 47.703125 
L 19.921875 0 
L 10.890625 0 
L 10.890625 47.703125 
L 2.296875 47.703125 
L 2.296875 54.6875 
L 10.890625 54.6875 
L 10.890625 58.5 
Q 10.890625 67.625 15.140625 71.796875 
Q 19.390625 75.984375 28.609375 75.984375 
z
" id="DejaVuSans-102"></path>
      </defs>
      <use xlink:href="#DejaVuSans-102"></use>
      <use x="35.205078" xlink:href="#DejaVuSans-105"></use>
      <use x="62.988281" xlink:href="#DejaVuSans-116"></use>
     </g>
    </g>
   </g>
  </g>
 </g>
 <defs>
  <clippath id="pd2d34f9177">
   <rect height="217.44" width="334.8" x="28.942188" y="7.2"></rect>
  </clippath>
 </defs>
</svg>

</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we can see in the plot above, the line is able to capture the general slope of the data, but not many details.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, let's try the test set:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_pred_test</span> <span class="o">=</span> <span class="n">regressor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_pred_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(25, 1)
(25,)
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="s1">'o'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"data"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">,</span> <span class="s1">'o'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"prediction"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">X</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">X</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span> <span class="p">[</span><span class="n">min_pt</span><span class="p">,</span> <span class="n">max_pt</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">'fit'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?>
&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
  "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;
<!-- Created with matplotlib (https://matplotlib.org/) -->
<svg height="248.518125pt" version="1.1" viewbox="0 0 370.942187 248.518125" width="370.942187pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
 <metadata>
  <rdf xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
   <work>
    <type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></type>
    <date>2020-10-14T19:50:34.079480</date>
    <format>image/svg+xml</format>
    <creator>
     <agent>
      <title>Matplotlib v3.3.1, https://matplotlib.org/</title>
     </agent>
    </creator>
   </work>
  </rdf>
 </metadata>
 <defs>
  <style type="text/css">*{stroke-linecap:butt;stroke-linejoin:round;}</style>
 </defs>
 <g id="figure_1">
  <g id="patch_1">
   <path d="M 0 248.518125 
L 370.942187 248.518125 
L 370.942187 0 
L 0 0 
z
" style="fill:none;"></path>
  </g>
  <g id="axes_1">
   <g id="patch_2">
    <path d="M 28.942188 224.64 
L 363.742188 224.64 
L 363.742188 7.2 
L 28.942188 7.2 
z
" style="fill:#ffffff;"></path>
   </g>
   <g id="matplotlib.axis_1">
    <g id="xtick_1">
     <g id="line2d_1">
      <defs>
       <path d="M 0 0 
L 0 3.5 
" id="md4e0a1e350" style="stroke:#000000;stroke-width:0.8;"></path>
      </defs>
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="44.160369" xlink:href="#md4e0a1e350" y="224.64"></use>
      </g>
     </g>
     <g id="text_1">
      <!-- −3 -->
      <g transform="translate(36.789276 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 10.59375 35.5 
L 73.1875 35.5 
L 73.1875 27.203125 
L 10.59375 27.203125 
z
" id="DejaVuSans-8722"></path>
        <path d="M 40.578125 39.3125 
Q 47.65625 37.796875 51.625 33 
Q 55.609375 28.21875 55.609375 21.1875 
Q 55.609375 10.40625 48.1875 4.484375 
Q 40.765625 -1.421875 27.09375 -1.421875 
Q 22.515625 -1.421875 17.65625 -0.515625 
Q 12.796875 0.390625 7.625 2.203125 
L 7.625 11.71875 
Q 11.71875 9.328125 16.59375 8.109375 
Q 21.484375 6.890625 26.8125 6.890625 
Q 36.078125 6.890625 40.9375 10.546875 
Q 45.796875 14.203125 45.796875 21.1875 
Q 45.796875 27.640625 41.28125 31.265625 
Q 36.765625 34.90625 28.71875 34.90625 
L 20.21875 34.90625 
L 20.21875 43.015625 
L 29.109375 43.015625 
Q 36.375 43.015625 40.234375 45.921875 
Q 44.09375 48.828125 44.09375 54.296875 
Q 44.09375 59.90625 40.109375 62.90625 
Q 36.140625 65.921875 28.71875 65.921875 
Q 24.65625 65.921875 20.015625 65.03125 
Q 15.375 64.15625 9.8125 62.3125 
L 9.8125 71.09375 
Q 15.4375 72.65625 20.34375 73.4375 
Q 25.25 74.21875 29.59375 74.21875 
Q 40.828125 74.21875 47.359375 69.109375 
Q 53.90625 64.015625 53.90625 55.328125 
Q 53.90625 49.265625 50.4375 45.09375 
Q 46.96875 40.921875 40.578125 39.3125 
z
" id="DejaVuSans-51"></path>
       </defs>
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-51"></use>
      </g>
     </g>
    </g>
    <g id="xtick_2">
     <g id="line2d_2">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="94.887642" xlink:href="#md4e0a1e350" y="224.64"></use>
      </g>
     </g>
     <g id="text_2">
      <!-- −2 -->
      <g transform="translate(87.516548 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"></path>
       </defs>
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-50"></use>
      </g>
     </g>
    </g>
    <g id="xtick_3">
     <g id="line2d_3">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="145.614915" xlink:href="#md4e0a1e350" y="224.64"></use>
      </g>
     </g>
     <g id="text_3">
      <!-- −1 -->
      <g transform="translate(138.243821 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"></path>
       </defs>
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-49"></use>
      </g>
     </g>
    </g>
    <g id="xtick_4">
     <g id="line2d_4">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="196.342188" xlink:href="#md4e0a1e350" y="224.64"></use>
      </g>
     </g>
     <g id="text_4">
      <!-- 0 -->
      <g transform="translate(193.160938 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path>
       </defs>
       <use xlink:href="#DejaVuSans-48"></use>
      </g>
     </g>
    </g>
    <g id="xtick_5">
     <g id="line2d_5">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="247.06946" xlink:href="#md4e0a1e350" y="224.64"></use>
      </g>
     </g>
     <g id="text_5">
      <!-- 1 -->
      <g transform="translate(243.88821 239.238437)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-49"></use>
      </g>
     </g>
    </g>
    <g id="xtick_6">
     <g id="line2d_6">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="297.796733" xlink:href="#md4e0a1e350" y="224.64"></use>
      </g>
     </g>
     <g id="text_6">
      <!-- 2 -->
      <g transform="translate(294.615483 239.238437)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-50"></use>
      </g>
     </g>
    </g>
    <g id="xtick_7">
     <g id="line2d_7">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="348.524006" xlink:href="#md4e0a1e350" y="224.64"></use>
      </g>
     </g>
     <g id="text_7">
      <!-- 3 -->
      <g transform="translate(345.342756 239.238437)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-51"></use>
      </g>
     </g>
    </g>
   </g>
   <g id="matplotlib.axis_2">
    <g id="ytick_1">
     <g id="line2d_8">
      <defs>
       <path d="M 0 0 
L -3.5 0 
" id="m04f4ab38e4" style="stroke:#000000;stroke-width:0.8;"></path>
      </defs>
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#m04f4ab38e4" y="199.964445"></use>
      </g>
     </g>
     <g id="text_8">
      <!-- −2 -->
      <g transform="translate(7.2 203.763663)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-50"></use>
      </g>
     </g>
    </g>
    <g id="ytick_2">
     <g id="line2d_9">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#m04f4ab38e4" y="167.351546"></use>
      </g>
     </g>
     <g id="text_9">
      <!-- −1 -->
      <g transform="translate(7.2 171.150765)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-49"></use>
      </g>
     </g>
    </g>
    <g id="ytick_3">
     <g id="line2d_10">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#m04f4ab38e4" y="134.738647"></use>
      </g>
     </g>
     <g id="text_10">
      <!-- 0 -->
      <g transform="translate(15.579688 138.537866)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-48"></use>
      </g>
     </g>
    </g>
    <g id="ytick_4">
     <g id="line2d_11">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#m04f4ab38e4" y="102.125749"></use>
      </g>
     </g>
     <g id="text_11">
      <!-- 1 -->
      <g transform="translate(15.579688 105.924968)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-49"></use>
      </g>
     </g>
    </g>
    <g id="ytick_5">
     <g id="line2d_12">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#m04f4ab38e4" y="69.51285"></use>
      </g>
     </g>
     <g id="text_12">
      <!-- 2 -->
      <g transform="translate(15.579688 73.312069)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-50"></use>
      </g>
     </g>
    </g>
    <g id="ytick_6">
     <g id="line2d_13">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#m04f4ab38e4" y="36.899952"></use>
      </g>
     </g>
     <g id="text_13">
      <!-- 3 -->
      <g transform="translate(15.579688 40.69917)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-51"></use>
      </g>
     </g>
    </g>
   </g>
   <g id="line2d_14">
    <defs>
     <path d="M 0 3 
C 0.795609 3 1.55874 2.683901 2.12132 2.12132 
C 2.683901 1.55874 3 0.795609 3 0 
C 3 -0.795609 2.683901 -1.55874 2.12132 -2.12132 
C 1.55874 -2.683901 0.795609 -3 0 -3 
C -0.795609 -3 -1.55874 -2.683901 -2.12132 -2.12132 
C -2.683901 -1.55874 -3 -0.795609 -3 0 
C -3 0.795609 -2.683901 1.55874 -2.12132 2.12132 
C -1.55874 2.683901 -0.795609 3 0 3 
z
" id="m4aa6bada03" style="stroke:#1f77b4;"></path>
    </defs>
    <g clip-path="url(#p8c974851ff)">
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="299.333923" xlink:href="#m4aa6bada03" y="34.996425"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="207.102518" xlink:href="#m4aa6bada03" y="74.169055"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="259.366981" xlink:href="#m4aa6bada03" y="100.573686"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="182.507477" xlink:href="#m4aa6bada03" y="150.955476"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="179.433097" xlink:href="#m4aa6bada03" y="168.86776"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="164.061196" xlink:href="#m4aa6bada03" y="159.448203"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="111.796733" xlink:href="#m4aa6bada03" y="191.767951"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="290.110783" xlink:href="#m4aa6bada03" y="17.083636"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="74.904171" xlink:href="#m4aa6bada03" y="207.235432"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="44.160369" xlink:href="#m4aa6bada03" y="202.863306"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="99.499212" xlink:href="#m4aa6bada03" y="214.756364"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="136.391774" xlink:href="#m4aa6bada03" y="120.858079"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="268.590121" xlink:href="#m4aa6bada03" y="79.737274"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="145.614915" xlink:href="#m4aa6bada03" y="111.724115"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="320.854584" xlink:href="#m4aa6bada03" y="63.290138"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="56.45789" xlink:href="#m4aa6bada03" y="186.989732"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="277.813262" xlink:href="#m4aa6bada03" y="52.621953"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="280.887642" xlink:href="#m4aa6bada03" y="65.76685"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="81.052931" xlink:href="#m4aa6bada03" y="192.397774"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="139.466154" xlink:href="#m4aa6bada03" y="133.971065"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="213.251278" xlink:href="#m4aa6bada03" y="62.104978"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="314.705824" xlink:href="#m4aa6bada03" y="26.729185"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="124.094254" xlink:href="#m4aa6bada03" y="156.633519"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="173.284336" xlink:href="#m4aa6bada03" y="180.061213"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="256.292601" xlink:href="#m4aa6bada03" y="96.620174"></use>
    </g>
   </g>
   <g id="line2d_15">
    <defs>
     <path d="M 0 3 
C 0.795609 3 1.55874 2.683901 2.12132 2.12132 
C 2.683901 1.55874 3 0.795609 3 0 
C 3 -0.795609 2.683901 -1.55874 2.12132 -2.12132 
C 1.55874 -2.683901 0.795609 -3 0 -3 
C -0.795609 -3 -1.55874 -2.683901 -2.12132 -2.12132 
C -2.683901 -1.55874 -3 -0.795609 -3 0 
C -3 0.795609 -2.683901 1.55874 -2.12132 2.12132 
C -1.55874 2.683901 -0.795609 3 0 3 
z
" id="m265e2181a6" style="stroke:#ff7f0e;"></path>
    </defs>
    <g clip-path="url(#p8c974851ff)">
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="299.333923" xlink:href="#m265e2181a6" y="60.381863"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="207.102518" xlink:href="#m265e2181a6" y="113.873961"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="259.366981" xlink:href="#m265e2181a6" y="83.561772"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="182.507477" xlink:href="#m265e2181a6" y="128.13852"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="179.433097" xlink:href="#m265e2181a6" y="129.92159"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="164.061196" xlink:href="#m265e2181a6" y="138.83694"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="111.796733" xlink:href="#m265e2181a6" y="169.149129"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="290.110783" xlink:href="#m265e2181a6" y="65.731073"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="74.904171" xlink:href="#m265e2181a6" y="190.545968"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="44.160369" xlink:href="#m265e2181a6" y="208.376667"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="99.499212" xlink:href="#m265e2181a6" y="176.281409"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="136.391774" xlink:href="#m265e2181a6" y="154.884569"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="268.590121" xlink:href="#m265e2181a6" y="78.212562"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="145.614915" xlink:href="#m265e2181a6" y="149.53536"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="320.854584" xlink:href="#m265e2181a6" y="47.900373"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="56.45789" xlink:href="#m265e2181a6" y="201.244388"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="277.813262" xlink:href="#m265e2181a6" y="72.863352"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="280.887642" xlink:href="#m265e2181a6" y="71.080283"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="81.052931" xlink:href="#m265e2181a6" y="186.979828"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="139.466154" xlink:href="#m265e2181a6" y="153.101499"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="213.251278" xlink:href="#m265e2181a6" y="110.307821"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="314.705824" xlink:href="#m265e2181a6" y="51.466513"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="124.094254" xlink:href="#m265e2181a6" y="162.016849"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="173.284336" xlink:href="#m265e2181a6" y="133.48773"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="256.292601" xlink:href="#m265e2181a6" y="85.344842"></use>
    </g>
   </g>
   <g id="line2d_16">
    <path clip-path="url(#p8c974851ff)" d="M 44.160369 208.376667 
L 348.524006 31.852744 
" style="fill:none;stroke:#2ca02c;stroke-linecap:square;stroke-width:1.5;"></path>
   </g>
   <g id="patch_3">
    <path d="M 28.942188 224.64 
L 28.942188 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
   <g id="patch_4">
    <path d="M 363.742188 224.64 
L 363.742188 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
   <g id="patch_5">
    <path d="M 28.942188 224.64 
L 363.742188 224.64 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
   <g id="patch_6">
    <path d="M 28.942188 7.2 
L 363.742188 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
   <g id="legend_1">
    <g id="patch_7">
     <path d="M 35.942188 59.234375 
L 118.109375 59.234375 
Q 120.109375 59.234375 120.109375 57.234375 
L 120.109375 14.2 
Q 120.109375 12.2 118.109375 12.2 
L 35.942188 12.2 
Q 33.942188 12.2 33.942188 14.2 
L 33.942188 57.234375 
Q 33.942188 59.234375 35.942188 59.234375 
z
" style="fill:#ffffff;opacity:0.8;stroke:#cccccc;stroke-linejoin:miter;"></path>
    </g>
    <g id="line2d_17"></g>
    <g id="line2d_18">
     <g>
      <use style="fill:#1f77b4;stroke:#1f77b4;" x="47.942188" xlink:href="#m4aa6bada03" y="20.298437"></use>
     </g>
    </g>
    <g id="text_14">
     <!-- data -->
     <g transform="translate(65.942188 23.798437)scale(0.1 -0.1)">
      <defs>
       <path d="M 45.40625 46.390625 
L 45.40625 75.984375 
L 54.390625 75.984375 
L 54.390625 0 
L 45.40625 0 
L 45.40625 8.203125 
Q 42.578125 3.328125 38.25 0.953125 
Q 33.9375 -1.421875 27.875 -1.421875 
Q 17.96875 -1.421875 11.734375 6.484375 
Q 5.515625 14.40625 5.515625 27.296875 
Q 5.515625 40.1875 11.734375 48.09375 
Q 17.96875 56 27.875 56 
Q 33.9375 56 38.25 53.625 
Q 42.578125 51.265625 45.40625 46.390625 
z
M 14.796875 27.296875 
Q 14.796875 17.390625 18.875 11.75 
Q 22.953125 6.109375 30.078125 6.109375 
Q 37.203125 6.109375 41.296875 11.75 
Q 45.40625 17.390625 45.40625 27.296875 
Q 45.40625 37.203125 41.296875 42.84375 
Q 37.203125 48.484375 30.078125 48.484375 
Q 22.953125 48.484375 18.875 42.84375 
Q 14.796875 37.203125 14.796875 27.296875 
z
" id="DejaVuSans-100"></path>
       <path d="M 34.28125 27.484375 
Q 23.390625 27.484375 19.1875 25 
Q 14.984375 22.515625 14.984375 16.5 
Q 14.984375 11.71875 18.140625 8.90625 
Q 21.296875 6.109375 26.703125 6.109375 
Q 34.1875 6.109375 38.703125 11.40625 
Q 43.21875 16.703125 43.21875 25.484375 
L 43.21875 27.484375 
z
M 52.203125 31.203125 
L 52.203125 0 
L 43.21875 0 
L 43.21875 8.296875 
Q 40.140625 3.328125 35.546875 0.953125 
Q 30.953125 -1.421875 24.3125 -1.421875 
Q 15.921875 -1.421875 10.953125 3.296875 
Q 6 8.015625 6 15.921875 
Q 6 25.140625 12.171875 29.828125 
Q 18.359375 34.515625 30.609375 34.515625 
L 43.21875 34.515625 
L 43.21875 35.40625 
Q 43.21875 41.609375 39.140625 45 
Q 35.0625 48.390625 27.6875 48.390625 
Q 23 48.390625 18.546875 47.265625 
Q 14.109375 46.140625 10.015625 43.890625 
L 10.015625 52.203125 
Q 14.9375 54.109375 19.578125 55.046875 
Q 24.21875 56 28.609375 56 
Q 40.484375 56 46.34375 49.84375 
Q 52.203125 43.703125 52.203125 31.203125 
z
" id="DejaVuSans-97"></path>
       <path d="M 18.3125 70.21875 
L 18.3125 54.6875 
L 36.8125 54.6875 
L 36.8125 47.703125 
L 18.3125 47.703125 
L 18.3125 18.015625 
Q 18.3125 11.328125 20.140625 9.421875 
Q 21.96875 7.515625 27.59375 7.515625 
L 36.8125 7.515625 
L 36.8125 0 
L 27.59375 0 
Q 17.1875 0 13.234375 3.875 
Q 9.28125 7.765625 9.28125 18.015625 
L 9.28125 47.703125 
L 2.6875 47.703125 
L 2.6875 54.6875 
L 9.28125 54.6875 
L 9.28125 70.21875 
z
" id="DejaVuSans-116"></path>
      </defs>
      <use xlink:href="#DejaVuSans-100"></use>
      <use x="63.476562" xlink:href="#DejaVuSans-97"></use>
      <use x="124.755859" xlink:href="#DejaVuSans-116"></use>
      <use x="163.964844" xlink:href="#DejaVuSans-97"></use>
     </g>
    </g>
    <g id="line2d_19"></g>
    <g id="line2d_20">
     <g>
      <use style="fill:#ff7f0e;stroke:#ff7f0e;" x="47.942188" xlink:href="#m265e2181a6" y="34.976562"></use>
     </g>
    </g>
    <g id="text_15">
     <!-- prediction -->
     <g transform="translate(65.942188 38.476562)scale(0.1 -0.1)">
      <defs>
       <path d="M 18.109375 8.203125 
L 18.109375 -20.796875 
L 9.078125 -20.796875 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.390625 
Q 20.953125 51.265625 25.265625 53.625 
Q 29.59375 56 35.59375 56 
Q 45.5625 56 51.78125 48.09375 
Q 58.015625 40.1875 58.015625 27.296875 
Q 58.015625 14.40625 51.78125 6.484375 
Q 45.5625 -1.421875 35.59375 -1.421875 
Q 29.59375 -1.421875 25.265625 0.953125 
Q 20.953125 3.328125 18.109375 8.203125 
z
M 48.6875 27.296875 
Q 48.6875 37.203125 44.609375 42.84375 
Q 40.53125 48.484375 33.40625 48.484375 
Q 26.265625 48.484375 22.1875 42.84375 
Q 18.109375 37.203125 18.109375 27.296875 
Q 18.109375 17.390625 22.1875 11.75 
Q 26.265625 6.109375 33.40625 6.109375 
Q 40.53125 6.109375 44.609375 11.75 
Q 48.6875 17.390625 48.6875 27.296875 
z
" id="DejaVuSans-112"></path>
       <path d="M 41.109375 46.296875 
Q 39.59375 47.171875 37.8125 47.578125 
Q 36.03125 48 33.890625 48 
Q 26.265625 48 22.1875 43.046875 
Q 18.109375 38.09375 18.109375 28.8125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 20.953125 51.171875 25.484375 53.578125 
Q 30.03125 56 36.53125 56 
Q 37.453125 56 38.578125 55.875 
Q 39.703125 55.765625 41.0625 55.515625 
z
" id="DejaVuSans-114"></path>
       <path d="M 56.203125 29.59375 
L 56.203125 25.203125 
L 14.890625 25.203125 
Q 15.484375 15.921875 20.484375 11.0625 
Q 25.484375 6.203125 34.421875 6.203125 
Q 39.59375 6.203125 44.453125 7.46875 
Q 49.3125 8.734375 54.109375 11.28125 
L 54.109375 2.78125 
Q 49.265625 0.734375 44.1875 -0.34375 
Q 39.109375 -1.421875 33.890625 -1.421875 
Q 20.796875 -1.421875 13.15625 6.1875 
Q 5.515625 13.8125 5.515625 26.8125 
Q 5.515625 40.234375 12.765625 48.109375 
Q 20.015625 56 32.328125 56 
Q 43.359375 56 49.78125 48.890625 
Q 56.203125 41.796875 56.203125 29.59375 
z
M 47.21875 32.234375 
Q 47.125 39.59375 43.09375 43.984375 
Q 39.0625 48.390625 32.421875 48.390625 
Q 24.90625 48.390625 20.390625 44.140625 
Q 15.875 39.890625 15.1875 32.171875 
z
" id="DejaVuSans-101"></path>
       <path d="M 9.421875 54.6875 
L 18.40625 54.6875 
L 18.40625 0 
L 9.421875 0 
z
M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 64.59375 
L 9.421875 64.59375 
z
" id="DejaVuSans-105"></path>
       <path d="M 48.78125 52.59375 
L 48.78125 44.1875 
Q 44.96875 46.296875 41.140625 47.34375 
Q 37.3125 48.390625 33.40625 48.390625 
Q 24.65625 48.390625 19.8125 42.84375 
Q 14.984375 37.3125 14.984375 27.296875 
Q 14.984375 17.28125 19.8125 11.734375 
Q 24.65625 6.203125 33.40625 6.203125 
Q 37.3125 6.203125 41.140625 7.25 
Q 44.96875 8.296875 48.78125 10.40625 
L 48.78125 2.09375 
Q 45.015625 0.34375 40.984375 -0.53125 
Q 36.96875 -1.421875 32.421875 -1.421875 
Q 20.0625 -1.421875 12.78125 6.34375 
Q 5.515625 14.109375 5.515625 27.296875 
Q 5.515625 40.671875 12.859375 48.328125 
Q 20.21875 56 33.015625 56 
Q 37.15625 56 41.109375 55.140625 
Q 45.0625 54.296875 48.78125 52.59375 
z
" id="DejaVuSans-99"></path>
       <path d="M 30.609375 48.390625 
Q 23.390625 48.390625 19.1875 42.75 
Q 14.984375 37.109375 14.984375 27.296875 
Q 14.984375 17.484375 19.15625 11.84375 
Q 23.34375 6.203125 30.609375 6.203125 
Q 37.796875 6.203125 41.984375 11.859375 
Q 46.1875 17.53125 46.1875 27.296875 
Q 46.1875 37.015625 41.984375 42.703125 
Q 37.796875 48.390625 30.609375 48.390625 
z
M 30.609375 56 
Q 42.328125 56 49.015625 48.375 
Q 55.71875 40.765625 55.71875 27.296875 
Q 55.71875 13.875 49.015625 6.21875 
Q 42.328125 -1.421875 30.609375 -1.421875 
Q 18.84375 -1.421875 12.171875 6.21875 
Q 5.515625 13.875 5.515625 27.296875 
Q 5.515625 40.765625 12.171875 48.375 
Q 18.84375 56 30.609375 56 
z
" id="DejaVuSans-111"></path>
       <path d="M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
" id="DejaVuSans-110"></path>
      </defs>
      <use xlink:href="#DejaVuSans-112"></use>
      <use x="63.476562" xlink:href="#DejaVuSans-114"></use>
      <use x="102.339844" xlink:href="#DejaVuSans-101"></use>
      <use x="163.863281" xlink:href="#DejaVuSans-100"></use>
      <use x="227.339844" xlink:href="#DejaVuSans-105"></use>
      <use x="255.123047" xlink:href="#DejaVuSans-99"></use>
      <use x="310.103516" xlink:href="#DejaVuSans-116"></use>
      <use x="349.3125" xlink:href="#DejaVuSans-105"></use>
      <use x="377.095703" xlink:href="#DejaVuSans-111"></use>
      <use x="438.277344" xlink:href="#DejaVuSans-110"></use>
     </g>
    </g>
    <g id="line2d_21">
     <path d="M 37.942188 49.654687 
L 57.942188 49.654687 
" style="fill:none;stroke:#2ca02c;stroke-linecap:square;stroke-width:1.5;"></path>
    </g>
    <g id="line2d_22"></g>
    <g id="text_16">
     <!-- fit -->
     <g transform="translate(65.942188 53.154687)scale(0.1 -0.1)">
      <defs>
       <path d="M 37.109375 75.984375 
L 37.109375 68.5 
L 28.515625 68.5 
Q 23.6875 68.5 21.796875 66.546875 
Q 19.921875 64.59375 19.921875 59.515625 
L 19.921875 54.6875 
L 34.71875 54.6875 
L 34.71875 47.703125 
L 19.921875 47.703125 
L 19.921875 0 
L 10.890625 0 
L 10.890625 47.703125 
L 2.296875 47.703125 
L 2.296875 54.6875 
L 10.890625 54.6875 
L 10.890625 58.5 
Q 10.890625 67.625 15.140625 71.796875 
Q 19.390625 75.984375 28.609375 75.984375 
z
" id="DejaVuSans-102"></path>
      </defs>
      <use xlink:href="#DejaVuSans-102"></use>
      <use x="35.205078" xlink:href="#DejaVuSans-105"></use>
      <use x="62.988281" xlink:href="#DejaVuSans-116"></use>
     </g>
    </g>
   </g>
  </g>
 </g>
 <defs>
  <clippath id="p8c974851ff">
   <rect height="217.44" width="334.8" x="28.942188" y="7.2"></rect>
  </clippath>
 </defs>
</svg>

</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Again, scikit-learn provides an easy way to evaluate the prediction quantitatively using the <code>score</code> method. For regression tasks, this is the R<sup>2</sup> score. Another popular way would be the Mean Squared Error (MSE). As its name implies, the MSE is simply the average squared difference over the predicted and actual target values</p>
<p>
$$MSE = \frac{1}{n} \sum_{i=1}^{n} (\text{predicted}_i - \text{true}_i)^2$$
</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">regressor</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.7994321405079685</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="alert alert-success">
    <b>EXERCISE</b>:
     <ul>
      <li>
      Add a feature containing  `sin(4x)` to `X` and redo the fit. Visualize the predictions with this new richer, yet linear, model.
      </li>
    </ul>
</div>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># %load solutions/06B_lin_with_sine.py</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="KNeighborsRegression">
<a class="anchor" href="#KNeighborsRegression" aria-hidden="true"><span class="octicon octicon-link"></span></a>KNeighborsRegression<a class="anchor-link" href="#KNeighborsRegression"> </a>
</h1>
<p>As for classification, we can also use a neighbor based method for regression. We can simply take the output of the nearest point, or we could average several nearest points. This method is less popular for regression than for classification, but still a good baseline.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>

<span class="n">kneighbor_regression</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">kneighbor_regression</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>KNeighborsRegressor(n_neighbors=1)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Again, let us look at the behavior on training and test set:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_pred_train</span> <span class="o">=</span> <span class="n">kneighbor_regression</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="s1">'o'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"data"</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_pred_train</span><span class="p">,</span> <span class="s1">'s'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"prediction"</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="utf-8" standalone="no"?>
&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
  "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;
<!-- Created with matplotlib (https://matplotlib.org/) -->
<svg height="248.518125pt" version="1.1" viewbox="0 0 370.942187 248.518125" width="370.942187pt" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
 <metadata>
  <rdf xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
   <work>
    <type rdf:resource="http://purl.org/dc/dcmitype/StillImage"></type>
    <date>2020-10-14T19:50:42.891786</date>
    <format>image/svg+xml</format>
    <creator>
     <agent>
      <title>Matplotlib v3.3.1, https://matplotlib.org/</title>
     </agent>
    </creator>
   </work>
  </rdf>
 </metadata>
 <defs>
  <style type="text/css">*{stroke-linecap:butt;stroke-linejoin:round;}</style>
 </defs>
 <g id="figure_1">
  <g id="patch_1">
   <path d="M 0 248.518125 
L 370.942187 248.518125 
L 370.942187 0 
L 0 0 
z
" style="fill:none;"></path>
  </g>
  <g id="axes_1">
   <g id="patch_2">
    <path d="M 28.942188 224.64 
L 363.742188 224.64 
L 363.742188 7.2 
L 28.942188 7.2 
z
" style="fill:#ffffff;"></path>
   </g>
   <g id="matplotlib.axis_1">
    <g id="xtick_1">
     <g id="line2d_1">
      <defs>
       <path d="M 0 0 
L 0 3.5 
" id="m70b7d5c4ab" style="stroke:#000000;stroke-width:0.8;"></path>
      </defs>
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="41.054618" xlink:href="#m70b7d5c4ab" y="224.64"></use>
      </g>
     </g>
     <g id="text_1">
      <!-- −3 -->
      <g transform="translate(33.683524 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 10.59375 35.5 
L 73.1875 35.5 
L 73.1875 27.203125 
L 10.59375 27.203125 
z
" id="DejaVuSans-8722"></path>
        <path d="M 40.578125 39.3125 
Q 47.65625 37.796875 51.625 33 
Q 55.609375 28.21875 55.609375 21.1875 
Q 55.609375 10.40625 48.1875 4.484375 
Q 40.765625 -1.421875 27.09375 -1.421875 
Q 22.515625 -1.421875 17.65625 -0.515625 
Q 12.796875 0.390625 7.625 2.203125 
L 7.625 11.71875 
Q 11.71875 9.328125 16.59375 8.109375 
Q 21.484375 6.890625 26.8125 6.890625 
Q 36.078125 6.890625 40.9375 10.546875 
Q 45.796875 14.203125 45.796875 21.1875 
Q 45.796875 27.640625 41.28125 31.265625 
Q 36.765625 34.90625 28.71875 34.90625 
L 20.21875 34.90625 
L 20.21875 43.015625 
L 29.109375 43.015625 
Q 36.375 43.015625 40.234375 45.921875 
Q 44.09375 48.828125 44.09375 54.296875 
Q 44.09375 59.90625 40.109375 62.90625 
Q 36.140625 65.921875 28.71875 65.921875 
Q 24.65625 65.921875 20.015625 65.03125 
Q 15.375 64.15625 9.8125 62.3125 
L 9.8125 71.09375 
Q 15.4375 72.65625 20.34375 73.4375 
Q 25.25 74.21875 29.59375 74.21875 
Q 40.828125 74.21875 47.359375 69.109375 
Q 53.90625 64.015625 53.90625 55.328125 
Q 53.90625 49.265625 50.4375 45.09375 
Q 46.96875 40.921875 40.578125 39.3125 
z
" id="DejaVuSans-51"></path>
       </defs>
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-51"></use>
      </g>
     </g>
    </g>
    <g id="xtick_2">
     <g id="line2d_2">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="92.299516" xlink:href="#m70b7d5c4ab" y="224.64"></use>
      </g>
     </g>
     <g id="text_2">
      <!-- −2 -->
      <g transform="translate(84.928422 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
" id="DejaVuSans-50"></path>
       </defs>
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-50"></use>
      </g>
     </g>
    </g>
    <g id="xtick_3">
     <g id="line2d_3">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="143.544414" xlink:href="#m70b7d5c4ab" y="224.64"></use>
      </g>
     </g>
     <g id="text_3">
      <!-- −1 -->
      <g transform="translate(136.17332 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
" id="DejaVuSans-49"></path>
       </defs>
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-49"></use>
      </g>
     </g>
    </g>
    <g id="xtick_4">
     <g id="line2d_4">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="194.789312" xlink:href="#m70b7d5c4ab" y="224.64"></use>
      </g>
     </g>
     <g id="text_4">
      <!-- 0 -->
      <g transform="translate(191.608062 239.238437)scale(0.1 -0.1)">
       <defs>
        <path d="M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
" id="DejaVuSans-48"></path>
       </defs>
       <use xlink:href="#DejaVuSans-48"></use>
      </g>
     </g>
    </g>
    <g id="xtick_5">
     <g id="line2d_5">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="246.03421" xlink:href="#m70b7d5c4ab" y="224.64"></use>
      </g>
     </g>
     <g id="text_5">
      <!-- 1 -->
      <g transform="translate(242.85296 239.238437)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-49"></use>
      </g>
     </g>
    </g>
    <g id="xtick_6">
     <g id="line2d_6">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="297.279108" xlink:href="#m70b7d5c4ab" y="224.64"></use>
      </g>
     </g>
     <g id="text_6">
      <!-- 2 -->
      <g transform="translate(294.097858 239.238437)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-50"></use>
      </g>
     </g>
    </g>
    <g id="xtick_7">
     <g id="line2d_7">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="348.524006" xlink:href="#m70b7d5c4ab" y="224.64"></use>
      </g>
     </g>
     <g id="text_7">
      <!-- 3 -->
      <g transform="translate(345.342756 239.238437)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-51"></use>
      </g>
     </g>
    </g>
   </g>
   <g id="matplotlib.axis_2">
    <g id="ytick_1">
     <g id="line2d_8">
      <defs>
       <path d="M 0 0 
L -3.5 0 
" id="m23d9fec03d" style="stroke:#000000;stroke-width:0.8;"></path>
      </defs>
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#m23d9fec03d" y="221.657926"></use>
      </g>
     </g>
     <g id="text_8">
      <!-- −3 -->
      <g transform="translate(7.2 225.457145)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-51"></use>
      </g>
     </g>
    </g>
    <g id="ytick_2">
     <g id="line2d_9">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#m23d9fec03d" y="190.227528"></use>
      </g>
     </g>
     <g id="text_9">
      <!-- −2 -->
      <g transform="translate(7.2 194.026746)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-50"></use>
      </g>
     </g>
    </g>
    <g id="ytick_3">
     <g id="line2d_10">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#m23d9fec03d" y="158.797129"></use>
      </g>
     </g>
     <g id="text_10">
      <!-- −1 -->
      <g transform="translate(7.2 162.596348)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-8722"></use>
       <use x="83.789062" xlink:href="#DejaVuSans-49"></use>
      </g>
     </g>
    </g>
    <g id="ytick_4">
     <g id="line2d_11">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#m23d9fec03d" y="127.36673"></use>
      </g>
     </g>
     <g id="text_11">
      <!-- 0 -->
      <g transform="translate(15.579688 131.165949)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-48"></use>
      </g>
     </g>
    </g>
    <g id="ytick_5">
     <g id="line2d_12">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#m23d9fec03d" y="95.936332"></use>
      </g>
     </g>
     <g id="text_12">
      <!-- 1 -->
      <g transform="translate(15.579688 99.73555)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-49"></use>
      </g>
     </g>
    </g>
    <g id="ytick_6">
     <g id="line2d_13">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#m23d9fec03d" y="64.505933"></use>
      </g>
     </g>
     <g id="text_13">
      <!-- 2 -->
      <g transform="translate(15.579688 68.305152)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-50"></use>
      </g>
     </g>
    </g>
    <g id="ytick_7">
     <g id="line2d_14">
      <g>
       <use style="stroke:#000000;stroke-width:0.8;" x="28.942188" xlink:href="#m23d9fec03d" y="33.075534"></use>
      </g>
     </g>
     <g id="text_14">
      <!-- 3 -->
      <g transform="translate(15.579688 36.874753)scale(0.1 -0.1)">
       <use xlink:href="#DejaVuSans-51"></use>
      </g>
     </g>
    </g>
   </g>
   <g id="line2d_15">
    <defs>
     <path d="M 0 5 
C 1.326016 5 2.597899 4.473168 3.535534 3.535534 
C 4.473168 2.597899 5 1.326016 5 0 
C 5 -1.326016 4.473168 -2.597899 3.535534 -3.535534 
C 2.597899 -4.473168 1.326016 -5 0 -5 
C -1.326016 -5 -2.597899 -4.473168 -3.535534 -3.535534 
C -4.473168 -2.597899 -5 -1.326016 -5 0 
C -5 1.326016 -4.473168 2.597899 -3.535534 3.535534 
C -2.597899 4.473168 -1.326016 5 0 5 
z
" id="m402b0f97b4" style="stroke:#1f77b4;"></path>
    </defs>
    <g clip-path="url(#p0ab3b32139)">
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="87.640889" xlink:href="#m402b0f97b4" y="214.756364"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="165.284674" xlink:href="#m402b0f97b4" y="165.001556"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="339.206752" xlink:href="#m402b0f97b4" y="52.591413"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="69.00638" xlink:href="#m402b0f97b4" y="170.210714"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="264.668718" xlink:href="#m402b0f97b4" y="107.498138"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="75.217883" xlink:href="#m402b0f97b4" y="173.089811"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="187.024933" xlink:href="#m402b0f97b4" y="133.686794"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="305.043486" xlink:href="#m402b0f97b4" y="26.570427"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="128.015657" xlink:href="#m402b0f97b4" y="122.114863"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="329.889497" xlink:href="#m402b0f97b4" y="55.163378"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="56.583375" xlink:href="#m402b0f97b4" y="176.475674"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="246.03421" xlink:href="#m402b0f97b4" y="115.293631"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="242.928458" xlink:href="#m402b0f97b4" y="98.943316"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="149.755917" xlink:href="#m402b0f97b4" y="118.109201"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="90.74664" xlink:href="#m402b0f97b4" y="211.932314"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="193.236436" xlink:href="#m402b0f97b4" y="126.309541"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="146.650165" xlink:href="#m402b0f97b4" y="108.382791"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="62.794878" xlink:href="#m402b0f97b4" y="156.909961"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="336.101" xlink:href="#m402b0f97b4" y="56.586279"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="124.909905" xlink:href="#m402b0f97b4" y="130.899167"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="100.063894" xlink:href="#m402b0f97b4" y="204.474596"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="292.620481" xlink:href="#m402b0f97b4" y="17.083636"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="118.698403" xlink:href="#m402b0f97b4" y="138.763817"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="233.611204" xlink:href="#m402b0f97b4" y="74.017611"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="81.429386" xlink:href="#m402b0f97b4" y="207.347716"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="115.592651" xlink:href="#m402b0f97b4" y="158.425966"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="50.371872" xlink:href="#m402b0f97b4" y="166.896271"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="93.852392" xlink:href="#m402b0f97b4" y="204.202516"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="159.073171" xlink:href="#m402b0f97b4" y="138.654041"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="65.900629" xlink:href="#m402b0f97b4" y="168.860907"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="283.303226" xlink:href="#m402b0f97b4" y="43.398223"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="59.689126" xlink:href="#m402b0f97b4" y="180.103325"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="239.822707" xlink:href="#m402b0f97b4" y="102.386125"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="152.861668" xlink:href="#m402b0f97b4" y="139.398568"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="317.466492" xlink:href="#m402b0f97b4" y="42.009699"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="214.976696" xlink:href="#m402b0f97b4" y="80.773692"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="348.524006" xlink:href="#m402b0f97b4" y="46.549165"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="208.765193" xlink:href="#m402b0f97b4" y="72.122328"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="174.601928" xlink:href="#m402b0f97b4" y="142.598112"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="196.342188" xlink:href="#m402b0f97b4" y="92.13944"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="249.139961" xlink:href="#m402b0f97b4" y="96.840937"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="183.919182" xlink:href="#m402b0f97b4" y="147.818167"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="252.245713" xlink:href="#m402b0f97b4" y="120.403684"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="230.505453" xlink:href="#m402b0f97b4" y="86.045095"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="342.312503" xlink:href="#m402b0f97b4" y="50.729998"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="286.408978" xlink:href="#m402b0f97b4" y="43.541896"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="168.390425" xlink:href="#m402b0f97b4" y="155.729428"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="221.188199" xlink:href="#m402b0f97b4" y="82.018914"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="190.130685" xlink:href="#m402b0f97b4" y="124.219729"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="345.418254" xlink:href="#m402b0f97b4" y="56.919975"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="218.082447" xlink:href="#m402b0f97b4" y="76.446836"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="273.985972" xlink:href="#m402b0f97b4" y="59.060048"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="140.438662" xlink:href="#m402b0f97b4" y="130.634556"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="332.995249" xlink:href="#m402b0f97b4" y="49.123011"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="224.29395" xlink:href="#m402b0f97b4" y="75.670932"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="236.716956" xlink:href="#m402b0f97b4" y="94.547861"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="301.937735" xlink:href="#m402b0f97b4" y="24.438322"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="155.967419" xlink:href="#m402b0f97b4" y="151.598426"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="131.121408" xlink:href="#m402b0f97b4" y="134.561001"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="44.160369" xlink:href="#m402b0f97b4" y="167.133223"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="202.55369" xlink:href="#m402b0f97b4" y="75.171895"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="106.275397" xlink:href="#m402b0f97b4" y="195.684169"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="47.266121" xlink:href="#m402b0f97b4" y="167.558817"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="112.4869" xlink:href="#m402b0f97b4" y="170.74975"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="311.254989" xlink:href="#m402b0f97b4" y="25.595557"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="323.677995" xlink:href="#m402b0f97b4" y="44.561701"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="270.880221" xlink:href="#m402b0f97b4" y="69.074442"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="308.149238" xlink:href="#m402b0f97b4" y="17.780029"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="295.726232" xlink:href="#m402b0f97b4" y="23.637384"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="103.169646" xlink:href="#m402b0f97b4" y="188.318973"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="227.399701" xlink:href="#m402b0f97b4" y="77.502659"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="261.562967" xlink:href="#m402b0f97b4" y="107.753059"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="84.535137" xlink:href="#m402b0f97b4" y="212.227561"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="326.783746" xlink:href="#m402b0f97b4" y="46.68746"></use>
     <use style="fill:#1f77b4;stroke:#1f77b4;" x="199.447939" xlink:href="#m402b0f97b4" y="88.967676"></use>
    </g>
   </g>
   <g id="line2d_16">
    <defs>
     <path d="M -2 2 
L 2 2 
L 2 -2 
L -2 -2 
z
" id="m115e3da7aa" style="stroke:#ff7f0e;stroke-linejoin:miter;"></path>
    </defs>
    <g clip-path="url(#p0ab3b32139)">
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="87.640889" xlink:href="#m115e3da7aa" y="214.756364"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="165.284674" xlink:href="#m115e3da7aa" y="165.001556"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="339.206752" xlink:href="#m115e3da7aa" y="52.591413"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="69.00638" xlink:href="#m115e3da7aa" y="170.210714"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="264.668718" xlink:href="#m115e3da7aa" y="107.498138"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="75.217883" xlink:href="#m115e3da7aa" y="173.089811"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="187.024933" xlink:href="#m115e3da7aa" y="133.686794"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="305.043486" xlink:href="#m115e3da7aa" y="26.570427"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="128.015657" xlink:href="#m115e3da7aa" y="122.114863"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="329.889497" xlink:href="#m115e3da7aa" y="55.163378"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="56.583375" xlink:href="#m115e3da7aa" y="176.475674"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="246.03421" xlink:href="#m115e3da7aa" y="115.293631"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="242.928458" xlink:href="#m115e3da7aa" y="98.943316"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="149.755917" xlink:href="#m115e3da7aa" y="118.109201"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="90.74664" xlink:href="#m115e3da7aa" y="211.932314"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="193.236436" xlink:href="#m115e3da7aa" y="126.309541"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="146.650165" xlink:href="#m115e3da7aa" y="108.382791"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="62.794878" xlink:href="#m115e3da7aa" y="156.909961"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="336.101" xlink:href="#m115e3da7aa" y="56.586279"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="124.909905" xlink:href="#m115e3da7aa" y="130.899167"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="100.063894" xlink:href="#m115e3da7aa" y="204.474596"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="292.620481" xlink:href="#m115e3da7aa" y="17.083636"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="118.698403" xlink:href="#m115e3da7aa" y="138.763817"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="233.611204" xlink:href="#m115e3da7aa" y="74.017611"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="81.429386" xlink:href="#m115e3da7aa" y="207.347716"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="115.592651" xlink:href="#m115e3da7aa" y="158.425966"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="50.371872" xlink:href="#m115e3da7aa" y="166.896271"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="93.852392" xlink:href="#m115e3da7aa" y="204.202516"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="159.073171" xlink:href="#m115e3da7aa" y="138.654041"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="65.900629" xlink:href="#m115e3da7aa" y="168.860907"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="283.303226" xlink:href="#m115e3da7aa" y="43.398223"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="59.689126" xlink:href="#m115e3da7aa" y="180.103325"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="239.822707" xlink:href="#m115e3da7aa" y="102.386125"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="152.861668" xlink:href="#m115e3da7aa" y="139.398568"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="317.466492" xlink:href="#m115e3da7aa" y="42.009699"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="214.976696" xlink:href="#m115e3da7aa" y="80.773692"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="348.524006" xlink:href="#m115e3da7aa" y="46.549165"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="208.765193" xlink:href="#m115e3da7aa" y="72.122328"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="174.601928" xlink:href="#m115e3da7aa" y="142.598112"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="196.342188" xlink:href="#m115e3da7aa" y="92.13944"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="249.139961" xlink:href="#m115e3da7aa" y="96.840937"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="183.919182" xlink:href="#m115e3da7aa" y="147.818167"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="252.245713" xlink:href="#m115e3da7aa" y="120.403684"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="230.505453" xlink:href="#m115e3da7aa" y="86.045095"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="342.312503" xlink:href="#m115e3da7aa" y="50.729998"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="286.408978" xlink:href="#m115e3da7aa" y="43.541896"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="168.390425" xlink:href="#m115e3da7aa" y="155.729428"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="221.188199" xlink:href="#m115e3da7aa" y="82.018914"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="190.130685" xlink:href="#m115e3da7aa" y="124.219729"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="345.418254" xlink:href="#m115e3da7aa" y="56.919975"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="218.082447" xlink:href="#m115e3da7aa" y="76.446836"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="273.985972" xlink:href="#m115e3da7aa" y="59.060048"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="140.438662" xlink:href="#m115e3da7aa" y="130.634556"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="332.995249" xlink:href="#m115e3da7aa" y="49.123011"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="224.29395" xlink:href="#m115e3da7aa" y="75.670932"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="236.716956" xlink:href="#m115e3da7aa" y="94.547861"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="301.937735" xlink:href="#m115e3da7aa" y="24.438322"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="155.967419" xlink:href="#m115e3da7aa" y="151.598426"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="131.121408" xlink:href="#m115e3da7aa" y="134.561001"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="44.160369" xlink:href="#m115e3da7aa" y="167.133223"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="202.55369" xlink:href="#m115e3da7aa" y="75.171895"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="106.275397" xlink:href="#m115e3da7aa" y="195.684169"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="47.266121" xlink:href="#m115e3da7aa" y="167.558817"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="112.4869" xlink:href="#m115e3da7aa" y="170.74975"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="311.254989" xlink:href="#m115e3da7aa" y="25.595557"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="323.677995" xlink:href="#m115e3da7aa" y="44.561701"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="270.880221" xlink:href="#m115e3da7aa" y="69.074442"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="308.149238" xlink:href="#m115e3da7aa" y="17.780029"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="295.726232" xlink:href="#m115e3da7aa" y="23.637384"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="103.169646" xlink:href="#m115e3da7aa" y="188.318973"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="227.399701" xlink:href="#m115e3da7aa" y="77.502659"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="261.562967" xlink:href="#m115e3da7aa" y="107.753059"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="84.535137" xlink:href="#m115e3da7aa" y="212.227561"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="326.783746" xlink:href="#m115e3da7aa" y="46.68746"></use>
     <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="199.447939" xlink:href="#m115e3da7aa" y="88.967676"></use>
    </g>
   </g>
   <g id="patch_3">
    <path d="M 28.942188 224.64 
L 28.942188 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
   <g id="patch_4">
    <path d="M 363.742188 224.64 
L 363.742188 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
   <g id="patch_5">
    <path d="M 28.942188 224.64 
L 363.742188 224.64 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
   <g id="patch_6">
    <path d="M 28.942188 7.2 
L 363.742188 7.2 
" style="fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;"></path>
   </g>
   <g id="legend_1">
    <g id="patch_7">
     <path d="M 35.942188 44.55625 
L 118.109375 44.55625 
Q 120.109375 44.55625 120.109375 42.55625 
L 120.109375 14.2 
Q 120.109375 12.2 118.109375 12.2 
L 35.942188 12.2 
Q 33.942188 12.2 33.942188 14.2 
L 33.942188 42.55625 
Q 33.942188 44.55625 35.942188 44.55625 
z
" style="fill:#ffffff;opacity:0.8;stroke:#cccccc;stroke-linejoin:miter;"></path>
    </g>
    <g id="line2d_17"></g>
    <g id="line2d_18">
     <g>
      <use style="fill:#1f77b4;stroke:#1f77b4;" x="47.942188" xlink:href="#m402b0f97b4" y="20.298437"></use>
     </g>
    </g>
    <g id="text_15">
     <!-- data -->
     <g transform="translate(65.942188 23.798437)scale(0.1 -0.1)">
      <defs>
       <path d="M 45.40625 46.390625 
L 45.40625 75.984375 
L 54.390625 75.984375 
L 54.390625 0 
L 45.40625 0 
L 45.40625 8.203125 
Q 42.578125 3.328125 38.25 0.953125 
Q 33.9375 -1.421875 27.875 -1.421875 
Q 17.96875 -1.421875 11.734375 6.484375 
Q 5.515625 14.40625 5.515625 27.296875 
Q 5.515625 40.1875 11.734375 48.09375 
Q 17.96875 56 27.875 56 
Q 33.9375 56 38.25 53.625 
Q 42.578125 51.265625 45.40625 46.390625 
z
M 14.796875 27.296875 
Q 14.796875 17.390625 18.875 11.75 
Q 22.953125 6.109375 30.078125 6.109375 
Q 37.203125 6.109375 41.296875 11.75 
Q 45.40625 17.390625 45.40625 27.296875 
Q 45.40625 37.203125 41.296875 42.84375 
Q 37.203125 48.484375 30.078125 48.484375 
Q 22.953125 48.484375 18.875 42.84375 
Q 14.796875 37.203125 14.796875 27.296875 
z
" id="DejaVuSans-100"></path>
       <path d="M 34.28125 27.484375 
Q 23.390625 27.484375 19.1875 25 
Q 14.984375 22.515625 14.984375 16.5 
Q 14.984375 11.71875 18.140625 8.90625 
Q 21.296875 6.109375 26.703125 6.109375 
Q 34.1875 6.109375 38.703125 11.40625 
Q 43.21875 16.703125 43.21875 25.484375 
L 43.21875 27.484375 
z
M 52.203125 31.203125 
L 52.203125 0 
L 43.21875 0 
L 43.21875 8.296875 
Q 40.140625 3.328125 35.546875 0.953125 
Q 30.953125 -1.421875 24.3125 -1.421875 
Q 15.921875 -1.421875 10.953125 3.296875 
Q 6 8.015625 6 15.921875 
Q 6 25.140625 12.171875 29.828125 
Q 18.359375 34.515625 30.609375 34.515625 
L 43.21875 34.515625 
L 43.21875 35.40625 
Q 43.21875 41.609375 39.140625 45 
Q 35.0625 48.390625 27.6875 48.390625 
Q 23 48.390625 18.546875 47.265625 
Q 14.109375 46.140625 10.015625 43.890625 
L 10.015625 52.203125 
Q 14.9375 54.109375 19.578125 55.046875 
Q 24.21875 56 28.609375 56 
Q 40.484375 56 46.34375 49.84375 
Q 52.203125 43.703125 52.203125 31.203125 
z
" id="DejaVuSans-97"></path>
       <path d="M 18.3125 70.21875 
L 18.3125 54.6875 
L 36.8125 54.6875 
L 36.8125 47.703125 
L 18.3125 47.703125 
L 18.3125 18.015625 
Q 18.3125 11.328125 20.140625 9.421875 
Q 21.96875 7.515625 27.59375 7.515625 
L 36.8125 7.515625 
L 36.8125 0 
L 27.59375 0 
Q 17.1875 0 13.234375 3.875 
Q 9.28125 7.765625 9.28125 18.015625 
L 9.28125 47.703125 
L 2.6875 47.703125 
L 2.6875 54.6875 
L 9.28125 54.6875 
L 9.28125 70.21875 
z
" id="DejaVuSans-116"></path>
      </defs>
      <use xlink:href="#DejaVuSans-100"></use>
      <use x="63.476562" xlink:href="#DejaVuSans-97"></use>
      <use x="124.755859" xlink:href="#DejaVuSans-116"></use>
      <use x="163.964844" xlink:href="#DejaVuSans-97"></use>
     </g>
    </g>
    <g id="line2d_19"></g>
    <g id="line2d_20">
     <g>
      <use style="fill:#ff7f0e;stroke:#ff7f0e;stroke-linejoin:miter;" x="47.942188" xlink:href="#m115e3da7aa" y="34.976562"></use>
     </g>
    </g>
    <g id="text_16">
     <!-- prediction -->
     <g transform="translate(65.942188 38.476562)scale(0.1 -0.1)">
      <defs>
       <path d="M 18.109375 8.203125 
L 18.109375 -20.796875 
L 9.078125 -20.796875 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.390625 
Q 20.953125 51.265625 25.265625 53.625 
Q 29.59375 56 35.59375 56 
Q 45.5625 56 51.78125 48.09375 
Q 58.015625 40.1875 58.015625 27.296875 
Q 58.015625 14.40625 51.78125 6.484375 
Q 45.5625 -1.421875 35.59375 -1.421875 
Q 29.59375 -1.421875 25.265625 0.953125 
Q 20.953125 3.328125 18.109375 8.203125 
z
M 48.6875 27.296875 
Q 48.6875 37.203125 44.609375 42.84375 
Q 40.53125 48.484375 33.40625 48.484375 
Q 26.265625 48.484375 22.1875 42.84375 
Q 18.109375 37.203125 18.109375 27.296875 
Q 18.109375 17.390625 22.1875 11.75 
Q 26.265625 6.109375 33.40625 6.109375 
Q 40.53125 6.109375 44.609375 11.75 
Q 48.6875 17.390625 48.6875 27.296875 
z
" id="DejaVuSans-112"></path>
       <path d="M 41.109375 46.296875 
Q 39.59375 47.171875 37.8125 47.578125 
Q 36.03125 48 33.890625 48 
Q 26.265625 48 22.1875 43.046875 
Q 18.109375 38.09375 18.109375 28.8125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 20.953125 51.171875 25.484375 53.578125 
Q 30.03125 56 36.53125 56 
Q 37.453125 56 38.578125 55.875 
Q 39.703125 55.765625 41.0625 55.515625 
z
" id="DejaVuSans-114"></path>
       <path d="M 56.203125 29.59375 
L 56.203125 25.203125 
L 14.890625 25.203125 
Q 15.484375 15.921875 20.484375 11.0625 
Q 25.484375 6.203125 34.421875 6.203125 
Q 39.59375 6.203125 44.453125 7.46875 
Q 49.3125 8.734375 54.109375 11.28125 
L 54.109375 2.78125 
Q 49.265625 0.734375 44.1875 -0.34375 
Q 39.109375 -1.421875 33.890625 -1.421875 
Q 20.796875 -1.421875 13.15625 6.1875 
Q 5.515625 13.8125 5.515625 26.8125 
Q 5.515625 40.234375 12.765625 48.109375 
Q 20.015625 56 32.328125 56 
Q 43.359375 56 49.78125 48.890625 
Q 56.203125 41.796875 56.203125 29.59375 
z
M 47.21875 32.234375 
Q 47.125 39.59375 43.09375 43.984375 
Q 39.0625 48.390625 32.421875 48.390625 
Q 24.90625 48.390625 20.390625 44.140625 
Q 15.875 39.890625 15.1875 32.171875 
z
" id="DejaVuSans-101"></path>
       <path d="M 9.421875 54.6875 
L 18.40625 54.6875 
L 18.40625 0 
L 9.421875 0 
z
M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 64.59375 
L 9.421875 64.59375 
z
" id="DejaVuSans-105"></path>
       <path d="M 48.78125 52.59375 
L 48.78125 44.1875 
Q 44.96875 46.296875 41.140625 47.34375 
Q 37.3125 48.390625 33.40625 48.390625 
Q 24.65625 48.390625 19.8125 42.84375 
Q 14.984375 37.3125 14.984375 27.296875 
Q 14.984375 17.28125 19.8125 11.734375 
Q 24.65625 6.203125 33.40625 6.203125 
Q 37.3125 6.203125 41.140625 7.25 
Q 44.96875 8.296875 48.78125 10.40625 
L 48.78125 2.09375 
Q 45.015625 0.34375 40.984375 -0.53125 
Q 36.96875 -1.421875 32.421875 -1.421875 
Q 20.0625 -1.421875 12.78125 6.34375 
Q 5.515625 14.109375 5.515625 27.296875 
Q 5.515625 40.671875 12.859375 48.328125 
Q 20.21875 56 33.015625 56 
Q 37.15625 56 41.109375 55.140625 
Q 45.0625 54.296875 48.78125 52.59375 
z
" id="DejaVuSans-99"></path>
       <path d="M 30.609375 48.390625 
Q 23.390625 48.390625 19.1875 42.75 
Q 14.984375 37.109375 14.984375 27.296875 
Q 14.984375 17.484375 19.15625 11.84375 
Q 23.34375 6.203125 30.609375 6.203125 
Q 37.796875 6.203125 41.984375 11.859375 
Q 46.1875 17.53125 46.1875 27.296875 
Q 46.1875 37.015625 41.984375 42.703125 
Q 37.796875 48.390625 30.609375 48.390625 
z
M 30.609375 56 
Q 42.328125 56 49.015625 48.375 
Q 55.71875 40.765625 55.71875 27.296875 
Q 55.71875 13.875 49.015625 6.21875 
Q 42.328125 -1.421875 30.609375 -1.421875 
Q 18.84375 -1.421875 12.171875 6.21875 
Q 5.515625 13.875 5.515625 27.296875 
Q 5.515625 40.765625 12.171875 48.375 
Q 18.84375 56 30.609375 56 
z
" id="DejaVuSans-111"></path>
       <path d="M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
" id="DejaVuSans-110"></path>
      </defs>
      <use xlink:href="#DejaVuSans-112"></use>
      <use x="63.476562" xlink:href="#DejaVuSans-114"></use>
      <use x="102.339844" xlink:href="#DejaVuSans-101"></use>
      <use x="163.863281" xlink:href="#DejaVuSans-100"></use>
      <use x="227.339844" xlink:href="#DejaVuSans-105"></use>
      <use x="255.123047" xlink:href="#DejaVuSans-99"></use>
      <use x="310.103516" xlink:href="#DejaVuSans-116"></use>
      <use x="349.3125" xlink:href="#DejaVuSans-105"></use>
      <use x="377.095703" xlink:href="#DejaVuSans-111"></use>
      <use x="438.277344" xlink:href="#DejaVuSans-110"></use>
     </g>
    </g>
   </g>
  </g>
 </g>
 <defs>
  <clippath id="p0ab3b32139">
   <rect height="217.44" width="334.8" x="28.942188" y="7.2"></rect>
  </clippath>
 </defs>
</svg>

</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>On the training set, we do a perfect job: each point is its own nearest neighbor!</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_pred_test</span> <span class="o">=</span> <span class="n">kneighbor_regression</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="s1">'o'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"data"</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_pred_test</span><span class="p">,</span> <span class="s1">'s'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"prediction"</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXYAAAD8CAYAAABjAo9vAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDIuMi4yLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvhp/UCwAAGe1JREFUeJzt3X9wVfWZx/H3IwlhE5RfxvEHkiBLEaUQMagUjLUVRdehC+qoY1ydjk380akdV6fdtW5dO87uDh1G60obXFqdFaW1CtrWseqsgqC4gCAbRVZBsFm1RiIpJhoT+e4f4YaQ3Nx7k3Pu+XU/r5nMcO8999zvDclzv3nO832+5pxDRESS44iwByAiIv5SYBcRSRgFdhGRhFFgFxFJGAV2EZGEUWAXEUkYBXYRkYRRYBcRSRgFdhGRhCkK40WPPvpoV1lZGcZLi4jE1ubNmz92zpVnOy6UwF5ZWcmmTZvCeGkRkdgysz25HKdUjIhIwiiwi4gkjAK7iEjChJJjT6ezs5OmpiY+//zzsIeSGCNGjGD8+PEUFxeHPRQRCVBkAntTUxNHHnkklZWVmFnYw4k95xx79+6lqamJiRMnhj0ckVC0dXTRsHYnD7+yh0/aOxlTWkzt7ArqayZRVhKZ8Oe7yKRiPv/8c8aNG6eg7hMzY9y4cfoLSApWW0cXC5eup2HNLlraO3FAS3snDWt2sXDpeto6usIeYt5EJrADCuo+0/dTClnD2p3s2dtOR9eBw+7v6DrAnr3tNKzdGdLI8i9SgV1ExC8Pv7KnX1BP6eg6wMMb3gt4RMGJZZIpiLzZnXfeyciRI7n11lvTPr569Wq+8pWvcMopp/jyeiLir0/aO7M8/kVAIwle7GbsUcmbrV69mjfffDOQ1xKRwRtTmrkabEzp8IBGErzYBfZ85s3uvvtupkyZwnnnnceOHTsAeOCBB5g1axYzZszgkksuob29nZdffpmnnnqK2267jaqqKnbu3Jn2OBEJT+3sCkqK0oe4kqIjqD1rQsAjCk7sAnu+8mabN29m5cqVbNmyhSeeeIKNGzcCsGjRIjZu3Mjrr7/O1KlTWb58OV/72tdYsGABixcvZuvWrUyaNCntcSISnvqaSVSMK+0X3EuKjqBiXCn1NZNCGln+xS7Hnq+82UsvvcTChQspLS0FYMGCBQA0Njbyox/9iH379vHpp59ywQUXpH1+rseJSDDKSopYdeOc7utxG97jk/YvGFM6nNqzJiS+jj1272xMaTEtGYK7l7xZuvLAa6+9ltWrVzNjxgwefPBBXnzxxbTPzfU4EQlOWUkRt8ybwi3zpoQ9lEDFLhWTr7xZTU0Nq1at4rPPPmP//v387ne/A2D//v0cd9xxdHZ2smLFip7jjzzySPbv399ze6DjRKQwtHV0seS5Hcy861km/vAPzLzrWZY8tyOUhVCxC+z5ypvNnDmTyy+/nKqqKi655BLOPvtsAH7yk59w5plnMm/ePE4++eSe46+44goWL17Maaedxs6dOwc8TkSSLyrVeinmnAv0BQGqq6td3402tm/fztSpU3N6fk8de4HlzYZiMN9XERmaJc/toGHNrrSFHSVFR1B/zkm+pIPMbLNzrjrbcbGMgoWaNxORPFo8Gdo+OnS77Bi47e2cnppLtV6Q8Sp2qRgRkbzoHdTT3c4gaqtcFdhFRDyK2ipXBXYREY+itspVgV1EBLpz6pluZxC1Va6xvHgqIuKnto4uGqp+f3jH2KoK6ju6cqq0i9oqV83Y82jkyJEAvP/++1x66aUZj73nnnsOaxx20UUXsW/fvryOT0T8q0FPVeu9dsc83v2Xv+G1O+Zxy7wpoZRgew7sZjbCzP7bzF43szfM7J/9GFhUffnll4N+zvHHH89vf/vbjMf0DexPP/00o0ePHvRricjgJHGnJT9m7B3AN5xzM4AqYL6ZneXDeTNbPBnuHHXoa/Fkz6fcvXs3J598Mtdccw3Tp0/n0ksvpb29ncrKSu666y7mzp3LY489xs6dO5k/fz6nn346Z599Nm+99RYA7777LrNnz2bWrFnccccdh5132rRpQPcHw6233spXv/pVpk+fzn333cfPfvYz3n//fc4991zOPfdcACorK/n4448BWLJkCdOmTWPatGncc889PeecOnUq3/nOdzj11FM5//zz+eyzzzx/D0QKTRJ3WvIc2F23Tw/eLD74lf/lrB5qTjPZsWMHdXV1bNu2jaOOOoqlS5cCMGLECNatW8cVV1xBXV0d9913H5s3b+anP/0pN954IwA333wzN9xwAxs3buTYY49Ne/5ly5bx7rvvsmXLFrZt28ZVV13F9773PY4//nheeOEFXnjhhcOO37x5M7/61a949dVX2bBhAw888ABb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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>On the test set, we also do a better job of capturing the variation, but our estimates look much messier than before.
Let us look at the R<sup>2</sup> score:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kneighbor_regression</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.9166293022467948</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Much better than before! Here, the linear model was not a good fit for our problem; it was lacking in complexity and thus under-fit our data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="alert alert-success">
    <b>EXERCISE</b>:
     <ul>
      <li>
      Compare the KNeighborsRegressor and LinearRegression on the boston housing dataset. You can load the dataset using ``sklearn.datasets.load_boston``. You can learn about the dataset by reading the ``DESCR`` attribute.
      </li>
    </ul>
</div>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># %load solutions/06A_knn_vs_linreg.py</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Cross-Validation-and-scoring-methods">
<a class="anchor" href="#Cross-Validation-and-scoring-methods" aria-hidden="true"><span class="octicon octicon-link"></span></a>Cross-Validation and scoring methods<a class="anchor-link" href="#Cross-Validation-and-scoring-methods"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the previous sections and notebooks, we split our dataset into two parts, a training set and a test set. We used the training set to fit our model, and we used the test set to evaluate its generalization performance -- how well it performs on new, unseen data.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><figure>
  
    <img class="docimage" src="/blog/images/copied_from_nb/figures/train_test_split.svg" alt="" style="max-width: 80%px">
    
    
</figure>
</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>However, often (labeled) data is precious, and this approach lets us only use ~ 3/4 of our data for training. On the other hand, we will only ever try to apply our model 1/4 of our data for testing.
A common way to use more of the data to build a model, but also get a more robust estimate of the generalization performance, is cross-validation.
In cross-validation, the data is split repeatedly into a training and non-overlapping test-sets, with a separate model built for every pair. The test-set scores are then aggregated for a more robust estimate.</p>
<p>The most common way to do cross-validation is k-fold cross-validation, in which the data is first split into k (often 5 or 10) equal-sized folds, and then for each iteration, one of the k folds is used as test data, and the rest as training data:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><figure>
  
    <img class="docimage" src="/blog/images/copied_from_nb/figures/cross_validation.svg" alt="" style="max-width: 80%px">
    
    
</figure>
</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This way, each data point will be in the test-set exactly once, and we can use all but a k'th of the data for training.
Let us apply this technique to evaluate the KNeighborsClassifier algorithm on the Iris dataset:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>

<span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span>

<span class="n">classifier</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The labels in iris are sorted, which means that if we split the data as illustrated above, the first fold will only have the label 0 in it, while the last one will only have the label 2:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To avoid this problem in evaluation, we first shuffle our data:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">permutation</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">permutation</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">permutation</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[2 1 0 2 0 2 0 1 1 1 2 1 1 1 1 0 1 1 0 0 2 1 0 0 2 0 0 1 1 0 2 1 0 2 2 1 0
 1 1 1 2 0 2 0 0 1 2 2 2 2 1 2 1 1 2 2 2 2 1 2 1 0 2 1 1 1 1 2 0 0 2 1 0 0
 1 0 2 1 0 1 2 1 0 2 2 2 2 0 0 2 2 0 2 0 2 2 0 0 2 0 0 0 1 2 2 0 0 0 1 1 0
 0 1 0 2 1 2 1 0 2 0 2 0 0 2 0 2 1 1 1 2 2 1 1 0 1 2 2 0 1 1 1 1 0 0 0 2 1
 2 0]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now implementing cross-validation is easy:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">fold_size</span> <span class="o">=</span> <span class="n">n_samples</span> <span class="o">//</span> <span class="n">k</span>
<span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">masks</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">fold</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
    <span class="c1"># generate a boolean mask for the test set in this fold</span>
    <span class="n">test_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
    <span class="n">test_mask</span><span class="p">[</span><span class="n">fold</span> <span class="o">*</span> <span class="n">fold_size</span> <span class="p">:</span> <span class="p">(</span><span class="n">fold</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">fold_size</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
    
    <span class="c1"># store the mask for visualization</span>
    <span class="n">masks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">test_mask</span><span class="p">)</span>
    
    <span class="c1"># create training and test sets using this mask</span>
    <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">test_mask</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">test_mask</span><span class="p">]</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">~</span><span class="n">test_mask</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">test_mask</span><span class="p">]</span>
    
    <span class="c1"># fit the classifier</span>
    <span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="c1"># compute the score and record it</span>
    
    <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">classifier</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's check that our test mask does the right thing:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">masks</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'gray_r'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.image.AxesImage at 0x2435599cf40&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And now let's look a the scores we computed:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[0.9666666666666667, 0.9, 1.0, 1.0, 0.9333333333333333]
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0.96
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you can see, there is a rather wide spectrum of scores from 90% correct to 100% correct. If we only did a single split, we might have gotten either answer.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As cross-validation is such a common pattern in machine learning, there are functions to do the above for you with much more flexibility and less code.
The <code>sklearn.model_selection</code> module has all functions related to cross validation. There easiest function is <code>cross_val_score</code> which takes an estimator and a dataset, and will do all of the splitting for you:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[1.         0.93333333 1.         1.         0.93333333]
0.9733333333333334
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you can see, the function uses three folds by default. You can change the number of folds using the cv argument:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([1.        , 0.93333333, 1.        , 1.        , 0.93333333])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are also helper objects in the cross-validation module that will generate indices for you for all kinds of different cross-validation methods, including k-fold:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span><span class="p">,</span> <span class="n">StratifiedKFold</span><span class="p">,</span> <span class="n">ShuffleSplit</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By default, cross_val_score will use <code>StratifiedKFold</code> for classification, which ensures that the class proportions in the dataset are reflected in each fold. If you have a binary classification dataset with 90% of data point belonging to class 0, that would mean that in each fold, 90% of datapoints would belong to class 0.
If you would just use KFold cross-validation, it is likely that you would generate a split that only contains class 0.
It is generally a good idea to use <code>StratifiedKFold</code> whenever you do classification.</p>
<p><code>StratifiedKFold</code> would also remove our need to shuffle <code>iris</code>.
Let's see what kinds of folds it generates on the unshuffled iris dataset.
Each cross-validation class is a generator of sets of training and test indices:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="k">for</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="ow">in</span> <span class="n">cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[  0   1   2   3   4   5   6   7   8   9  50  51  52  53  54  55  56  57
  58  59 100 101 102 103 104 105 106 107 108 109]
[ 10  11  12  13  14  15  16  17  18  19  60  61  62  63  64  65  66  67
  68  69 110 111 112 113 114 115 116 117 118 119]
[ 20  21  22  23  24  25  26  27  28  29  70  71  72  73  74  75  76  77
  78  79 120 121 122 123 124 125 126 127 128 129]
[ 30  31  32  33  34  35  36  37  38  39  80  81  82  83  84  85  86  87
  88  89 130 131 132 133 134 135 136 137 138 139]
[ 40  41  42  43  44  45  46  47  48  49  90  91  92  93  94  95  96  97
  98  99 140 141 142 143 144 145 146 147 148 149]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you can see, there are a couple of samples from the beginning, then from the middle, and then from the end, in each of the folds.
This way, the class ratios are preserved. Let's visualize the split:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">plot_cv</span><span class="p">(</span><span class="n">cv</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="n">masks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="ow">in</span> <span class="n">cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
        <span class="n">mask</span><span class="p">[</span><span class="n">test</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">masks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">matshow</span><span class="p">(</span><span class="n">masks</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">'gray_r'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_cv</span><span class="p">(</span><span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For comparison, again the standard KFold, that ignores the labels:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_cv</span><span class="p">(</span><span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Keep in mind that increasing the number of folds will give you a larger training dataset, but will lead to more repetitions, and therefore a slower evaluation:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_cv</span><span class="p">(</span><span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Another helpful cross-validation generator is <code>ShuffleSplit</code>. This generator simply splits of a random portion of the data repeatedly. This allows the user to specify the number of repetitions and the training set size independently:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_cv</span><span class="p">(</span><span class="n">ShuffleSplit</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">2</span><span class="p">),</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If you want a more robust estimate, you can just increase the number of splits:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_cv</span><span class="p">(</span><span class="n">ShuffleSplit</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">2</span><span class="p">),</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA54AAACZCAYAAABHYuXCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAASyElEQVR4nO3db6xtaV0f8O/PuWoLasTMBUeGONRMrJZU5J4QlcSgFB1TwugLE4g2EyWdNoHWNm1a0ER9SeL/F2oywnRIRIihEicNKgRNeKPIufhvkPInQOXKlLmEaE2bFAefvjib9Hhn73vvPmc9e61nnc8nmczZ66y7nmc9v7WetX5n7f3b1VoLAAAA9PJFc3cAAACAdZN4AgAA0JXEEwAAgK4kngAAAHQl8QQAAKAriScAAABdHTzxrKr7qupDVfXRqnrtodtnOlX1nKr6var6YFV9oKp+ZLP8q6rqXVX1kc3/nzF3Xzmbqrqjqv6oqv7b5rXYrkBVfWVVva2q/vvm/P1WsV2Hqvr3m/n4sap6S1X9A7EdV1U9XFVPVNVjp5btjGdVvW5zf/WhqvrueXrN7dgR25/azMt/WlVvr6qvPPU7sR3Ettie+t1/rKpWVXeeWnZhYnvQxLOq7kjyi0m+J8k3JnllVX3jIfvApJ5M8h9aa9+Q5FuSvHoTz9cmeXdr7d4k7968Zkw/kuSDp16L7Tr8QpLfbq394yTflJMYi+3gqurZSf5tkqPW2vOS3JHkFRHbkT2S5L4blm2N5+b6+4ok/2Tzb35pc9/FMj2Sp8b2XUme11r7p0k+nOR1idgO6JE8NbapquckeWmSvzi17ELF9tBPPF+Y5KOttY+11j6X5K1J7j9wH5hIa+3x1tr7Nz//TU5uXp+dk5i+abPam5J87zw95Dyq6u4k/zzJG04tFtvBVdVXJPn2JG9Mktba51prfxWxXYtLSf5hVV1K8rQkn4rYDqu19p4kn71h8a543p/kra21/9ta+3iSj+bkvosF2hbb1to7W2tPbl7+QZK7Nz+L7UB2nLdJ8nNJ/lOSdmrZhYrtoRPPZyf55KnX1zbLGFxV3ZPkm5O8N8mzWmuPJyfJaZJnztczzuHnczJB/t2pZWI7vn+U5HqS/7J5G/UbqurpEdvhtdb+MslP5+Sv6Y8n+evW2jsjtmuzK57usdblh5P81uZnsR1cVb08yV+21v7khl9dqNgeOvGsLcvalmUMpKq+LMl/TfLvWmv/a+7+cH5V9bIkT7TWrs7dFyZ3KckLkvxya+2bk/zveOvlKmw+63d/kucm+ZokT6+qH5y3VxyQe6yVqKofy8nHmd78hUVbVhPbQVTV05L8WJIf3/brLctWG9tDJ57Xkjzn1Ou7c/I2IAZVVV+ck6Tzza2139gs/nRV3bX5/V1Jnpirf5zZi5K8vKo+kZO3xH9nVf1qxHYNriW51lp77+b123KSiIrt+P5Zko+31q631v42yW8k+baI7drsiqd7rBWoqgeSvCzJD7TWvpCAiO3Yvi4nfxD8k8191d1J3l9VX50LFttDJ57vS3JvVT23qr4kJx+mffTAfWAiVVU5+ZzYB1trP3vqV48meWDz8wNJfvPQfeN8Wmuva63d3Vq7Jyfn6e+21n4wYju81tr/TPLJqvr6zaKXJPnziO0a/EWSb6mqp23m55fk5LP3Yrsuu+L5aJJXVNWXVtVzk9yb5A9n6B9nVFX3JfnPSV7eWvs/p34ltgNrrf1Za+2ZrbV7NvdV15K8YHM9vlCxvXTIxlprT1bVa5L8Tk6q7T3cWvvAIfvApF6U5F8k+bOq+uPNsh9N8vokv15Vr8rJjdD3z9Q/pie26/Bvkrx58wfAjyX5oZz8IVJsB9Zae29VvS3J+3PyNr0/SvJQki+L2A6pqt6S5MVJ7qyqa0l+Ijvm4dbaB6rq13Pyh6Qnk7y6tfb5WTrOLe2I7euSfGmSd5387Sh/0Fr712I7lm2xba29cdu6Fy229f+f4gMAAMD0Dv1WWwAAAC4YiScAAABdSTwBAADoSuIJAABAV7MlnlX14Fxt05fYrpfYrpfYrpfYrpfYrpfYrtdFju2cTzwv7KBfAGK7XmK7XmK7XmK7XmK7XmK7Xhc2tt5qCwAAQFfn+h7PqrovyS8kuSPJG1prr7/Z+nfeeWe75557kiTXr1/P5cuXz9z2HK5evbp1+ZUrVw66jTndTv9Px3bX+rvMNQ77xmWf/RoltrfjkOdtz5jcbDtzmGteuGjtjmzf43uXfcd45PNqTtvGrcfYmJNvv90Rjs1RxnhfvWMy2vZHzIH2dfXq1c+01p6yk2dOPKvqjiQfTvLSJNeSvC/JK1trf77r3xwdHbXj4+MztbcEVbV1+T5jOMU25rRv/3etv8tc49Bzv0aJ7dKs9VjbZq554aK1O7J9j+9d9h3jkc+rOW0bt9HHZpQ5eeT5ZZQx3lfvmIy+/TWqqquttaMbl5/nrbYvTPLR1trHWmufS/LWJPefY3sAAACs0HkSz2cn+eSp19c2y/6eqnqwqo6r6vj69evnaA4AAIARnSfx3Pbc+SnPnFtrD7XWjlprR2t/PzMAAABPdekc//Zakuecen13kk+dZUNzfXZlKiN/3m/f963v2/+lxWSE/ZrqMx5TrT+VpcVkSZ/ZWNrY9zbKvLAkvT+bOVW7u8w1T4382a+5+r7LXNfJqa4dI5z/o4zxvuY6ZqeypGNklLlxl/M88Xxfknur6rlV9SVJXpHk0Wm6BQAAwFqc+Ylna+3JqnpNkt/JydepPNxa+8BkPQMAAGAVzvNW27TW3pHkHRP1BQAAgBU6z1ttAQAA4JYkngAAAHRVh6zUVFVbG1tStai5jF69bt92R6m+tcsc/VnaGDCOkSt7nsUI885Uc/Jcc/suo1TZnsPSKg1P5SLFcCqjj9lcc+xc8+a+2yepqquttaMbl3viCQAAQFcSTwAAALqSeAIAANCVxBMAAICuJJ4AAAB0dWnuDoxkiipeS6suOVVlr96WVhFxjkpmU1WLm2r7c1naOTSCpZ0Pc1UU3De2Pcdtqm1PNbdPddz3Xn/k83Ou61jv7bs27W9p9zS958be88saj6lRjoV9x94TTwAAALqSeAIAANCVxBMAAICuJJ4AAAB0JfEEAACgqwtR1Xauan29tjGSufZ35CqBSzpeb2atFYWXVm1wSZZWHXOq7c8R27nGcuS5ccrt7Kvnfo1cnfkslnZt6lndf6rzcPTzqvd+9Z6/9jVyvtC70rAnngAAAHQl8QQAAKAriScAAABdSTwBAADoSuIJAABAVwetanvlypUcHx/f9vr7VpfqXdFtjkqmvfWuuLZvu7ssraJoz3aXFpOljT27TRWrtVZQnGr9XbaNW++xX1qF0xGut2dpd0nmug6v1RzjoEr9Ml20/Z3DuRLPqvpEkr9J8vkkT7bWjqboFAAAAOsxxRPP72itfWaC7QAAALBCPuMJAABAV+dNPFuSd1bV1ap6cNsKVfVgVR1X1fH169fP2RwAAACjOW/i+aLW2guSfE+SV1fVt9+4QmvtodbaUWvt6PLly+dsDgAAgNGc6zOerbVPbf7/RFW9PckLk7xnio5ttjvVpiYxRyXTuUxVcW2ECoE307OS7CjVH+c6NlXZ222U8+qixXDbfs11fo4y9r2r+O6r5/iM0ve1Hjv7bmeXfY7NtY7ZVO1OtZ0Rxnlp1eWnsm9sz/zEs6qeXlVf/oWfk3xXksfOuj0AAADW6TxPPJ+V5O2bTPdSkl9rrf32JL0CAABgNc6ceLbWPpbkmybsCwAAACvk61QAAADoSuIJAABAV3XI6khVtbWxuSo99a4YNUWF06mqrTGf0SuTLa2fvS2tymbPNkeJ+cj9HKGPZ3HRql2PcC1e2tgs7djfZYQ5f5eR+34za+znKPs0laq62lo7unG5J54AAAB0JfEEAACgK4knAAAAXUk8AQAA6EriCQAAQFeXDtnYlStXcnx8fO7tTFUBqnf12n22P1eF3bkqn41e3WuEmO/b7r7rr7WC6r7m6P9U5+0o1S7nqDR+lnZHqGQ4yvm2tPlxhHGb6/p80e4LlnSdn2su3WWu6s9zHTv7bN/99glPPAEAAOhK4gkAAEBXEk8AAAC6kngCAADQlcQTAACArg5a1XZfU1Vi3dccVcKWVr2qd8XSuap77dKzEtvIFfmW2O7SqgQuydIqDS+tP7v0PDaXNteNYpR5ap9rx9JiO1e1+973dkuqmj3KdW8qva8doxyzPfuyNPuen554AgAA0JXEEwAAgK4kngAAAHQl8QQAAKAriScAAABd1SGrKVXV1sZGr+i0j7kq745eTWvk/o/c90MwPtMZvSr0XJXMd5njGBwlhvvqWS32LEaeXy7anHnR9neb3pV9l0bMx1dVV1trRzcuv+UTz6p6uKqeqKrHTi37qqp6V1V9ZPP/Z0zdYQAAANbhdt5q+0iS+25Y9tok726t3Zvk3ZvXAAAA8BS3TDxba+9J8tkbFt+f5E2bn9+U5Hsn7hcAAAArcemM/+5ZrbXHk6S19nhVPXPXilX1YJIHz9gOAAAAgztr4nnbWmsPJXko2V1cCAAAgPU6a+L56aq6a/O0864kT0zZqbXYVpVrqopco1f8mqr/c1UJnsPoMd+ld4XTEcZnqr7Pta8Xrd2e5jq+lzaWS6viO8W1aarqzKPcR/Sew5e2fk9LOz93meta1vuecpTxH8FZv8fz0SQPbH5+IMlvTtMdAAAA1uZ2vk7lLUl+P8nXV9W1qnpVktcneWlVfSTJSzevAQAA4Clu+Vbb1tord/zqJRP3BQAAgBU661ttAQAA4LZIPAEAAOiq+9epLMFclU/3WX/fSlqjVAjbZZT+q3C2v7kqNC4tJvtUtRz9+F5aVd41nrejVPYcvdL4kq4Rvceg9772Pv+Xtv7Ies/hS7un7L0ddvPEEwAAgK4kngAAAHQl8QQAAKAriScAAABdSTwBAADo6qBVba9cuZLj4+NDNplkusptU1TlWlq1xaX1Zyq9K5ztM25L6svNLK0y6ZKqS57FtnbnGuPelUyXFqup+rPv9vepZDyVpVXq7F3tdiq9x6HnsTDXXDdXxdJ9La0/PY2yr3PNySOYK4ZzteuJJwAAAF1JPAEAAOhK4gkAAEBXEk8AAAC6kngCAADQ1UGr2jJdVbipKn6NUqVuX0ur4rlPm7v07MuU25nL0iqrTlHVsncV3LkqjS7tWOt5Do0+l6618vHSqngvvc2bWWt/eh6DSzv+et+bXrR7zX2M8o0FU/HEEwAAgK4kngAAAHQl8QQAAKAriScAAABdSTwBAADo6pZVbavq4SQvS/JEa+15m2U/meRfJrm+We1HW2vv6NXJ27W0KqHbLK2S2VzbX5olVVybqy9rrUa377ywpHPUeX4YPY/l0SsQ7jJC5dBDbH8Kc/Vl9LGf69sARjDXdWyue9m57l96Voyf6toxlanG7HaeeD6S5L4ty3+utfb8zX+zJ50AAAAs0y0Tz9bae5J89gB9AQAAYIXO8xnP11TVn1bVw1X1jMl6BAAAwKqcNfH85SRfl+T5SR5P8jO7VqyqB6vquKqOr1+/vms1AAAAVupMiWdr7dOttc+31v4uya8keeFN1n2otXbUWju6fPnyWfsJAADAoG5Z1Xabqrqrtfb45uX3JXnsPJ1YUhXJ3kavcDhX5bDe1bp26blfU2179POn9zHee7/mOEfnqua4tPloKj3n5X3HbGkVRXvPR6McO2s89kevmr2kCqS7zHXcmMPPZoT7qaUdU/u6na9TeUuSFye5s6quJfmJJC+uqucnaUk+keRfTdIbAAAAVueWiWdr7ZVbFr+xQ18AAABYofNUtQUAAIBbkngCAADQlcQTAACAruqQlayqamtjo1SdnGI7o1QUm6ufU1XfnMu2/o9SXW5p/WE+c1VWHl3P83+qyptLq/64NI795V3/R2l3n/O/t1GqWs9llH721Du2VXW1tXZ043JPPAEAAOhK4gkAAEBXEk8AAAC6kngCAADQlcQTAACAri4dsrErV67k+Pj4ttdfWhW/KSypLzczVz9HGZ9dRuj/6JUDpzJHf0YZg32NcNwfwj7jsO+YjV6NdqqK5VMds1OZ49jvHcPeFUt793/f7fcet5GNsk9zxXwKvefGqcZgqjHzxBMAAICuJJ4AAAB0JfEEAACgK4knAAAAXUk8AQAA6KoOWdmpqrY2trRqfftuZ2mVKnta2r6O0J/e1RnXeJzdzNKqck7R7tKO47kYh/lctLHvPf/ucy3Y1yjVZdfqIo3bGq+3N9v+LlPcx011LzjKcVZVV1trRzcu98QTAACAriSeAAAAdCXxBAAAoCuJJwAAAF1JPAEAAOjq0FVtryf5H5uXdyb5zMEa55DEdr3Edr3Edr3Edr3Edr3Edr0uQmy/trV2+caFB008/17DVcfbyuwyPrFdL7FdL7FdL7FdL7FdL7Fdr4scW2+1BQAAoCuJJwAAAF3NmXg+NGPb9CW26yW26yW26yW26yW26yW263VhYzvbZzwBAAC4GLzVFgAAgK4kngAAAHQl8QQAAKAriScAAABdSTwBAADo6v8BSmwhdVoTc18AAAAASUVORK5CYII=%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can use all of these cross-validation generators with the <code>cross_val_score</code> method:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cv</span> <span class="o">=</span> <span class="n">ShuffleSplit</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=.</span><span class="mi">2</span><span class="p">)</span>
<span class="n">cross_val_score</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0.93333333, 0.93333333, 0.96666667, 0.93333333, 1.        ])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="alert alert-success">
    <b>EXERCISE</b>:
     <ul>
      <li>
      Perform three-fold cross-validation using the ``KFold`` class on the iris dataset without shuffling the data. Can you explain the result?
      </li>
    </ul>
</div>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># %load solutions/13_cross_validation.py</span>
<span class="n">cv</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">cross_val_score</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">cv</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="A-recap-on-Scikit-learn's-estimator-interface">
<a class="anchor" href="#A-recap-on-Scikit-learn's-estimator-interface" aria-hidden="true"><span class="octicon octicon-link"></span></a>A recap on Scikit-learn's estimator interface<a class="anchor-link" href="#A-recap-on-Scikit-learn's-estimator-interface"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Scikit-learn strives to have a uniform interface across all methods. Given a scikit-learn <em>estimator</em>
object named <code>model</code>, the following methods are available (not all for each model):</p>
<ul>
<li>Available in <strong>all Estimators</strong><ul>
<li>
<code>model.fit()</code> : fit training data. For supervised learning applications,
this accepts two arguments: the data <code>X</code> and the labels <code>y</code> (e.g. <code>model.fit(X, y)</code>).
For unsupervised learning applications, <code>fit</code> takes only a single argument,
the data <code>X</code> (e.g. <code>model.fit(X)</code>).</li>
</ul>
</li>
<li>
<p>Available in <strong>supervised estimators</strong></p>
<ul>
<li>
<code>model.predict()</code> : given a trained model, predict the label of a new set of data.
This method accepts one argument, the new data <code>X_new</code> (e.g. <code>model.predict(X_new)</code>),
and returns the learned label for each object in the array.</li>
<li>
<code>model.predict_proba()</code> : For classification problems, some estimators also provide
this method, which returns the probability that a new observation has each categorical label.
In this case, the label with the highest probability is returned by <code>model.predict()</code>.</li>
<li>
<code>model.decision_function()</code> : For classification problems, some estimators provide an uncertainty estimate that is not a probability. For binary classification, a decision_function &gt;= 0 means the positive class will be predicted, while &lt; 0 means the negative class.</li>
<li>
<code>model.score()</code> : for classification or regression problems, most (all?) estimators implement
a score method.  Scores are between 0 and 1, with a larger score indicating a better fit. For classifiers, the <code>score</code> method computes the prediction accuracy. For regressors, <code>score</code> computes the coefficient of determination (R<sup>2</sup>) of the prediction.</li>
<li>
<code>model.transform()</code> : For feature selection algorithms, this will reduce the dataset to the selected features. For some classification and regression models such as some linear models and random forests, this method reduces the dataset to the most informative features. These classification and regression models can therefore also be used as feature selection methods.</li>
</ul>
</li>
<li>
<p>Available in <strong>unsupervised estimators</strong></p>
<ul>
<li>
<code>model.transform()</code> : given an unsupervised model, transform new data into the new basis.
This also accepts one argument <code>X_new</code>, and returns the new representation of the data based
on the unsupervised model.</li>
<li>
<code>model.fit_transform()</code> : some estimators implement this method,
which more efficiently performs a fit and a transform on the same input data.</li>
<li>
<code>model.predict()</code> : for clustering algorithms, the predict method will produce cluster labels for new data points. Not all clustering methods have this functionality.</li>
<li>
<code>model.predict_proba()</code> : Gaussian mixture models (GMMs) provide the probability for each point to be generated by a given mixture component.</li>
<li>
<code>model.score()</code> : Density models like KDE and GMMs provide the likelihood of the data under the model.</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Apart from <code>fit</code>, the two most important functions are arguably <code>predict</code> to produce a target variable (a <code>y</code>) <code>transform</code>, which produces a new representation of the data (an <code>X</code>).
The following table shows for which class of models which function applies:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table>
<tr style="border:None; font-size:20px; padding:10px;">
<th>``model.predict``</th>
<th>``model.transform``</th>
</tr>
<tr style="border:None; font-size:20px; padding:10px;">
<td>Classification</td>
<td>Preprocessing</td>
</tr>
<tr style="border:None; font-size:20px; padding:10px;">
<td>Regression</td>
<td>Dimensionality Reduction</td>
</tr>
<tr style="border:None; font-size:20px; padding:10px;">
<td>Clustering</td>
<td>Feature Extraction</td>
</tr>
<tr style="border:None; font-size:20px; padding:10px;">
<td> </td>
<td>Feature Selection</td>
</tr>

</table>
</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/blog/eeg/jupyter/2020/10/20/ScikitLearn-tutorial-part3.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Nazarbayev University Brain-Machine Interfaces Lab Page</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/berdakh" title="berdakh"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
